#!/bin/sh
#### Configuration script for XEmacs.
#### Copyright (C) 1994 Free Software Foundation, Inc.
#### Copyright (C) 1993-1995 Board of Trustees, University of Illinois.
#### Copyright (C) 1995, 1996 Ben Wing.

### Don't edit this script!
### This script was automatically generated by the `autoconf' program
### from the file `./configure.in'.
### To rebuild it, execute the command
###	autoconf
### in the this directory.  You must have autoconf version 1.9 or later.

### This file is part of XEmacs.

### XEmacs is free software; you can redistribute it and/or modify it
### under the terms of the GNU General Public License as published by
### the Free Software Foundation; either version 2, or (at your
### option) any later version.

### XEmacs is distributed in the hope that it will be useful, but
### WITHOUT ANY WARRANTY; without even the implied warranty of
### MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
### General Public License for more details.

### You should have received a copy of the GNU General Public License
### along with XEmacs; see the file COPYING.  If not, write to the Free
### Software Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
### 02111-1307, USA.

### Since XEmacs has configuration requirements that autoconf can't
### meet, this file is an unholy marriage of custom-baked
### configuration code and autoconf macros.
###
### We use the m4 quoting characters [ ] (as established by the
### autoconf system) to include large sections of raw sewage - Oops, I
### mean, shell code - in the final configuration script.
###
### Usage: configure config_name
###
### If configure succeeds, it leaves its status in config.status.
### If configure fails after disturbing the status quo,
### 	config.status is removed.

### Remove any more than one leading "." element from the path name.
### If we don't remove them, then another "./" will be prepended to
### the file name each time we use config.status, and the program name
### will get larger and larger.  This wouldn't be a problem, except
### that since progname gets recorded in all the Makefiles this script
### produces, move-if-change thinks they're different when they're
### not.
###
### It would be nice if we could put the ./ in a \( \) group and then
### apply the * operator to that, so we remove as many leading ./././'s
### as are present, but some seds (like Ultrix's sed) don't allow you to
### apply * to a \( \) group.  Bleah.
progname="`echo $0 | sed 's:^\./\./:\./:'`"

############################################################################
#									   #
#                     Establish some default values                        #
#									   #
############################################################################

#run_in_place='no'
prefix='/usr/local'
exec_prefix='${prefix}'
bindir='${exec_prefix}/bin'
# FSF 19.29 changes to:
# datadir='${prefix}/share'
# sharedstatedir='${prefix}/com'
# libexecdir='${exec_prefix}/libexec'
datadir='${prefix}/lib'
statedir='${prefix}/lib'
libdir='${exec_prefix}/lib'
mandir='${prefix}/man/man1'
infodir='${prefix}/lib/xemacs-${version}/info'
infodir_user_defined='no'
lispdir='${datadir}/xemacs-${version}/lisp'
lispdir_user_defined='no'
sitelispdir='${datadir}/xemacs/site-lisp'
etcdir='${datadir}/xemacs-${version}/etc'
etcdir_user_defined='no'
lockdir='${statedir}/xemacs/lock'
lockdir_user_defined='no'
archlibdir='${libdir}/xemacs-${version}/${configuration}'
archlibdir_user_defined='no'
with_menubars=''
with_scrollbars=''
with_dialogs=''
const_is_losing='yes'
puresize=''
cflags='NO_CFLAGS_DEFINED'
dynamic=''
with_x11=''
rel_alloc='default'
use_system_malloc='default'
internal_makefile_list='Makefile lib-src/Makefile.in src/Makefile.in lwlib/Makefile.in dynodump/Makefile.in'
energize_version='no'
native_sound_lib=''
# make normal error-checking be the default in alpha and beta versions, so
# that bugs get noticed.  Change this for released versions.
error_check_default='no'
error_check_extents=$error_check_default
error_check_typecheck=$error_check_default
error_check_bufpos=$error_check_default
error_check_gc=$error_check_default
error_check_malloc=$error_check_default
# debug=yes must be set when error checking is present.  This should be
# fixed up.
debug=$error_check_default
quantify='no'
# use-assertions should be 'yes' by default.  Too many people in this
# world have core dumps turned off by default or "can't find where the
# core file went".  At least we should get some useful output ...
use_assertions='yes'
# the following is set to yes or no later.
with_gif=''
# the following is set to yes or no later.
with_toolbars=''
with_tty='yes'
use_union_type='no'

# # gnu echo silently eats `--help', `--version', `-n', `-e', `-E', `-n'.
# # other versions of echo eat any strings beginning with `-n'.
# # when parsing arguments, special case these strings and don't
# # pass them through echo
# echo=/bin/echo
#
# this approach abandoned in favor of
#
#   echo "" ${stuff_to_filter} | sed -e 's:^ ::'

# On Sun systems, people sometimes set up the variable CPP
# with a value that is a directory, not an executable at all.
# Detect that case, and ignore that value.
test -n "$CPP" -a -d "$CPP" && CPP=

############################################################################
#									   #
#                             Usage messages                               #
#									   #
############################################################################

short_usage="Usage: ${progname} CONFIGURATION [-OPTION[=VALUE] ...]

Set compilation and installation parameters for XEmacs, and report.
CONFIGURATION specifies the machine and operating system to build for.

Note that for most of the following options, you can explicitly enable
them using \`--OPTION=yes' and explicitly disable them using \`--OPTION=no'.
This is especially useful for auto-detected options.

Options marked with a (*) are autodetected.

  
General options:

--help			Issue this usage message.
--verbose		Display the results of configure tests.
--extra-verbose		Also display the output of any compiler invocation.
			(Useful when feature tests are coming out wrong.)


Compiler options:

--compiler=XXXX		Specify compiler.
--with-gcc (*)		Use GCC to compile XEmacs.
--with-lcc		Use Lucid's LCC to compile XEmacs.
--with-gcc=no		Don't use GCC to compile XEmacs.
--with-gnu-make		Write the Makefiles to take advantage of
			special features of GNU Make. (GNU Make
			works fine on the Makefiles even without this
			option.  This just allows for simultaneous
			in-place and --srcdir building.)
--cflags=FLAGS		Override the default values for CFLAGS.
--site-includes=DIR	Other header file directories.  Separate multiple
			dirs with spaces and use quotes to enclose.
--site-libraries=DIR	Other library directories.
--site-runtime-libraries=DIR
			Paths to add with -R flag.
--dynamic=yes		Link dynamically if supported by system.
--dynamic=no		Force static linking on systems where dynamic
			linking is the default.
--srcdir=DIR		Look for the XEmacs source files in DIR.
			See also --with-gnu-make.
--const-is-losing=no	Allow the use of const in the source code.


Installation options:
  
--prefix=DIR		Install files below DIR.  Defaults to \`${prefix}'.


Window-system options:

--with-x (*)		Support the X Window System.
--with-x=no		Don't support X.
--x-includes=DIR 	Search for X header files in DIR.
--x-libraries=DIR	Search for X libraries in DIR.
--with-ns		Support NeXTstep windows (not yet implemented).
--with-menubars=TYPE	Use TYPE menubars (lucid, motif, or no).  The Lucid
			widgets emulate Motif (mostly) but are faster.
			*WARNING*  The Motif menubar is currently broken.
--with-scrollbars=TYPE	Use TYPE scrollbars (lucid, motif, athena, 
			athena3d, or no).
--with-dialogs=TYPE	Use TYPE dialog boxes (motif, athena, athena3d, or no).
			(Lucid menubars and scrollbars are the default.
			 Motif dialog boxes will be used if Motif can be
			 found.)
--with-cde (*)		Compile in support for CDE drag and drop.
--with-offix (*)	Compile in support for OffiX drag and drop.
--with-xpm (*)		Compile with support for XPM files.
			It is highly recommended that you obtain XPM
			(version 3.4g or better) if you don't already
			have it.  Get it from the XEmacs FTP site.
--with-xmu=no (*)	For those unfortunates whose vendors don't ship Xmu.


Additional features:

--with-toolbars=no	Don't compile with any toolbar support.
--with-tooltalk		Support the ToolTalk IPC protocol.
--with-sparcworks	Support the Sun Sparcworks development environment.
--with-energize		Support the Lucid Energize development environment.
			This doesn't currently work.
--with-socks		Compile with support for SOCKS (an Internet proxy).
--with-term		Compile with support for TERM (a way to multiplex
			serial lines and provide vaguely Internet-like
			functionality over a simple dialup connection,
			used on Linux and other systems.  NOTE: We can't
			guarantee that our TERM support coexists well
			with standard Internet connections).
--with-xface (*)	Compile with support for X-Face mail header
	  		conversion.  Requires the compface library.
			Get it from the XEmacs FTP site.
--with-gif		Compile with support for GIF image conversion.
			This requires no special support and defaults to
			\`yes'.
--with-jpeg (*)		Compile with support for JPEG image conversion.
			Requires libjpeg from the Independent JPEG Group.
			Get it from the XEmacs FTP site.
--with-png (*)		Compile with support for PNG image conversion.
			Requires libpng.  Get it from the XEmacs FTP site.
			Accepted values are \`yes', \`no', and \`gnuz'
			if you want to use -lgz instead of -lz.
--with-tiff		Compile with support for TIFF image conversion
			(not yet implemented).
--with-database=type (*) Compile with database support.  Valid types are
			\`no' or a comma-separated list of one or more
			of \`dbm', \`gnudbm', or \`berkdb'.
--external-widget	Compile with external widget support.
--with-sound=native (*)	Compile with native sound support.
--with-sound=nas	Compile with network sound support.
--with-sound=both	Compile with native and network sound support.
--native-sound-lib=LIB	Native sound support library.  Needed on Suns
			with --with-sound=both because both sound libraries
			are called libaudio.
--with-epoch		Compile with additional Epoch compatibility.
--with-mocklisp		Compile with Mocklisp support.  Don't do this
			unless you have a Mocklisp program that you need
			to run.
--usage-tracking	Enable some Sun-internal code.  If you don't
			know what this is, you don't want it.

Internationalization options:

--with-mule		Compile with Mule (MUlti-Lingual Emacs) support,
			needed to suport non-Latin-1 (including Asian) languages.
--with-xim=xlib		Compile with support for X input methods,
--with-xim=motif (*)	Used in conjunction with Mule support.
			Use either raw Xlib to provide XIM support, or
			the Motif XmIm* routines (when available).
			If the XmIm* routines are autodetected,
			then the default is --with-xim=motif, else --with-xim=no.
--with-canna		Compile with support for Canna (an input method
			used in conjunction with Mule support).
--with-wnn		Compile with support for WNN (an input method
			used in conjunction with Mule support).
			This doesn't work yet.
--with-i18n3		Compile with I18N level 3 (support for message
			translation).  This doesn't currently work.


Debugging options:

--debug			Compile with support for debugging XEmacs.
			(Causes code-size increase but no loss of speed.)
--error-checking=TYPE[,TYPE]...
			Compile with internal error-checking added.
			Causes noticeable loss of speed.  Valid types
			are extents, bufpos, malloc, gc, typecheck.
--error-checking=none	Disable all internal error-checking (the default).
--error-checking=all	Enable all internal error-checking.
--memory-usage-stats 	Compile with additional code to allow you to
			determine what XEmacs's memory is being used
		        for.  Causes a small code increase but no loss
			of speed.  Normally enabled when --debug is given.
--no-doc-file		Don't rebuild the DOC file unless it's explicitly
			deleted.  Only use during development. (It speeds
			up the compile-run-test cycle.)
--use-union-type	Enable or disable use of a union, instead of an
			int, for the fundamental Lisp_Object type; this
			provides stricter type-checking.  Only works with
			some systems and compilers.
			

Other options:

--puresize=VALUE	Override default amount of space for pure Lisp code.
--rel-alloc		Use the relocating allocator (default for this option
  			is system-dependent).
--use-system-malloc	Force use of the system malloc, rather than GNU
			malloc.

You may also specify any of the \`path' variables found in
Makefile.in, including --bindir, --libdir, --lispdir, --datadir, and
so on.  Note that we recommend against explicitly setting any of these
variables.  See the INSTALL file for a complete list plus the reasons
we advise not changing them.

If successful, ${progname} leaves its status in config.status.  If
unsuccessful after disturbing the status quo, it removes config.status."

############################################################################
#									   #
#                           Options processing                             #
#									   #
############################################################################

### Record all the arguments, so we can save them in config.status.
arguments="$@"

### Shell Magic: Quote the quoted arguments in ARGUMENTS.  At a later date,
### in order to get the arguments back in $@, we have to do an
###  `eval set x "$quoted_arguments"; shift'.
quoted_arguments=
for i in "$@"; do
   quoted_arguments="$quoted_arguments '$i'"
done

### Don't use shift -- that destroys the argument list, which autoconf needs
### to produce config.status.  It turns out that "set - ${arguments}" doesn't
### work portably.
### However, it also turns out that many shells cannot expand ${10} at all.
### So using an index variable doesn't work either.  It is possible to use
### some shell magic to make 'set x "$arguments"; shift' work portably.
while test $# != 0; do
  arg="$1"; shift
  case "${arg}" in

    ## Anything starting with a hyphen we assume is an option.
    -* )
      ## Separate the switch name from the value it's being given.
      case "${arg}" in
        -*=*)
	  opt=`echo '' ${arg} | sed -e 's:^ ::' -e 's:^-*\([^=]*\)=.*$:\1:'`
	  val=`echo '' ${arg} | sed -e 's:^ ::' -e 's:^-*[^=]*=\(.*\)$:\1:'`
	  valomitted=no
	;;
#         ## special case these strings since echo may
#         ## silently eat them.
#         --help ) opt=help val=yes valomitted=yes ;;
#         --version ) opt=version val=yes valomitted=yes ;;
#         -e ) opt=e val=yes valomitted=yes ;;
#         -E ) opt=E val=yes valomitted=yes ;;
#         -n ) opt=n val=yes valomitted=yes ;;
        -*)
          ## If FOO is a boolean argument, --FOO is equivalent to
          ## --FOO=yes.  Otherwise, the value comes from the next
          ## argument - see below.
	  opt=`echo '' ${arg} | sed -e 's:^ ::' -e 's:^-*\(.*\)$:\1:'`
          val="yes"
          valomitted=yes
        ;;
      esac

      ## Change `-' in the option name to `_'.
      optname="${opt}"
      opt="`echo '' ${opt} | sed -e 's:^ ::' | tr - _`"

      ## Process the option.
      case "${opt}" in

      ## Process (many) boolean options
	run_in_place	| \
	with_x		| \
	with_x11	| \
	with_gcc	| \
	with_lcc	| \
	with_gnu_make	| \
	with_epoch	| \
	dynamic		| \
	with_term	| \
	with_cde	| \
	with_offix	| \
	with_xpm	| \
	with_gif	| \
	with_jpeg	| \
	with_tiff	| \
	with_socks	| \
	with_xface	| \
	with_xmu	| \
	quantify	| \
	with_ns		| \
	with_toolbars	| \
	with_tty	| \
	with_i18n3	| \
	with_mule	| \
	with_canna	| \
	with_wnn	| \
	with_mocklisp	| \
	with_energize	| \
	with_sparcworks | \
	with_tooltalk   | \
	external_widget | \
	extra_verbose   | \
	const_is_losing | \
	usage_tracking  | \
	use_union_type  | \
	debug		| \
	use_assertions	| \
	memory_usage_stats | \
	no_doc_file )	
	  ## Make sure the value given was either "yes" or "no".
	  case "${val}" in
	    y | ye | yes )	val=yes ;;
	    n | no )		val=no  ;;
	    * )
	      (echo "${progname}: the \`--${optname}' option is supposed to have a boolean value.
Set it to either \`yes' or \`no'."
	       echo "${short_usage}") >&2
	      exit 1 ;;
	  esac
          eval "${opt}=\"${val}\"" ;;

    
	## Options that take a user-supplied value, as in --puresize=8000000
	srcdir		| \
	compiler	| \
	puresize	| \
	native_sound_lib	| \
	x_includes	| \
	x_libraries	| \
	site_includes	| \
	site_libraries	| \
	site_runtime_libraries  )
	  ## If the value was omitted, get it from the next argument.
	  if test "${valomitted}" = "yes" ; then
	    ## Get the next argument from the argument list, if there is one.
            if test $# = 0 ; then
	      (echo "${progname}: You must give a value for the \`--${optname}' option, as in
    \`--${optname}=FOO'."
	       echo "${short_usage}") >&2
	      exit 1
	    fi
	    val="$1"; shift
	  fi
          eval "${opt}=\"${val}\""
	;;

	### Options that take "yes", "no", or "default" values
	rel_alloc | \
	use_system_malloc )
	  case "${val}" in
	    y | ye | yes )	val=yes ;;
	    n | no )		val=no  ;;
	    d | de | def | defa | defau | defaul | default )
				val=default ;;
	    * )
	      (echo "${progname}: the \`--${optname}' option is supposed to have a boolean value or \`default'.
Set it to either \`yes', \`no', or \`default'."
	       echo "${short_usage}") >&2
	      exit 1
	    ;;
	  esac
          eval "${opt}=\"${val}\""
        ;;

        ## Has the user requested database support?
        "with_database" )
	  if test "${val}" = "no"  ; then
	    with_database_berkdb=no
	    with_database_dbm=no
	    with_database_gnudbm=no
	  else
            ## Make sure the value given was berkdb, dbm, gnudbm, or a list
	    for x in `echo "${val}" | sed 's/,/ /'` ; do
	      case "${x}" in
                b | be | ber | berk | berkd | berkdb )  with_database_berkdb=yes ;;
                d | db | dbm )				with_database_dbm=yes ;;
		g | gn | gnu | gnud | gnudb | gnudbm )  with_database_gnudbm=yes ;;
		* )
                  (echo "${progname}: the \`--${optname}' option is supposed to be either \`no'
  or a comma-separated list of one or more of \`berkdb', \`dbm', or \`gnudbm'."
                   echo "${short_usage}") >&2
                  exit 1
                ;;
              esac
	    done
	    if test "${with_database_dbm}" = "yes" -a "${with_database_gnudbm}" = "yes"
	    then
	      (echo "${progname}: only one of \`dbm' and \`gnudbm' should be specified.") >&2
	      exit 1
	    fi
	  fi
        ;;

        ## Has the user requested sound support?
	"with_sound" )
	  ## value can be native, nas or both. yes is allowed 
	  ## as a backwards compatible synonym for native
	  case "${val}" in
	    y | ye | yes )			val=native ;;
	    n | no | non | none )		val=no;;
	    na | nat | nati | nativ | native )	val=native  ;;
	    ne | net | neta | netau | netaud | netaudi | netaudio | nas )	val=nas  ;;
	    b | bo | bot | both )		val=both;;
	    * )
	      (echo "${progname}: the \`--${optname}' option should have one of the values:"
		echo "\`native', \`nas', \`both', or \`none'."
		echo ""
		echo "${short_usage}") >&2
	      exit 1
	    ;;
	  esac
          eval "${opt}=\"${val}\""
        ;;

        ## Has the user requested XIM support?
	"with_xim" )
	  ## value can be xlib or motif
	  ## as a backwards compatible synonym for native
	  case "${val}" in
	    y | ye | yes )			val=yes   ;;
	    n | no | non | none )		val=no    ;;
	    x | xl | xli | xlib )		val=xlib  ;;
	    m | mo | mot | moti | motif )	val=motif ;;
	    * )
	      (echo "${progname}: the \`--${optname}' option should have one of the values:"
		echo "\`motif', \`xlib', \`yes', or \`no'."
		echo ""
		echo "${short_usage}") >&2
	      exit 1
	    ;;
	  esac
          eval "${opt}=\"${val}\""
        ;;

        ## Has the user requested PNG support?
	"with_png" )
	  ## Make sure the value given was either "yes", "no", or "gnuz".
	  case "${val}" in
	    y | ye | yes )	  val=yes  ;;
	    n | no )		  val=no   ;;
	    g | gn | gnu | gnuz ) val=gnuz ;;
	    * )
	      (echo "${progname}: the \`--${optname}' option is supposed to
  be either \`yes', \`no', or \`gnuz'."
	       echo "${short_usage}") >&2
	      exit 1
	    ;;
	  esac
          eval "${opt}=\"${val}\""
        ;;

        ## Has the user requested error-checking?
	"error_checking" )
	  ## value can be all, none, and/or a list of categories to check.
	  ## Example: --error-checking=all,noextents,nobufpos
	  ## Example: --error-checking=none,malloc,gc
	  
	  for x in `echo "${val}" | sed 's/,/ /'` ; do
	    case "${x}" in
	      # all and none are only permitted as the first in the list.
	      n | no | non | none ) new_default=no ;;
	      a | al | all )	    new_default=yes ;;

	      extents )       error_check_extents=yes ;;
	      noextents )     error_check_extents=no ;;

	      typecheck )     error_check_typecheck=yes ;;
	      notypecheck )   error_check_typecheck=no ;;

	      bufpos )	      error_check_bufpos=yes ;;
	      nobufpos )      error_check_bufpos=no ;;

	      gc )	      error_check_gc=yes ;;
	      nogc )          error_check_gc=no ;;

	      malloc )	      error_check_malloc=yes ;;
	      nomalloc )      error_check_malloc=no ;;
	      
	      * ) bogus_error_check=yes ;;
	    esac
	    if test "$bogus_error_check" -o \
	         \( -n "$new_default" -a -n "$echeck_notfirst" \) ; then
		( echo "${progname}: Valid types for the \`--${optname}' option are:"
		if test $error_check_default = yes ; then
		  echo "\`all' (default), \`none', \`noextents', \`notypecheck', \`nobufpos', \`nogc', and \`nomalloc'."
		else
		  echo "\`all', \`none' (default), \`extents', \`typecheck', \`bufpos', \`gc', and \`malloc'."
		fi
		echo "${short_usage}" ) >&2
		exit 1
	    elif test "$new_default" ; then
		error_check_extents=$new_default
		error_check_typecheck=$new_default
		error_check_bufpos=$new_default
		error_check_gc=$new_default
		error_check_malloc=$new_default
		new_default=	# reset this
	    fi
	    echeck_notfirst=true
	  done
	;;

	## Has the user tried to tell us where the X files are?
	## I think these are dopey, but no less than three alpha
	## testers, at large sites, have said they have their X files
	## installed in odd places.

	## Has the user specified one of the path options?
	prefix | exec_prefix | bindir | datadir | statedir | libdir | \
	mandir | infodir | lispdir | etcdir | lockdir | archlibdir | \
	sitelispdir | docdir )
	   ## If the value was omitted, get it from the next argument.
	   if test "${valomitted}" = "yes" ; then
	      if test $# = 0 ; then
		 (echo \
"$progname: You must give a value for the \`--${optname}' option,";
		  echo \
"as in \`--${optname}=`eval echo '$'$optname`.'"
		  echo "$short_usage") >&2
		 exit 1
	      fi
	      val="$1"; shift
	   fi
	   eval "${opt}=\"${val}\""

           ## Changing exec_prefix or libdir will change the default value
           ## of archlibdir.  Changing datadir will change the default value
           ## of etcdir and lispdir.  Changing statedir will change the
           ## default value of lockdir.
           if   test "${opt}" = exec_prefix; then archlibdir_user_defined=yes
           elif test "${opt}" = libdir     ; then archlibdir_user_defined=yes
           elif test "${opt}" = archlibdir ; then archlibdir_user_defined=yes
           elif test "${opt}" = lispdir    ; then lispdir_user_defined=yes
           elif test "${opt}" = etcdir     ; then etcdir_user_defined=yes
           elif test "${opt}" = datadir    ; then
              lispdir_user_defined=yes
              etcdir_user_defined=yes
           elif test "${opt}" = statedir   ; then lockdir_user_defined=yes
           elif test "${opt}" = lockdir    ; then lockdir_user_defined=yes
           elif test "${opt}" = infodir    ; then infodir_user_defined=yes
           fi
	;;

	## Has the user specified values to override CFLAGS?
	cflags )
	   ## If the value was omitted, get it from the next argument.
	   if test "${valomitted}" = "yes" ; then
	      if test $# = 0 ; then
		 (echo \
"$progname: You must give a value for the \`--${optname}' option,";
		  echo \
"as in \`--${optname}=`eval echo '$'$optname`-g -O'"
		  echo "$short_usage") >&2
		 exit 1
	      fi
	      val="$1"; shift
	   fi
	   eval "${opt}=\"${val}\""
	   eval "${opt}_specified=1"
	;;

	## Verbose flag, tested by autoconf macros.
	"verbose" )
	  verbose=yes
	;;

	## --no-create added by autoconf for use by config.status
	"no_create" )
	;;

	## Has the user asked for some help?
	"usage" | "help" )
	  if test -z "$PAGER"
	  then echo "${short_usage}" | more
	  else echo "${short_usage}" | $PAGER
	  fi
	  exit
	;;

	## Has the user specified what toolkit to use for the menubars,
	## scrollbar or dialogs?
	"with_menubars" | "with_scrollbars" | "with_dialogs" )
	  ## value can be lucid, motif, or athena.
	  case "${val}" in
	    l | lu | luc | luci | lucid )		val=lucid  ;;
	    m | mo | mot | moti | motif )		val=motif  ;;
	    athena3d | athena-3d )			val=athena3d ;;
	    a | at | ath | athe | athen | athena )	val=athena ;;
	    n | no | non | none )			val=no ;;
	    * )
	      (echo "${progname}: the \`--${optname}' option should have one of the values:"
		echo "\`lucid', \`motif', \`athena', or \`no'."
		echo ""
		echo "${short_usage}") >&2
	      exit 1
	    ;;
	  esac
	  eval "${opt}=\"${val}\""
	;;

        ## Fail on unrecognized arguments.
	* )
	  (echo "${progname}: Error: unrecognized option: ${arg}"
	   echo ""
           echo "${short_usage}") >& 2
	  exit 1
	;;

      esac
    ;;

    ## Anything not starting with a hyphen we assume is a
    ## configuration name.
    *)
      configuration=${arg}
    ;;

  esac
done

############################################################################
#									   #
#                          Finish options processing                       #
#									   #
############################################################################

### Get the arguments back.  See the diatribe on Shell Magic above.
eval set x "$quoted_arguments"; shift

### Argument interdependencies
if test "${with_energize}" = "yes" ; then
  with_menubars="lucid"
  with_scrollbars="motif"
  with_dialogs="motif"
  with_tooltalk="yes"
  internal_makefile_list="$internal_makefile_list lwlib/energize/Makefile.in"
fi

### --extra-verbose implies --verbose
test "${extra_verbose}" = yes && verbose=yes

### Sparcworks requires tooltalk
test "${with_sparcworks}" = yes && with_tooltalk=yes

### debug implies other options
test "${debug}" = "yes" && use_assertions=yes memory_usage_stats=yes

### with_x is a synonym for with_x11
test -n "${with_x}" && with_x11="${with_x}"

### Can't specify 2 compilers
if test "${with_gcc}" = "yes" -a "${with_lcc}" = "yes"; then
  (echo "${progname}: only one of --with-gcc and --with-lcc may be specified."
   echo "${short_usage}") >&2
  exit 1
fi

### Ignore useless run-in-place flag
if test "${run_in_place}" = "yes"; then
   echo "configure: warning: The --run-in-place option is ignored because it is unnecessary." >&2 
fi

###########################################################################
if test "${configuration}" = "" ; then
  echo '- You did not tell me what kind of host system you want to configure.
- I will attempt to guess the kind of system this is.' 1>&2
  guesssys=`echo ${progname} | sed 's/configure$/config.guess/'`
  if configuration=`${CONFIG_SHELL-/bin/sh} ${guesssys}` ; then
    echo "- Looks like this is a ${configuration}" 1>&2
  else
    echo '- Failed to guess the system type.  You need to tell me.' 1>&2
    echo "${short_usage}" >&2
    exit 1
  fi
fi

### Find the source directory.
case "${srcdir}" in

  ## If it's not specified, see if  `.' or `..' might work.
  "" )
    for dir in "`echo $0 | sed 's|//|/|' | sed 's|/[^/]*$||'`" "." ".." ; do
      if test -f "$dir/src/lisp.h" -a -f "$dir/lisp/version.el" ; then
        srcdir="${dir}"
        break
      fi
    done
    if test -z "${srcdir}" ; then
      echo "\
${progname}: Neither the current directory nor its parent seem to
contain the XEmacs sources.  If you do not want to build XEmacs in its
source tree, you should run \`${progname}' in the directory in which
you wish to build XEmacs, using its \`--srcdir' option to say where the
sources may be found.
${short_usage}" >&2
	exit 1
      fi
  ;;

  ## Otherwise, check if the directory they specified is okay.
  * )
    if test ! -d "${srcdir}" -o ! -f "${srcdir}/src/lisp.h" -o ! -f "${srcdir}/lisp/version.el" ; then
      (echo "\
${progname}: The directory specified with the \`--srcdir' option,
\`${srcdir}', doesn't seem to contain the XEmacs sources.  You should
either run the \`${progname}' script at the top of the XEmacs source
tree, or use the \`--srcdir' option to specify where the XEmacs sources
are."
       echo "${short_usage}") >&2
      exit 1
    fi
  ;;
esac

## We check for this now instead of later when we check for other
## programs because we need to use its return value now.
 test -n "$silent" || echo "checking for ln -s"
rm -f conftestdata
if ln -s X conftestdata 2>/dev/null
then
  rm -f conftestdata
  LN_S="ln -s"
else
  LN_S=ln
fi



test -n "$verbose" && echo "	"setting LN_S to ${LN_S}""

#### Make symlinks for etc, lisp, and info directories while the path
#### is still relative.  We don't symlink lock because someone may
#### have stuck the source on a read-only partition.  Instead we'll
#### create it as an actual directory later on if it doesn't already
#### exist.
for dir in  etc lisp man info
do
  if test ! -d $dir ; then
    echo Making symbolic link to ${srcdir}/$dir
    ${LN_S} ${srcdir}/$dir .
  fi
done

#### Make srcdir absolute, if it isn't already.  It's important to
#### avoid running the path through pwd unnecessary, since pwd can
#### give you automounter prefixes, which can go away.
case "${srcdir}" in
  /* ) ;;
  . )
    ## We may be able to use the $PWD environment variable to make this
    ## absolute.  But sometimes PWD is inaccurate.
    if test "${PWD}" != "" -a "`(cd ${PWD} ; sh -c pwd)`" = "`pwd`"; then
      srcdir="$PWD"
    else
      srcdir="`(cd ${srcdir}; pwd)`"
    fi
  ;;
  *  ) srcdir="`(cd ${srcdir}; pwd)`" ;;
esac

#### Check if the source directory already has a configured system in it.
if test `pwd` != `sh -c cd ${srcdir} && pwd`  \
   && test -f "${srcdir}/src/config.h"; then
  (echo "${progname}: WARNING: The directory tree \`${srcdir}' is being used"
   echo "   as a build directory right now; it has been configured in its own"
   echo "   right.  To configure in another directory as well, you MUST"
   echo "   use GNU make.  If you do not have GNU make, then you must"
   echo "   now do \`make distclean' in ${srcdir},"
   echo "   and then run ${progname} again.") >&2
  extrasub='/^VPATH[	 ]*=/c\
vpath %.c $(srcdir)\
vpath %.h $(srcdir)\
vpath %.y $(srcdir)\
vpath %.l $(srcdir)\
vpath %.s $(srcdir)\
vpath %.in $(srcdir)'
fi

### Make the necessary directories, if they don't exist.
for dir in ./src ./lib-src ./dynodump ./lwlib ./lock ; do
  if test ! -d ${dir} ; then
    mkdir ${dir}
  fi
done
if test "${with_energize}" = "yes" -a ! -d ./lwlib/energize; then
  mkdir ./lwlib/energize
fi

############################################################################
#									   #
#                       Determine the s&m files to use                     #
#									   #
############################################################################

#### Given the configuration name, set machfile and opsysfile to the
#### names of the m/*.h and s/*.h files we should use.

### Canonicalize the configuration name.
echo "checking the configuration name"
# allow -energize prefix on configuration name
internal_configuration=`echo ${configuration} | sed 's/-energize//'`
# allow --sparcworks prefix on configuration name
internal_configuration=`echo ${configuration} | sed 's/-sparcworks//'`
if canonical=`${srcdir}/config.sub "${internal_configuration}"` ; then : ; else
  exit $?
fi

### If you add support for a new configuration, add code to this
### switch statement to recognize your configuration name and select
### the appropriate operating system and machine description files.

### You would hope that you could choose an m/*.h file pretty much
### based on the machine portion of the configuration name, and an s-
### file based on the operating system portion.  However, it turns out
### that each m/*.h file is pretty manufacturer-specific - for
### example, apollo.h, hp9000s300.h, mega68k, news.h, and tad68k are
### all 68000 machines; mips.h, pmax.h, and news-risc are all MIPS
### machines.  So we basically have to have a special case for each
### configuration name.
###
### As far as handling version numbers on operating systems is
### concerned, make sure things will fail in a fixable way.  If
### /etc/MACHINES doesn't say anything about version numbers, be
### prepared to handle anything reasonably.  If version numbers
### matter, be sure /etc/MACHINES says something about it.
###
### Eric Raymond says we should accept strings like "sysvr4" to mean
### "System V Release 4"; he writes, "The old convention encouraged
### confusion between `system' and `release' levels'."

machine='' opsys='' unported=no need_dynodump=no
case "${canonical}" in

  ## NetBSD ports
  *-*-netbsd* )
    opsys=netbsd
    case "${canonical}" in
      sparc-*-netbsd*)    machine=sparc ;;
      i[3-9]86-*-netbsd*) machine=intel386 ;;
      hp300-*-netbsd* | amiga-*-netbsd* | sun3-*-netbsd* | mac68k-*-netbsd* | da30-*-netbsd* | m68k-*-netbsd* )
                      # Yes, this is somewhat bogus.
                      machine=hp9000s300 ;;
      pc532-*-netbsd* | ns32k-*-netbsd* )  machine=ns32000 ;;
      pmax-*-netbsd*  | mips-*-netbsd*  )  machine=pmax ;;
    esac
  ;;

  ## Acorn RISCiX:
  arm-acorn-riscix1.1* ) machine=acorn opsys=riscix1-1 ;;
  arm-acorn-riscix1.2* | arm-acorn-riscix ) machine=acorn opsys=riscix1-2 ;;

  ## Alliant machines
  ## Strictly speaking, we need the version of the alliant operating
  ## system to choose the right machine file, but currently the
  ## configuration name doesn't tell us enough to choose the right
  ## one; we need to give alliants their own operating system name to
  ## do this right.  When someone cares, they can help us.
  fx80-alliant-* ) machine=alliant4     opsys=bsd4-2 ;;
  i860-alliant-* ) machine=alliant-2800 opsys=bsd4-3 ;;

  ## Alpha (DEC) machines.
  ## XEmacs change: split apart into numerous files.
  alpha-dec-osf1.3 | alpha-dec-osf2* ) machine=alpha opsys=decosf1-3 ;;
  alpha-dec-osf1.2 | alpha-dec-osf1* ) machine=alpha opsys=decosf1-2 ;;

  ## XEmacs: Add switch for OSF 1 version 3 (roth@cse.ucsc.edu)
  ## XEmacs: Add switch for Digital Unix version 4 (srivasta@pilgrim.umass.edu)
  alpha-dec-osf3.[2-9] ) machine=alpha opsys=decosf3-2 ;;
  alpha-dec-osf3* )      machine=alpha opsys=decosf3-1 ;;
  alpha-dec-osf4* )      machine=alpha opsys=decosf4-0 ;;
  alpha-*-linux* )       machine=alpha opsys=linux ;;

  ## Altos 3068
  m68*-altos-sysv* ) machine=altos opsys=usg5-2 ;;

  ## Amdahl UTS
  580-amdahl-sysv* ) machine=amdahl opsys=usg5-2-2 ;;

  ## Apollo, Domain/OS
  m68*-apollo-* ) machine=apollo opsys=bsd4-3 ;;
  
  ## AT&T 3b2, 3b5, 3b15, 3b20
  we32k-att-sysv* ) machine=att3b opsys=usg5-2-2 ;;

  ## AT&T 3b1 - The Mighty Unix PC!
  m68*-att-sysv* ) machine=7300 opsys=usg5-2-2 ;;

  ## Bull machines
  rs6000-bull-bosx* ) machine=ibmrs6000 opsys=aix3-2 ;; # dpx20
  m68*-bull-sysv3*  ) machine=dpx2      opsys=usg5-3 ;; # dpx2
  m68*-bull-sysv2*  ) machine=sps7      opsys=usg5-2 ;; # sps7

  ## CCI 5/32, 6/32 -- see "Tahoe".

  ## Celerity
  ## I don't know what configuration name to use for this; config.sub
  ## doesn't seem to know anything about it.  Hey, Celerity users, get
  ## in touch with us!
  celerity-celerity-bsd* ) machine=celerity opsys=bsd4-2 ;;

  ## Clipper
  ## What operating systems does this chip run that XEmacs has been
  ## tested on?
  clipper-* ) machine=clipper
    ## We'll use the catch-all code at the bottom to guess the
    ## operating system.
  ;;

  ## Convex
  *-convex-bsd* | *-convex-convexos* )
    machine=convex opsys=bsd4-3
    ## Prevents spurious white space in makefiles - d.m.cooke@larc.nasa.gov
    NON_GNU_CPP="cc -E -P"
  ;;

  ## Cubix QBx/386
  i[3-9]86-cubix-sysv* ) machine=intel386 opsys=usg5-3 ;;

  ## Cydra 5
  cydra*-cydrome-sysv* ) machine=cydra5 opsys=usg5-3 ;;

  ## Data General AViiON Machines
  i586-dg-dgux*R4* | i586-dg-dgux5.4.4* ) machine=aviion opsys=dgux5-4r4 ;;
  m88k-dg-dgux5.4R3* | m88k-dg-dgux5.4.3* ) machine=aviion opsys=dgux5-4r3 ;;
  m88k-dg-dgux5.4R2* | m88k-dg-dgux5.4.2* ) machine=aviion opsys=dgux5-4r2 ;;
  m88k-dg-dgux* 			  ) machine=aviion opsys=dgux	   ;;

  mips-dec-ultrix[0-3].* | mips-dec-ultrix4.0* | mips-dec-bsd4.2* ) machine=pmax opsys=bsd4-2 ;;
  mips-dec-ultrix4.[12]* | mips-dec-bsd* ) machine=pmax opsys=bsd4-3 ;;
  mips-dec-ultrix* )                       machine=pmax opsys=ultrix4-3 ;;
  mips-dec-osf* )                          machine=pmax opsys=osf1 ;;
  mips-dec-mach_bsd4.3* )                  machine=pmax opsys=mach-bsd4-3 ;;

  ## Motorola Delta machines
  m68k-motorola-sysv* | m68000-motorola-sysv* )
    machine=delta opsys=usg5-3
    if test -z "`type gnucc | grep 'not found'`"
    then
      if test -s /etc/167config
      then CC="gnucc -m68040"
      else CC="gnucc -m68881"
      fi
    else
      if test -z "`type gcc | grep 'not found'`"
      then CC=gcc
      else CC=cc
      fi
    fi
  ;;
  m88k-motorola-sysv4* )
    # jbotte@bnr.ca says that UNIX_System_V <hostName> 4.0 R40V4.3 m88k mc88110
    # needs POSIX_SIGNALS and therefore needs usg5-4-2.
    # I hope there are not other 4.0 versions for this machine
    # which really need usg5-4 instead.
    machine=delta88k opsys=usg5-4-2
  ;;
  m88k-motorola-sysv* | m88k-motorola-m88kbcs* ) machine=delta88k opsys=usg5-3 ;;

  ## Dual machines
  m68*-dual-sysv*    ) machine=dual opsys=usg5-2   ;;
  m68*-dual-uniplus* ) machine=dual opsys=unipl5-2 ;;

  ## Elxsi 6400
  elxsi-elxsi-sysv* ) machine=elxsi opsys=usg5-2 ;;

  ## Encore machines
  ns16k-encore-bsd* ) machine=ns16000 opsys=umax ;;

  ## Gould Power Node and NP1
  pn-gould-bsd4.2* ) machine=gould     opsys=bsd4-2 ;;
  pn-gould-bsd4.3* ) machine=gould     opsys=bsd4-3 ;;
  np1-gould-bsd* )   machine=gould-np1 opsys=bsd4-3 ;;

  ## Harris Night Hawk machines running CX/UX (a 5000 looks just like a 4000
  ## as far as XEmacs is concerned).
  m88k-harris-cxux* )
    # Build needs to be different on 7.0 and later releases
    case "`uname -r`" in
       [56].[0-9] ) machine=nh4000 opsys=cxux  ;;
       [7].[0-9]  ) machine=nh4000 opsys=cxux7 ;;
    esac
    NON_GNU_CPP="/lib/cpp"
  ;;
  ## Harris ecx or gcx running CX/UX (Series 1200, Series 3000)
  m68k-harris-cxux* ) machine=nh3000 opsys=cxux ;;
  ## Harris power pc NightHawk running Power UNIX (Series 6000)
  powerpc-harris-powerunix )
    machine=nh6000 opsys=powerunix
    NON_GNU_CPP="cc -Xo -E -P"
  ;;

  ## Honeywell XPS100
  xps*-honeywell-sysv* ) machine=xps100 opsys=usg5-2 ;;

  ## HP 9000 series 200 or 300
  m68*-hp-bsd* ) machine=hp9000s300 opsys=bsd4-3 ;;

  ## HP-UX on HP's
  *-hp-hpux* )
    NON_GNU_CC="cc -Aa"
    NON_GNU_CPP="cc -Aa -E"

    ### Figure out machine and opsys orthogonally
    case "${canonical}" in
      m68*  ) machine=hp9000s300 ;;
      hppa* ) machine=hp800      ;;
    esac

    case "${canonical}" in
      *-hp-hpux7*     )  opsys=hpux       ;;
      *-hp-hpux8*     )  opsys=hpux8      ;;
      *-hp-hpux9*     )  opsys=hpux9      ;;
      *-hp-hpux10*    )  opsys=hpux10     ;;
      * )
        case "`uname -r`" in
	  ## Someone's system reports A.B8.05 for this.
	  ## I wonder what other possibilities there are.
	  *.B8.* )  opsys=hpux8  ;;
	  *.08.* )  opsys=hpux8  ;;
	  *.09.* )  opsys=hpux9  ;;
	  *.10.* )  opsys=hpux10 ;;
	  *      )  opsys=hpux   ;;
        esac
      ;;
    esac

    if test $opsys = hpux10 ; then
      NON_GNU_CC="cc -Ae"
      NON_GNU_CPP="cc -Ae -E"
    fi

    case "${canonical}" in *-hp-hpux*shr* ) opsys="${opsys}-shr" ;; esac
  ;;

  hppa-*-nextstep* ) machine=hp800 opsys=nextstep ;;

  ## Orion machines
  orion-orion-bsd*   ) machine=orion    opsys=bsd4-2 ;;
  clipper-orion-bsd* ) machine=orion105 opsys=bsd4-2 ;;

  ## IBM machines
  i[3-9]86-ibm-aix1.1* ) machine=ibmps2-aix opsys=usg5-2-2 ;;
  i[3-9]86-ibm-aix1.[23]* | i[3-9]86-ibm-aix* ) machine=ibmps2-aix opsys=usg5-3 ;;
  i370-ibm-aix*) machine=ibm370aix opsys=usg5-3 ;;
  rs6000-ibm-aix3.1*  | powerpc-ibm-aix3.1*  ) machine=ibmrs6000 opsys=aix3-1	;;
  rs6000-ibm-aix3.2.5 | powerpc-ibm-aix3.2.5 ) machine=ibmrs6000 opsys=aix3-2-5	;;
  rs6000-ibm-aix4.2*  | powerpc-ibm-aix4.2*  ) machine=ibmrs6000 opsys=aix4-2	;;
  rs6000-ibm-aix4.1*  | powerpc-ibm-aix4.1*  ) machine=ibmrs6000 opsys=aix4-1	;;
  rs6000-ibm-aix4*    | powerpc-ibm-aix4*    ) machine=ibmrs6000 opsys=aix4	;;
  rs6000-ibm-aix*     | powerpc-ibm-aix*     ) machine=ibmrs6000 opsys=aix3-2	;;
  romp-ibm-bsd4.3* ) machine=ibmrt opsys=bsd4-3 ;;
  romp-ibm-bsd4.2* ) machine=ibmrt opsys=bsd4-2 ;;
  romp-ibm-aos4.3* ) machine=ibmrt opsys=bsd4-3 ;;
  romp-ibm-aos4.2* ) machine=ibmrt opsys=bsd4-2 ;;
  romp-ibm-aos*    ) machine=ibmrt opsys=bsd4-3 ;;
  romp-ibm-bsd*    ) machine=ibmrt opsys=bsd4-3 ;;
  romp-ibm-aix*    ) machine=ibmrt-aix opsys=usg5-2-2 ;;
  romp-ibm-mach*   ) machine=ibmrt opsys=mach-bsd4-3 ;;

  ## Integrated Solutions `Optimum V'
  m68*-isi-bsd4.2* ) machine=isi-ov opsys=bsd4-2 ;;
  m68*-isi-bsd4.3* ) machine=isi-ov opsys=bsd4-3 ;;

  ## Intel 386 machines where we do care about the manufacturer
  i[3-9]86-intsys-sysv* ) machine=is386 opsys=usg5-2-2 ;;

  ## Prime EXL
  i[3-9]86-prime-sysv* ) machine=i386 opsys=usg5-3 ;;

  ## Sequent Symmetry running Dynix
  i[3-9]86-sequent-bsd* ) machine=symmetry opsys=bsd4-3 ;;

  ## Sequent Symmetry running DYNIX/ptx
  ## Use the old cpp rather than the newer ANSI one.
  i[3-9]86-sequent-ptx* )
    machine=sequent-ptx opsys=ptx
    NON_GNU_CPP="/lib/cpp"
  ;;

  ## Unspecified sysv on an ncr machine defaults to svr4.2.
  ## (Plain usg5-4 doesn't turn on POSIX signals, which we need.)
  i[3-9]86-ncr-sysv* ) machine=ncr386 opsys=usg5-4-2 ;;

  ## Intel Paragon OSF/1
  i860-intel-osf1* ) machine=paragon opsys=osf1 NON_GNU_CPP=/usr/mach/lib/cpp ;;

  ## Intel 860
  i860-*-sysv4* )
    machine=i860 opsys=usg5-4
    NON_GNU_CC="/bin/cc" # Ie, not the one in /usr/ucb/cc.
    NON_GNU_CPP="/usr/ccs/lib/cpp" # cc -E tokenizes macro expansion.
  ;;

  ## Masscomp machines
  m68*-masscomp-rtu* ) machine=masscomp opsys=rtu ;;

  ## Megatest machines
  m68*-megatest-bsd* ) machine=mega68 opsys=bsd4-2 ;;

  ## Workstations sold by MIPS
  ## This is not necessarily all workstations using the MIPS processor -
  ## Irises are produced by SGI, and DECstations by DEC.

  ## etc/MACHINES lists mips.h and mips4.h as possible machine files,
  ## and usg5-2-2 and bsd4-3 as possible OS files.  The only guidance
  ## it gives for choosing between the alternatives seems to be "Use
  ## -machine=mips4 for RISCOS version 4; use -opsystem=bsd4-3 with
  ## the BSD world."  I'll assume that these are instructions for
  ## handling two odd situations, and that every other situation
  ## should use mips.h and usg5-2-2, they being listed first.
  mips-mips-usg* )
    machine=mips4
    ## Fall through to the general code at the bottom to decide on the OS.
  ;;
  mips-mips-riscos4 )
    machine=mips4
    NON_GNU_CC="cc -systype bsd43"
    NON_GNU_CPP="cc -systype bsd43 -E"
    case "${canonical}" in
      mips-mips-riscos4* ) opsys=bsd4-3  ;;
      mips-mips-riscos5* ) opsys=riscos5 ;;
    esac
  ;;
  mips-mips-bsd* ) machine=mips opsys=bsd4-3 ;;
  mips-mips-*    ) machine=mips opsys=usg5-2-2 ;;

  ## NeXT
  m68*-next-* | m68k-*-nextstep* ) machine=m68k opsys=nextstep ;;

  ## The complete machine from National Semiconductor
  ns32k-ns-genix* ) machine=ns32000 opsys=usg5-2 ;;

  ## NCR machines
  m68*-ncr-sysv2* | m68*-ncr-sysvr2* ) machine=tower32   opsys=usg5-2-2 ;;
  m68*-ncr-sysv3* | m68*-ncr-sysvr3* ) machine=tower32v3 opsys=usg5-3 ;;

  ## Nixdorf Targon 31
  m68*-nixdorf-sysv* ) machine=targon31 opsys=usg5-2-2 ;;

  ## Nu (TI or LMI)
  m68*-nu-sysv* ) machine=nu opsys=usg5-2 ;;

  ## Plexus
  m68*-plexus-sysv* ) machine=plexus opsys=usg5-2 ;;

  ## Pyramid machines
  ## I don't really have any idea what sort of processor the Pyramid has,
  ## so I'm assuming it is its own architecture.
  pyramid-pyramid-bsd* ) machine=pyramid opsys=bsd4-2 ;;

  ## Sequent Balance
  ns32k-sequent-bsd4.2* ) machine=sequent opsys=bsd4-2 ;;
  ns32k-sequent-bsd4.3* ) machine=sequent opsys=bsd4-3 ;;

  ## Siemens Nixdorf
  mips-siemens-sysv* | mips-sni-sysv*)
    machine=mips-siemens opsys=usg5-4
    NON_GNU_CC=/usr/ccs/bin/cc
    NON_GNU_CPP=/usr/ccs/lib/cpp
  ;;

  ## Silicon Graphics machines
  ## Iris 2500 and Iris 2500 Turbo (aka the Iris 3030)
  m68*-sgi-iris3.5* ) machine=irist opsys=iris3-5 ;;
  m68*-sgi-iris3.6* | m68*-sgi-iris*) machine=irist opsys=iris3-6 ;;
  ## Iris 4D
  mips-sgi-irix3.*      ) machine=iris4d opsys=irix3-3 ;;
  mips-sgi-irix4.*      ) machine=iris4d opsys=irix4-0 ;;
  mips-sgi-irix6*       ) machine=iris4d opsys=irix6-0 ;;
  mips-sgi-irix5.[3-9]* ) machine=iris4d opsys=irix5-3 ;;
  mips-sgi-irix5.2*     ) machine=iris4d opsys=irix5-2 ;;
  mips-sgi-irix5.1*     ) machine=iris4d opsys=irix5-1 ;;
  mips-sgi-irix*        ) machine=iris4d opsys=irix5-0 ;;

  ## SONY machines
  m68*-sony-bsd4.2* ) machine=news opsys=bsd4-2 ;;
  m68*-sony-bsd4.3* ) machine=news opsys=bsd4-3 ;;
  m68*-sony-newsos3* | m68*-sony-news3*) machine=news opsys=bsd4-3 ;;
  mips-sony-bsd* | mips-sony-newsos4* | mips-sony-news4*) machine=news-risc opsys=bsd4-3 ;;
  mips-sony-news* ) machine=news-risc opsys=newsos5 ;;

  ## Stride
  m68*-stride-sysv* ) machine=stride opsys=usg5-2 ;;

  ## Suns
  sparc-*-linux* ) machine=sparc opsys=linux ;;

  *-*-solaris* | *-*-sunos* | *-sun-mach* | *-sun-bsd* )
    # Hardware type
    case "${canonical}" in
      m68*-sunos1* )	         machine=sun1     ;;
      m68*-sunos2* )	         machine=sun2     ;;
      m68* )		         machine=sun3     ;;
      i[3-9]86*-sun-sunos[34]* ) machine=sun386   ;;
      i[3-9]86-*-* )	         machine=intel386 ;;
      rs6000* )                  machine=rs6000   ;;
      sparc* )		         machine=sparc    ;;
      powerpc* )	         machine=powerpc  ;;
      * )		         unported=yes     ;;
    esac
    
    # Make `canonical' even more so.
    case "${canonical}" in *-sunos5*) 
      canonical="`echo \"${canonical}\" | sed -e s/sunos5/solaris2/`";;
    esac

    # On SunOS 4, use /usr/lib/cpp,     sans dynodump, /bin/ranlib
    # On SunOS 5, use /usr/ccs/lib/cpp, need dynodump, RANLIB not needed
    # But, SunOS 5.6 no longer needs dynodump because it has a similar
    # function integrated.
    case "${canonical}" in
      *-sunos4* )
        test -f /usr/lib/cpp     && NON_GNU_CPP=/usr/lib/cpp ;;
      *-solaris2* )
        test -f /usr/ccs/lib/cpp && NON_GNU_CPP=/usr/ccs/lib/cpp
        RANLIB=':'
	case "${canonical}" in
	  *-solaris2.[6-9]* ) need_dynodump=no  ;;
	  *-solaris2*       ) need_dynodump=yes ;;
	esac
    esac
    
    case "${canonical}" in
      ## The Sun386 didn't get past 4.0.
      i[3-9]86-*-sunos4*  ) opsys=sunos4-0	;;
      *-sunos4.0*	  ) opsys=sunos4-0	;;
      *-sunos4.1.2*	  ) opsys=sunos4-1-2	;;
      *-sunos4.1.[3-9]*	  ) opsys=sunos4-1-3	;;
      *-sunos4* | *-sunos ) opsys=sunos4-1	;;

      *-solaris2.3*	  ) opsys=sol2-3	;;
      *-solaris2.4*	  ) opsys=sol2-4	;;
      *-solaris2.5*	  ) opsys=sol2-5	;;
      *-solaris2.[6-9]*	  ) opsys=sol2-6	;;
      *-solaris*	  ) opsys=sol2		;;

      *-mach*		  ) opsys=mach-bsd4-3	;;
      *			  ) opsys=bsd4-2	;;
    esac

    case "${canonical}" in *-sunos4*shr* ) opsys="${opsys}-shr" ;; esac

    ## Watch out for a compiler that is guaranteed not to work.
    case "${canonical}" in
      *-solaris* ) test "$CC" = "/usr/ucb/cc" && unset CC ;;
    esac
  ;;

  sparc-*-nextstep* ) machine=sparc opsys=nextstep ;;

  ## Tadpole 68k
  m68*-tadpole-sysv* ) machine=tad68k opsys=usg5-3 ;;

  ## Tahoe machines
  tahoe-tahoe-bsd4.2* ) machine=tahoe opsys=bsd4-2 ;;
  tahoe-tahoe-bsd4.3* ) machine=tahoe opsys=bsd4-3 ;;

  ## Tandem Integrity S2
  mips-tandem-sysv* ) machine=tandem-s2 opsys=usg5-3 ;;

  ## Tektronix XD88
  m88k-tektronix-sysv3* ) machine=tekxd88 opsys=usg5-3 ;;

  ## Tektronix 16000 box (6130?)
  ns16k-tektronix-bsd* ) machine=ns16000 opsys=bsd4-2 ;;
  ## Tektronix 4300
  ## src/m/tek4300.h hints that this is a m68k machine.
  m68*-tektronix-bsd* ) machine=tek4300 opsys=bsd4-3 ;;

  ## Titan P2 or P3
  ## We seem to have lost the machine-description file titan.h!
  titan-titan-sysv* ) machine=titan opsys=usg5-3 ;;

  ## Ustation E30 (SS5E)
  m68*-unisys-uniplus* ) machine=ustation opsystem=unipl5-2 ;;

  ## Vaxen.
  vax-dec-* )
    machine=vax
    case "${canonical}" in
      *-bsd4.1* ) 					opsys=bsd4-1 ;;
      *-bsd4.2* | *-ultrix[0-3].* | *-ultrix4.0* )	opsys=bsd4-2 ;;
      *-bsd4.3* | *-ultrix* ) 				opsys=bsd4-3 ;;
      *-sysv[01]* | *-sysvr[01]* ) 			opsys=usg5-0 ;;
      *-sysv2* | *-sysvr2* )				opsys=usg5-2 ;;
      *-vms* ) 						opsys=vms ;;
      *-mach* )						opsys=mach-bsd4-3 ;;
      * ) 						unported=yes
    esac
  ;;

  ## Whitechapel MG1
  ## We don't know what sort of OS runs on these; we'll let the
  ## operating system guessing code below try.
  ns16k-whitechapel-* ) machine=mg1 ;;

  ## Wicat
  m68*-wicat-sysv* ) machine=wicat opsys=usg5-2 ;;

  ## Intel 386 machines where we don't care about the manufacturer
  i[3-9]86-*-* )
    machine=intel386
    case "${canonical}" in
      *-isc1.* | *-isc2.[01]* )	opsys=386-ix ;;
      *-isc2.2* )		opsys=isc2-2 ;;
      *-isc4.0* )		opsys=isc4-0 ;;
      *-isc4.* )		opsys=isc4-1
				GCC_TEST_OPTIONS=-posix
				NON_GCC_TEST_OPTIONS=-Xp
				;;
      *-isc* )			opsys=isc3-0 ;;
      *-esix5* )		opsys=esix5r4; NON_GNU_CPP=/usr/lib/cpp ;;
      *-esix* )			opsys=esix ;;
      *-mach* )			opsys=mach-bsd4-3 ;;
      *-xenix* )		opsys=xenix ;;
      *-linux* )		opsys=linux ;;
      *-sco3.2v4* )		opsys=sco4 ; NON_GNU_CPP=/lib/cpp  ;;
      *-bsd386* | *-bsdi1* )	opsys=bsd386 ;;
      *-bsdi2.1* )		opsys=bsdos2-1 ;;
      *-bsdi2* )		opsys=bsdos2 ;;
      *-sco3.2v5* )		opsys=sco5 ; 
	## This is a pain.  Like the current USL cc, SCO's cc -E
	## tokenizes as it preprocesses, making configure very 
	## unhappy.  Unfortunately, /lib/cpp doesn't understand
	## flags like "-b elf", so we have to cheat in order to
	## pick up the right defines for UNEXEC from the s-file.
	## 01/05/95 robertl@dgii.com
	if test "${dynamic}" = "yes" ; then
		NON_GNU_CPP="/lib/cpp -D_XOPEN_SOURCE -D_SCO_ELF"  ;
	else
		NON_GNU_CPP="/lib/cpp -D_XOPEN_SOURCE"  ;
	fi ;;
      *-386bsd* )	        opsys=386bsd ;;
      *-freebsd* )		opsys=freebsd ;;
      *-nextstep* )		opsys=nextstep ;;
      ## Otherwise, we'll fall through to the generic opsys code at the bottom.
    esac
  ;;

  ## Linux/68k
  m68k-*-linux* ) machine=m68k opsys=linux ;;

  * ) unported=yes ;;
esac

### If the code above didn't choose an operating system, just choose
### an operating system based on the configuration name.  You really
### only want to use this when you have no idea what the right
### operating system is; if you know what operating systems a machine
### runs, it's cleaner to make it explicit in the case statement
### above.
if test -z "${opsys}" ; then
  case "${canonical}" in
    *-gnu* )			opsys=gnu    ;;
    *-bsd4.[01] )		opsys=bsd4-1 ;;
    *-bsd4.2 )			opsys=bsd4-2 ;;
    *-bsd4.3 )			opsys=bsd4-3 ;;
    *-sysv0    | *-sysvr0 )	opsys=usg5-0 ;;
    *-sysv2    | *-sysvr2 )	opsys=usg5-2 ;;
    *-sysv2.2  | *-sysvr2.2 )	opsys=usg5-2-2 ;;
    *-sysv3*   | *-sysvr3* )	opsys=usg5-3 ;;
    *-sysv4.1* | *-sysvr4.1* )	opsys=usg5-4 NON_GNU_CPP=/usr/lib/cpp ;;
    *-sysv4.[2-9]* | *-sysvr4.[2-9]* )
	if test -z "$NON_GNU_CPP" ; then
	  if test -f /usr/ccs/lib/cpp
	  then NON_GNU_CPP=/usr/ccs/lib/cpp
	  else NON_GNU_CPP=/lib/cpp
	  fi
	fi
	opsys=usg5-4-2 ;;
    *-sysv4* | *-sysvr4* )	opsys=usg5-4 ;;
    * )				unported=yes ;;
  esac
fi

test -z "$RANLIB" && RANLIB=ranlib

if test ${unported} = yes; then
  (echo "${progname}: XEmacs hasn't been ported to \`${canonical}' systems."
   echo "${progname}: Check \`etc/MACHINES' for recognized configuration names."
  ) >&2
  exit 1
fi

if test "${dynamic}" = "yes" ; then
  case "${opsys}" in
    hpux* | sunos4* | sco5 ) opsys="${opsys}-shr" ;;
  esac
elif test "${dynamic}" = "no" ; then
  case "${opsys}" in
    sol2* | decosf1-3 | decosf3-* | linux ) opsys="${opsys}-static" ;;
  esac
fi

dynodump_arch=''
if test "${need_dynodump}" = "yes" ; then
  case "${canonical}" in
    sparc*    ) dynodump_arch=sparc ;;
    powerpc*  ) dynodump_arch=ppc   ;;
    i[3-9]86* ) dynodump_arch=i386  ;;
  esac
fi

machfile="m/${machine}.h"
opsysfile="s/${opsys}.h"


############################################################################
#									   #
#            Determine the compiler, set up for feature testing            #
#									   #
############################################################################





ac_ext=c
# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
ac_cpp='${CPP}'
ac_compile='${CC-cc} $CFLAGS $LDFLAGS conftest.${ac_ext} -o conftest $LIBS >/dev/null 2>&1'

trap 'rm -fr conftest* confdefs* core $ac_clean_files; exit 1' 1 2 15
trap 'rm -fr confdefs* $ac_clean_files' 0

# Save the original args if we used an alternate arg parser.
ac_configure_temp="${configure_args-$*}"
# Strip out --no-create and --norecursion so they don't pile up.
configure_args=
for ac_arg in $ac_configure_temp; do
  case "$ac_arg" in
  -no-create | --no-create | --no-creat | --no-crea | --no-cre \
  | --no-cr | --no-c) ;;
  -norecursion | --norecursion | --norecursio | --norecursi \
  | --norecurs | --norecur | --norecu | --norec | --nore | --nor) ;;
  *) configure_args="$configure_args $ac_arg" ;;
  esac
done

# NLS nuisances.
# These must not be set unconditionally because not all systems understand
# e.g. LANG=C (notably SCO).
if test "${LC_ALL+set}" = 'set'; then LC_ALL=C; export LC_ALL; fi
if test "${LANG+set}"   = 'set'; then LANG=C;   export LANG;   fi

# confdefs.h avoids OS command line length limits that DEFS can exceed.
rm -rf conftest* confdefs.h
# AIX cpp loses on an empty file, so make sure it contains at least a newline.
echo > confdefs.h

# A filename unique to this package, relative to the directory that
# configure is in, which we can look for to find out if srcdir is correct.
ac_unique_file=lisp

# Find the source files, if location was not specified.
if test -z "$srcdir"; then
  ac_srcdir_defaulted=yes
  # Try the directory containing this script, then `..'.
  ac_prog=$0
  ac_confdir=`echo $ac_prog|sed 's%/[^/][^/]*$%%'`
  test "x$ac_confdir" = "x$ac_prog" && ac_confdir=.
  srcdir=$ac_confdir
  if test ! -r $srcdir/$ac_unique_file; then
    srcdir=..
  fi
fi
if test ! -r $srcdir/$ac_unique_file; then
  if test x$ac_srcdir_defaulted = xyes; then
    echo "configure: can not find sources in ${ac_confdir} or .." >&2; exit 1
  else
    echo "configure: can not find sources in ${srcdir}" >&2; exit 1
  fi
fi
ac_ext=c
# CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
ac_cpp='${CPP}'
ac_compile='${CC-cc} $CFLAGS $LDFLAGS conftest.${ac_ext} -o conftest $LIBS >/dev/null 2>&1'




if test "${extra_verbose}" = "yes"  ; then
#   This is identical to the version that A\C_LANG_C generates except that
#   it omits the redirection of all output to /dev/null.
  ac_compile='${CC-cc} $CFLAGS $LDFLAGS conftest.${ac_ext} -o conftest $LIBS'
fi

#### Choose a compiler.
if test "x$CC" = x  ; then
  cc_specified=1
fi

# Save the value of CFLAGS that the user specified.
SPECIFIED_CFLAGS="$CFLAGS"

if test "${with_gcc}" = "yes"  ; then
  CC="${compiler-gcc}"
  GCC=1
elif test "${with_lcc}" = "yes"  ; then
  CC="${compiler-lcc}"
  dash_r_space=' '		# this bullshit is here because lcc for solaris
				# will not accept -Rargument.
				# It needs -R argument instead.  Yuck yuck yuck.
  test -z "$NON_GNU_CPP" && NON_GNU_CPP="yes" # this is handled specially below...
elif test "${compiler}" != ""   ; then CC="${compiler}"
elif test "${with_gcc}" = "no"  ; then CC="cc"
elif test "${with_lcc}" = "no"  ; then
  test -z "$CC" && CC=cc
else
  case "${canonical}" in
    * )
      if test -z "$CC"; then
  # Extract the first word of `gcc', so it can be a program name with args.
  set ac_dummy gcc; ac_word=$2
  test -n "$silent" || echo "checking for $ac_word"
  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}:"
  for ac_dir in $PATH; do
    test -z "$ac_dir" && ac_dir=.
    if test -f $ac_dir/$ac_word; then
      CC="gcc"
      break
    fi
  done
  IFS="$ac_save_ifs"
fi
test -z "$CC" && CC="cc"
test -n "$CC" && test -n "$verbose" && echo "	setting CC to $CC"

# Find out if we are using GNU C, under whatever name.
cat > conftest.c <<EOF
#ifdef __GNUC__
  yes
#endif
EOF
${CC-cc} -E conftest.c > conftest.out 2>&1
if egrep yes conftest.out >/dev/null 2>&1; then
  GCC=1 # For later tests.
fi
rm -f conftest*

      if test "${CC}" = "gcc"  ; then
        with_gcc="yes"
        GCC=1
      fi
    ;;
  esac
fi



#### Some systems specify a CPP to use unless we are using GCC.
#### Now that we know whether we are using GCC, we can decide whether
#### to use that one.
if test "x$NON_GNU_CPP" = x -o x$GCC = x1
then true
else
  if test "x$CPP" = x ; then
    if test "${with_lcc}" = "yes" -a "${NON_GNU_CPP}" = "yes"; then
      CPP='gcc -E -traditional' # cross fingers and hope it's there....
    else
      CPP="$NON_GNU_CPP"
    fi
  fi
fi

#### Some systems specify a CC to use unless we are using GCC.
#### Now that we know whether we are using GCC, we can decide whether
#### to use that one.
if test "x$NON_GNU_CC" = x -o x$GCC = x1 -o x$cc_specified = x1
then true
else
  CC="$NON_GNU_CC"
fi

## Huh?  I commented out the following because it always enabled
## the "test" options, whatever the hell those are supposed to be
## for, and the result is that SunOS builds were always static.

# test x$GCC = x1 -a "x$GCC_TEST_OPTIONS"     != x && CC="$CC $GCC_TEST_OPTIONS"
# test x$GCC = x  -a "x$NON_GCC_TEST_OPTIONS" != x && CC="$CC $NON_GCC_TEST_OPTIONS"

############################################################################
#									   #
#                    Do some misc autoconf-special tests                   #
#									   #
############################################################################

#### Some other nice autoconf tests.  If you add a test here which
#### should make an entry in src/config.h, don't forget to add an
#### #undef clause to src/config.h.in for autoconf to modify.

test -n "$silent" || echo "checking how to run the C preprocessor"
if test -z "$CPP"; then
  # This must be in double quotes, not single quotes, because CPP may get
  # substituted into the Makefile and ``${CC-cc}'' will simply confuse
  # make.  It must be expanded now.
  CPP="${CC-cc} -E"
  cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <stdio.h>
Syntax Error
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  :
else
  rm -rf conftest*
  CPP="${CC-cc} -E -traditional-cpp"
  cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <stdio.h>
Syntax Error
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  :
else
  rm -rf conftest*
  CPP=/lib/cpp
fi
rm -f conftest*
fi
rm -f conftest*
fi
test -n "$verbose" && echo "	setting CPP to $CPP"


case "${canonical}" in
  *-sun-sunos* )
    if test "${CPP}" = "acc -E"  ; then
      CPP="acc -E -Xs"
    fi
  ;;
esac

if test -z "$RANLIB"; then
  # Extract the first word of `ranlib', so it can be a program name with args.
  set ac_dummy ranlib; ac_word=$2
  test -n "$silent" || echo "checking for $ac_word"
  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}:"
  for ac_dir in $PATH; do
    test -z "$ac_dir" && ac_dir=.
    if test -f $ac_dir/$ac_word; then
      RANLIB="ranlib"
      break
    fi
  done
  IFS="$ac_save_ifs"
fi
test -z "$RANLIB" && RANLIB=":"
test -n "$RANLIB" && test -n "$verbose" && echo "	setting RANLIB to $RANLIB"

# Make sure to not get the incompatible SysV /etc/install and
# /usr/sbin/install, which might be in PATH before a BSD-like install,
# or the SunOS /usr/etc/install directory, or the AIX /bin/install,
# or the AFS install, which mishandles nonexistent args, or
# /usr/ucb/install on SVR4, which tries to use the nonexistent group
# `staff', or /sbin/install on IRIX which has incompatible command-line
# syntax.  Sigh.
#
#     On most BSDish systems install is in /usr/bin, not /usr/ucb
#     anyway.
# This turns out not to be true, so the mere pathname isn't an indication
# of whether the program works.  What we really need is a set of tests for
# the install program to see if it actually works in all the required ways.
#
# Avoid using ./install, which might have been erroneously created
# by make from ./install.sh.
if test -z "${INSTALL}"; then
  test -n "$silent" || echo "checking for a BSD compatible install"
  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}:"
  for ac_dir in $PATH; do
    case "$ac_dir" in
    ''|.|/etc|/sbin|/usr/sbin|/usr/etc|/usr/afsws/bin|/usr/ucb) ;;
    *)
      # OSF1 and SCO ODT 3.0 have their own names for install.
      for ac_prog in installbsd scoinst install; do
        if test -f $ac_dir/$ac_prog; then
	  if test $ac_prog = install &&
            grep dspmsg $ac_dir/$ac_prog >/dev/null 2>&1; then
	    # AIX install.  It has an incompatible calling convention.
	    # OSF/1 installbsd also uses dspmsg, but is usable.
	    :
	  else
	    INSTALL="$ac_dir/$ac_prog -c"
	    break 2
	  fi
	fi
      done
      ;;
    esac
  done
  IFS="$ac_save_ifs"
fi

if test -z "$INSTALL"; then
  # As a last resort, use the slow shell script.
  for ac_dir in ${srcdir} ${srcdir}/.. ${srcdir}/../..; do
    if test -f $ac_dir/install.sh; then
      INSTALL="$ac_dir/install.sh -c"; break
    fi
  done
fi
if test -z "$INSTALL"; then
  echo "configure: can not find install.sh in ${srcdir} or ${srcdir}/.. or ${srcdir}/../.." >&2; exit 1
fi
test -n "$verbose" && echo "	setting INSTALL to $INSTALL"

# Use test -z because SunOS4 sh mishandles ${INSTALL_PROGRAM-'${INSTALL}'}.
# It thinks the first close brace ends the variable substitution.
test -z "$INSTALL_PROGRAM" && INSTALL_PROGRAM='${INSTALL}'
test -n "$verbose" && echo "	setting INSTALL_PROGRAM to $INSTALL_PROGRAM"

test -z "$INSTALL_DATA" && INSTALL_DATA='${INSTALL} -m 644'
test -n "$verbose" && echo "	setting INSTALL_DATA to $INSTALL_DATA"

for ac_prog in 'bison -y' byacc
do
if test -z "$YACC"; then
  # Extract the first word of `$ac_prog', so it can be a program name with args.
  set ac_dummy $ac_prog; ac_word=$2
  test -n "$silent" || echo "checking for $ac_word"
  IFS="${IFS= 	}"; ac_save_ifs="$IFS"; IFS="${IFS}:"
  for ac_dir in $PATH; do
    test -z "$ac_dir" && ac_dir=.
    if test -f $ac_dir/$ac_word; then
      YACC="$ac_prog"
      break
    fi
  done
  IFS="$ac_save_ifs"
fi

test -n "$YACC" && test -n "$verbose" && echo "	setting YACC to $YACC"

test -n "$YACC" && break
done
test -n "$YACC" || YACC="yacc"


test -n "$silent" || echo "checking for AIX"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#ifdef _AIX
  yes
#endif

EOF
eval "$ac_cpp conftest.${ac_ext} > conftest.out 2>&1"
if egrep "yes" conftest.out >/dev/null 2>&1; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining _ALL_SOURCE"
echo "#define" _ALL_SOURCE "1" >> confdefs.h
DEFS="$DEFS -D_ALL_SOURCE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}_ALL_SOURCE\${ac_dB}_ALL_SOURCE\${ac_dC}1\${ac_dD}
\${ac_uA}_ALL_SOURCE\${ac_uB}_ALL_SOURCE\${ac_uC}1\${ac_uD}
\${ac_eA}_ALL_SOURCE\${ac_eB}_ALL_SOURCE\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*



for ac_hdr in mach/mach.h sys/stropts.h sys/timeb.h sys/time.h unistd.h utime.h sys/wait.h libintl.h locale.h libgen.h linux/version.h kstat.h sys/pstat.h
do
ac_tr_hdr=HAVE_`echo $ac_hdr | tr '[a-z]./' '[A-Z]__'`
test -n "$silent" || echo "checking for ${ac_hdr}"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <${ac_hdr}>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining ${ac_tr_hdr}"
echo "#define" ${ac_tr_hdr} "1" >> confdefs.h
DEFS="$DEFS -D${ac_tr_hdr}=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}${ac_tr_hdr}\${ac_dB}${ac_tr_hdr}\${ac_dC}1\${ac_dD}
\${ac_uA}${ac_tr_hdr}\${ac_uB}${ac_tr_hdr}\${ac_uC}1\${ac_uD}
\${ac_eA}${ac_tr_hdr}\${ac_eB}${ac_tr_hdr}\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*
done

test -n "$silent" || echo "checking for ANSI C header files"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <stdlib.h>
#include <stdarg.h>
#include <string.h>
#include <float.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
echo '#include "confdefs.h"
#include <string.h>' > conftest.${ac_ext}
eval "$ac_cpp conftest.${ac_ext} > conftest.out 2>&1"
if egrep "memchr" conftest.out >/dev/null 2>&1; then
  rm -rf conftest*
  # SGI's /bin/cc from Irix-4.0.5 gets non-ANSI ctype macros unless using -ansi.
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
#define ISLOWER(c) ('a' <= (c) && (c) <= 'z')
#define TOUPPER(c) (ISLOWER(c) ? 'A' + ((c) - 'a') : (c))
#define XOR(e,f) (((e) && !(f)) || (!(e) && (f)))
int main () { int i; for (i = 0; i < 256; i++)
if (XOR (islower (i), ISLOWER (i)) || toupper (i) != TOUPPER (i)) exit(2);
exit (0); }

EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
echo '#include "confdefs.h"
#include <stdlib.h>' > conftest.${ac_ext}
eval "$ac_cpp conftest.${ac_ext} > conftest.out 2>&1"
if egrep "free" conftest.out >/dev/null 2>&1; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining STDC_HEADERS"
echo "#define" STDC_HEADERS "1" >> confdefs.h
DEFS="$DEFS -DSTDC_HEADERS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}STDC_HEADERS\${ac_dB}STDC_HEADERS\${ac_dC}1\${ac_dD}
\${ac_uA}STDC_HEADERS\${ac_uB}STDC_HEADERS\${ac_uC}1\${ac_uD}
\${ac_eA}STDC_HEADERS\${ac_eB}STDC_HEADERS\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*


fi
rm -fr conftest*

fi
rm -f conftest*


fi
rm -f conftest*

test -n "$silent" || echo "checking for whether time.h and sys/time.h may both be included"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <sys/types.h>
#include <sys/time.h>
#include <time.h>
int main() { return 0; }
int t() { struct tm *tp;; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining TIME_WITH_SYS_TIME"
echo "#define" TIME_WITH_SYS_TIME "1" >> confdefs.h
DEFS="$DEFS -DTIME_WITH_SYS_TIME=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}TIME_WITH_SYS_TIME\${ac_dB}TIME_WITH_SYS_TIME\${ac_dC}1\${ac_dD}
\${ac_uA}TIME_WITH_SYS_TIME\${ac_uB}TIME_WITH_SYS_TIME\${ac_uC}1\${ac_uD}
\${ac_eA}TIME_WITH_SYS_TIME\${ac_eB}TIME_WITH_SYS_TIME\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*

test -n "$silent" || echo "checking for sys_siglist declaration in signal.h or unistd.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <signal.h>
/* NetBSD declares sys_siglist in <unistd.h>.  */
#ifdef HAVE_UNISTD_H
#include <unistd.h>
#endif
int main() { return 0; }
int t() { char *msg = *(sys_siglist + 1);; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining SYS_SIGLIST_DECLARED"
echo "#define" SYS_SIGLIST_DECLARED "1" >> confdefs.h
DEFS="$DEFS -DSYS_SIGLIST_DECLARED=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}SYS_SIGLIST_DECLARED\${ac_dB}SYS_SIGLIST_DECLARED\${ac_dC}1\${ac_dD}
\${ac_uA}SYS_SIGLIST_DECLARED\${ac_uB}SYS_SIGLIST_DECLARED\${ac_uC}1\${ac_uD}
\${ac_eA}SYS_SIGLIST_DECLARED\${ac_eB}SYS_SIGLIST_DECLARED\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*


test -n "$silent" || echo "checking for struct utimbuf"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#ifdef TIME_WITH_SYS_TIME
#include <sys/time.h>
#include <time.h>
#else
#ifdef HAVE_SYS_TIME_H
#include <sys/time.h>
#else
#include <time.h>
#endif
#endif
#ifdef HAVE_UTIME_H
#include <utime.h>
#endif
int main() { return 0; }
int t() { static struct utimbuf x; x.actime = x.modtime;; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_STRUCT_UTIMBUF"
echo "#define" HAVE_STRUCT_UTIMBUF "1" >> confdefs.h
DEFS="$DEFS -DHAVE_STRUCT_UTIMBUF=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_STRUCT_UTIMBUF\${ac_dB}HAVE_STRUCT_UTIMBUF\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_STRUCT_UTIMBUF\${ac_uB}HAVE_STRUCT_UTIMBUF\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_STRUCT_UTIMBUF\${ac_eB}HAVE_STRUCT_UTIMBUF\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*


test -n "$silent" || echo "checking for return type of signal handlers"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <sys/types.h>
#include <signal.h>
#ifdef signal
#undef signal
#endif
extern void (*signal ()) ();
int main() { return 0; }
int t() { int i;; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining" RETSIGTYPE to be "void"
echo "#define" RETSIGTYPE "void" >> confdefs.h
DEFS="$DEFS -DRETSIGTYPE=void"
ac_sed_defs="${ac_sed_defs}\${ac_dA}RETSIGTYPE\${ac_dB}RETSIGTYPE\${ac_dC}void\${ac_dD}
\${ac_uA}RETSIGTYPE\${ac_uB}RETSIGTYPE\${ac_uC}void\${ac_uD}
\${ac_eA}RETSIGTYPE\${ac_eB}RETSIGTYPE\${ac_eC}void\${ac_eD}
"
}


else
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining" RETSIGTYPE to be "int"
echo "#define" RETSIGTYPE "int" >> confdefs.h
DEFS="$DEFS -DRETSIGTYPE=int"
ac_sed_defs="${ac_sed_defs}\${ac_dA}RETSIGTYPE\${ac_dB}RETSIGTYPE\${ac_dC}int\${ac_dD}
\${ac_uA}RETSIGTYPE\${ac_uB}RETSIGTYPE\${ac_uC}int\${ac_uD}
\${ac_eA}RETSIGTYPE\${ac_eB}RETSIGTYPE\${ac_eC}int\${ac_eD}
"
}

fi
rm -f conftest*



test -n "$silent" || echo "checking for struct timeval"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#ifdef TIME_WITH_SYS_TIME
#include <sys/time.h>
#include <time.h>
#else
#ifdef HAVE_SYS_TIME_H
#include <sys/time.h>
#else
#include <time.h>
#endif
#endif
int main() { return 0; }
int t() { static struct timeval x; x.tv_sec = x.tv_usec;; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
  HAVE_TIMEVAL=yes
  
{
test -n "$verbose" && \
echo "	defining HAVE_TIMEVAL"
echo "#define" HAVE_TIMEVAL "1" >> confdefs.h
DEFS="$DEFS -DHAVE_TIMEVAL=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_TIMEVAL\${ac_dB}HAVE_TIMEVAL\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_TIMEVAL\${ac_uB}HAVE_TIMEVAL\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_TIMEVAL\${ac_eB}HAVE_TIMEVAL\${ac_eC}1\${ac_eD}
"
}


else
  rm -rf conftest*
  HAVE_TIMEVAL=no
fi
rm -f conftest*


test -n "$silent" || echo "checking for struct tm in time.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <sys/types.h>
#include <time.h>
int main() { return 0; }
int t() { struct tm *tp; tp->tm_sec;; return 0; }
EOF
if eval $ac_compile; then
  :
else
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining TM_IN_SYS_TIME"
echo "#define" TM_IN_SYS_TIME "1" >> confdefs.h
DEFS="$DEFS -DTM_IN_SYS_TIME=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}TM_IN_SYS_TIME\${ac_dB}TM_IN_SYS_TIME\${ac_dC}1\${ac_dD}
\${ac_uA}TM_IN_SYS_TIME\${ac_uB}TM_IN_SYS_TIME\${ac_uC}1\${ac_uD}
\${ac_eA}TM_IN_SYS_TIME\${ac_eB}TM_IN_SYS_TIME\${ac_eC}1\${ac_eD}
"
}

fi
rm -f conftest*

ac_decl='#include <sys/types.h>
'
case "$DEFS" in
  *TM_IN_SYS_TIME*) ac_decl="$ac_decl
#include <sys/time.h>
" ;;
  *) ac_decl="$ac_decl
#include <time.h>
" ;;
esac
test -n "$silent" || echo "checking for tm_zone in struct tm"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
$ac_decl
int main() { return 0; }
int t() { struct tm tm; tm.tm_zone;; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_TM_ZONE"
echo "#define" HAVE_TM_ZONE "1" >> confdefs.h
DEFS="$DEFS -DHAVE_TM_ZONE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_TM_ZONE\${ac_dB}HAVE_TM_ZONE\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_TM_ZONE\${ac_uB}HAVE_TM_ZONE\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_TM_ZONE\${ac_eB}HAVE_TM_ZONE\${ac_eC}1\${ac_eD}
"
}


else
  rm -rf conftest*
  ac_no_tm_zone=1
fi
rm -f conftest*

if test -n "$ac_no_tm_zone"; then
test -n "$silent" || echo "checking for tzname"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <time.h>
#ifndef tzname /* For SGI.  */
extern char *tzname[]; /* RS6000 and others want it this way.  */
#endif
int main() { return 0; }
int t() { atoi(*tzname);; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_TZNAME"
echo "#define" HAVE_TZNAME "1" >> confdefs.h
DEFS="$DEFS -DHAVE_TZNAME=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_TZNAME\${ac_dB}HAVE_TZNAME\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_TZNAME\${ac_uB}HAVE_TZNAME\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_TZNAME\${ac_eB}HAVE_TZNAME\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*

fi


ac_prog='/* Ultrix mips cc rejects this.  */
typedef int charset[2]; const charset x;
/* SunOS 4.1.1 cc rejects this.  */
char const *const *ccp;
char **p;
/* AIX XL C 1.02.0.0 rejects this.
   It does not let you subtract one const X* pointer from another in an arm
   of an if-expression whose if-part is not a constant expression */
const char *g = "string";
ccp = &g + (g ? g-g : 0);
/* HPUX 7.0 cc rejects these. */
++ccp;
p = (char**) ccp;
ccp = (char const *const *) p;
{ /* SCO 3.2v4 cc rejects this.  */
  char *t;
  char const *s = 0 ? (char *) 0 : (char const *) 0;

  *t++ = 0;
}
{ /* Someone thinks the Sun supposedly-ANSI compiler will reject this.  */
  int x[] = {25,17};
  const int *foo = &x[0];
  ++foo;
}
{ /* Sun SC1.0 ANSI compiler rejects this -- but not the above. */
  typedef const int *iptr;
  iptr p = 0;
  ++p;
}
{ /* AIX XL C 1.02.0.0 rejects this saying
     "k.c", line 2.27: 1506-025 (S) Operand must be a modifiable lvalue. */
  struct s { int j; const int *ap[3]; };
  struct s *b; b->j = 5;
}
{ /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
  const int foo = 10;
}'
test -n "$silent" || echo "checking for lack of working const"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { $ac_prog; return 0; }
EOF
if eval $ac_compile; then
  :
else
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining" const to be empty
echo "#define" const "" >> confdefs.h
DEFS="$DEFS -Dconst="
ac_sed_defs="${ac_sed_defs}\${ac_dA}const\${ac_dB}const\${ac_dC}\${ac_dD}
\${ac_uA}const\${ac_uB}const\${ac_uC}\${ac_uD}
\${ac_eA}const\${ac_eB}const\${ac_eC}\${ac_eD}
"
}

fi
rm -f conftest*


cat > conftestmake <<'EOF'
all:
	@echo 'ac_maketemp="${MAKE}"'
EOF
# GNU make sometimes prints "make[1]: Entering...", which would confuse us.
eval `${MAKE-make} -f conftestmake 2>/dev/null | grep temp=`
if test -n "$ac_maketemp"; then SET_MAKE=
else SET_MAKE="MAKE=${MAKE-make}"; fi
rm -f conftestmake


test -n "$silent" || echo "checking byte ordering"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
main () {
  /* Are we little or big endian?  From Harbison&Steele.  */
  union
  {
    long l;
    char c[sizeof (long)];
  } u;
  u.l = 1;
  exit (u.c[sizeof (long) - 1] == 1);
}
EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  :
else
  
{
test -n "$verbose" && \
echo "	defining WORDS_BIGENDIAN"
echo "#define" WORDS_BIGENDIAN "1" >> confdefs.h
DEFS="$DEFS -DWORDS_BIGENDIAN=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}WORDS_BIGENDIAN\${ac_dB}WORDS_BIGENDIAN\${ac_dC}1\${ac_dD}
\${ac_uA}WORDS_BIGENDIAN\${ac_uB}WORDS_BIGENDIAN\${ac_uC}1\${ac_uD}
\${ac_eA}WORDS_BIGENDIAN\${ac_eB}WORDS_BIGENDIAN\${ac_eC}1\${ac_eD}
"
}

fi
rm -fr conftest*


test -n "$silent" || echo "checking for long file names"
ac_some_dir_failed=false
# Test for long file names in all the places we know might matter:
#      .		the current directory, where building will happen
#      /tmp		where it might want to write temporary files
#      /var/tmp		likewise
#      /usr/tmp		likewise
#      $prefix/lib	where we will be installing things
#      $exec_prefix/lib	likewise
# eval it to expand exec_prefix.
for ac_dir in `eval echo . /tmp /var/tmp /usr/tmp $prefix/lib $exec_prefix/lib` ; do
  test -d $ac_dir || continue
  test -w $ac_dir || continue # It's less confusing to not echo anything here.
  (echo 1 > $ac_dir/conftest9012345) 2>/dev/null
  (echo 2 > $ac_dir/conftest9012346) 2>/dev/null
  val=`cat $ac_dir/conftest9012345 2>/dev/null`
  test -f $ac_dir/conftest9012345 && test "$val" = 1 || ac_some_dir_failed=true
  rm -f $ac_dir/conftest9012345 $ac_dir/conftest9012346 2> /dev/null
done
$ac_some_dir_failed || 
{
test -n "$verbose" && \
echo "	defining HAVE_LONG_FILE_NAMES"
echo "#define" HAVE_LONG_FILE_NAMES "1" >> confdefs.h
DEFS="$DEFS -DHAVE_LONG_FILE_NAMES=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_LONG_FILE_NAMES\${ac_dB}HAVE_LONG_FILE_NAMES\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_LONG_FILE_NAMES\${ac_uB}HAVE_LONG_FILE_NAMES\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_LONG_FILE_NAMES\${ac_eB}HAVE_LONG_FILE_NAMES\${ac_eC}1\${ac_eD}
"
}



echo "checking for -xildoff compiler flag"
if   ${CC-cc} '-###' -xildon  no_such_file.c 2>&1 | grep '^[^ ]*/ild ' > /dev/null ; then
  if ${CC-cc} '-###' -xildoff no_such_file.c 2>&1 | grep '^[^ ]*/ild ' > /dev/null ; then
    :
  else
    test -n "$verbose" && echo "	defining NEED_XILDOFF"
    need_xildoff=yes 
  fi
fi


# What the hell was this doing here??????
### echo > confdefs.h		# this gets nuked above...

############################################################################
#									   #
#                         Choose a window system                           #
#									   #
############################################################################

#### Choose a window system.
echo "checking for specified window system"

window_system=''
case "${with_x11}" in 
  yes ) window_system=${window_system}x11  ;;
  no  ) window_system=${window_system}none ;;
esac

case "${window_system}" in
  "none" | "x11" ) ;;
  "" )
    # --x-includes or --x-libraries implies --with-x11.
    if test -n "${x_includes}" -o -n "${x_libraries}"; then
      window_system=x11
    else
      echo "  No window system specified.  Looking for X11."
      # If the user didn't specify a window system and we found X11, use it.
      if test -r /usr/lib/libX11.a \
         -o -d /usr/include/X11 \
         -o -d /usr/X386/include \
         -o -d /usr/X11R6/include \
	 -o -d ${x_includes}/X11 ; then
        window_system=x11
      fi
    fi
  ;;
  * )
    echo "Don't specify a window system more than once." >&2
    exit 1
  ;;
esac


case "${window_system}" in "" | "x11" )
    ### If the user hasn't specified where we should find X, try
    ### letting autoconf figure that out.
    if test -z "${x_includes}${x_libraries}" ; then 
     # If we find X, set shell vars x_includes and x_libraries to the paths.
no_x=true
if test "x$with_x" != xno; then
test -n "$silent" || echo "checking for X include and library files with xmkmf"
rm -fr conftestdir
if mkdir conftestdir; then
  cd conftestdir
  # Make sure to not put "make" in the Imakefile rules, since we grep it out.
  cat > Imakefile <<'EOF'
acfindx:
	@echo 'ac_im_incroot="${INCROOT}"; ac_im_usrlibdir="${USRLIBDIR}"; ac_im_libdir="${LIBDIR}"'
EOF
  if (xmkmf) >/dev/null 2>/dev/null && test -f Makefile; then
    no_x=
    # GNU make sometimes prints "make[1]: Entering...", which would confuse us.
    eval `make acfindx 2>/dev/null | grep -v make`
    # Open Windows xmkmf reportedly sets LIBDIR instead of USRLIBDIR.
    if test ! -f $ac_im_usrlibdir/libX11.a && test -f $ac_im_libdir/libX11.a
    then
      ac_im_usrlibdir=$ac_im_libdir
    fi
    case "$ac_im_incroot" in
	/usr/include) ;;
	*) test -z "$x_includes" && x_includes="$ac_im_incroot" ;;
    esac
    case "$ac_im_usrlibdir" in
	/usr/lib | /lib) ;;
	*) test -z "$x_libraries" && x_libraries="$ac_im_usrlibdir" ;;
    esac
  fi
  cd ..
  rm -fr conftestdir
fi

if test -z "$ac_im_usrlibdir"; then
test -n "$silent" || echo "checking for X include and library files directly"
if test ".$x_direct_test_library" = . ; then
   x_direct_test_library='Xt'
fi
if test ".$x_direct_test_include" = . ; then
   x_direct_test_include='X11/Intrinsic.h'
fi
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <$x_direct_test_include>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  no_x=

else
  rm -rf conftest*
  for ac_dir in               \
    /usr/X11R6/include        \
    /usr/X11R5/include        \
    /usr/X11R4/include        \
                              \
    /usr/include/X11R6        \
    /usr/include/X11R5        \
    /usr/include/X11R4        \
                              \
    /usr/local/X11R6/include  \
    /usr/local/X11R5/include  \
    /usr/local/X11R4/include  \
                              \
    /usr/local/include/X11R6  \
    /usr/local/include/X11R5  \
    /usr/local/include/X11R4  \
                              \
    /usr/X11/include          \
    /usr/include/X11          \
    /usr/local/X11/include    \
    /usr/local/include/X11    \
                              \
    /usr/X386/include         \
    /usr/x386/include         \
    /usr/XFree86/include/X11  \
                              \
    /usr/include              \
    /usr/local/include        \
    /usr/unsupported/include  \
    /usr/athena/include       \
    /usr/local/x11r5/include  \
    /usr/lpp/Xamples/include  \
                              \
    /usr/openwin/include      \
    /usr/openwin/share/include \
    ; \
  do
    if test -r "$ac_dir/$x_direct_test_include"; then
      test -z "$x_includes" && x_includes=$ac_dir
      no_x=
      break
    fi
  done
fi
rm -f conftest*

# Check for the libraries.  First see if replacing the `include' by
# `lib' works.
ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -l"$x_direct_test_library""
ac_have_lib=""
test -n "$silent" || echo "checking for -l"$x_direct_test_library""
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; no_x=
else
   :; for ac_dir in `echo "$x_includes" | sed s/include/lib/` \
    /usr/X11R6/lib        \
    /usr/X11R5/lib        \
    /usr/X11R4/lib        \
                          \
    /usr/lib/X11R6        \
    /usr/lib/X11R5        \
    /usr/lib/X11R4        \
                          \
    /usr/local/X11R6/lib  \
    /usr/local/X11R5/lib  \
    /usr/local/X11R4/lib  \
                          \
    /usr/local/lib/X11R6  \
    /usr/local/lib/X11R5  \
    /usr/local/lib/X11R4  \
                          \
    /usr/X11/lib          \
    /usr/lib/X11          \
    /usr/local/X11/lib    \
    /usr/local/lib/X11    \
                          \
    /usr/X386/lib         \
    /usr/x386/lib         \
    /usr/XFree86/lib/X11  \
                          \
    /usr/lib              \
    /usr/local/lib        \
    /usr/unsupported/lib  \
    /usr/athena/lib       \
    /usr/local/x11r5/lib  \
    /usr/lpp/Xamples/lib  \
                          \
    /usr/openwin/lib      \
    /usr/openwin/share/lib \
    ; \
do
  for ac_extension in a so sl; do
    if test -r $ac_dir/lib${x_direct_test_library}.$ac_extension; then
      test -z "$x_libraries" && x_libraries=$ac_dir
      no_x=
      break 2
    fi
  done
done
fi

fi
test -n "$x_includes" && test -n "$verbose" && echo "	X11 headers are in $x_includes"
test -n "$x_libraries" && test -n "$verbose" && echo "	X11 libraries are in $x_libraries"
fi

    fi
    if test -n "${x_includes}${x_libraries}" ; then window_system=x11 ; fi
  ;;
esac

test -z "${window_system}" && window_system="none"

if test "${window_system}" = "none" ; then
  if test "${with_tty}" != "yes" ; then
    echo "No window system support, and no TTY support." >&2
    echo "Unable to proceed." >&2
    exit 1
  fi
  for feature in epoch cde offix menubars scrollbars toolbars dialogs xim tiff
  do
    if eval "test -n \"\$with_$feature\" -a \"\$with_$feature\" != no" ; then
       echo "configure: warning: --with-$feature ignored:  Not valid without X support" >&2
    fi
    eval "with_$feature=no"
  done
elif test -z "${with_toolbars}"  ; then
  with_toolbars='yes'
fi

case "${canonical}" in
  *-sun-solaris* | *-sun-sunos5* ) add_runtime_flag=yes ;;
esac

if test -n "${x_libraries}" ; then
  if test "${add_runtime_flag}" ; then
    LD_SWITCH_X_SITE="-L${x_libraries} -R${dash_r_space}${x_libraries}"
  else
    LD_SWITCH_X_SITE="-L${x_libraries}"
  fi
fi
# LD_SWITCH_X_SITE_AUX (from FSF) is ill-conceived.  See s/sol2*.h.
# test -n "${x_libraries}" -a LD_SWITCH_X_SITE_AUX="-R${x_libraries}"
test -n "${x_includes}" && C_SWITCH_X_SITE="-I${x_includes}"

if test -n "${site_libraries}" ; then
  for arg in ${site_libraries}
  do
    LD_SWITCH_SITE="${LD_SWITCH_SITE} -L${arg}"
  done
fi
if test -n "${site_runtime_libraries}" ; then
  for arg in ${site_runtime_libraries}
  do
    LD_SWITCH_SITE="${LD_SWITCH_SITE} -L${arg}"
    LD_SWITCH_SITE="${LD_SWITCH_SITE} -R${dash_r_space}${arg}"
  done
fi
if test -n "${site_includes}" ; then
  for arg in ${site_includes}
  do
    C_SWITCH_SITE="${C_SWITCH_SITE} -I${arg}"
    CPP="${CPP} -I${arg}"
  done
fi

# FSF 19.29 has some bitmapdir stuff here.
bitmapdir=

# Avoid forcing the search of /usr/include before fixed include files.
test "$C_SWITCH_X_SITE" = "-I/usr/include" && C_SWITCH_X_SITE=" "

# Need for check for audio/Xtutil.h.
CPP="${CPP} ${C_SWITCH_X_SITE}"

case "${window_system}" in
  x11  ) HAVE_X_WINDOWS=yes; echo "  Using X11." ;;
  none ) HAVE_X_WINDOWS=no ; echo "  Using no window system." ;;
esac

if test "${opsys}" = "hpux9"; then
  case "${x_libraries}" in
    *X11R4* ) opsysfile="s/hpux9-x11r4.h" ;;
  esac
fi

if test "${opsys}" = "hpux9-shr"; then
  case "${x_libraries}" in
    *X11R4* ) opsysfile="s/hpux9shxr4.h" ;;
  esac
fi

############################################################################
#									   #
#   Extract some information from the operating system and machine files   #
#									   #
############################################################################

echo "examining the machine- and system-dependent files to find out"
echo " - which libraries the lib-src programs will want, and"
echo " - whether the GNU malloc routines are usable."

### First figure out CFLAGS (which we use for running the compiler here)
### and REAL_CFLAGS (which we use for real compilation).
### The two are the same except on a few systems, where they are made
### different to work around various lossages.  For example,
### GCC 2.5 on Linux needs them to be different because it treats -g
### as implying static linking.

### If the CFLAGS env var is specified, we use that value
### instead of the default.

### It's not important that this name contain the PID; you can't run
### two configures in the same directory and have anything work
### anyway.
tempcname="conftest.c"

echo '
#define NOT_C_CODE
#include "'${srcdir}'/src/'${opsysfile}'"
#include "'${srcdir}'/src/'${machfile}'"
#ifndef LIBS_MACHINE
#define LIBS_MACHINE
#endif
#ifndef LIBS_SYSTEM
#define LIBS_SYSTEM
#endif
#ifndef C_SWITCH_SYSTEM
#define C_SWITCH_SYSTEM
#endif
#ifndef C_SWITCH_X_SYSTEM
#define C_SWITCH_X_SYSTEM
#endif
#ifndef C_SWITCH_MACHINE
#define C_SWITCH_MACHINE
#endif
#ifndef LD_SWITCH_X_SYSTEM
#define LD_SWITCH_X_SYSTEM
#endif
#ifndef LIB_STANDARD
#define LIB_STANDARD
#endif
configure___ libsrc_libs=LIBS_MACHINE LIBS_SYSTEM LIB_STANDARD
configure___ c_switch_system=C_SWITCH_SYSTEM
configure___ c_switch_x_system=C_SWITCH_X_SYSTEM
configure___ ld_switch_x_system=LD_SWITCH_X_SYSTEM
configure___ c_switch_machine=C_SWITCH_MACHINE

#ifndef LIB_X11_LIB
#define LIB_X11_LIB -lX11
#endif

#ifndef LIBX11_MACHINE
#define LIBX11_MACHINE
#endif

#ifndef LIBX11_SYSTEM
#define LIBX11_SYSTEM
#endif
configure___ LIBX=LIB_X11_LIB LIBX11_MACHINE LIBX11_SYSTEM

#ifdef UNEXEC
configure___ unexec=UNEXEC
#else
configure___ unexec=unexec.o
#endif

#ifdef SYSTEM_MALLOC
configure___ system_malloc=yes
#else
configure___ system_malloc=no
#endif

#ifndef C_DEBUG_SWITCH
#define C_DEBUG_SWITCH -g
#endif

#ifndef C_OPTIMIZE_SWITCH
#define C_OPTIMIZE_SWITCH -O
#endif

#ifdef THIS_IS_CONFIGURE

/* Get the CFLAGS for tests in configure.  */
#ifdef __GNUC__
configure___ CFLAGS=C_DEBUG_SWITCH C_OPTIMIZE_SWITCH '${SPECIFIED_CFLAGS}'
#else
configure___ CFLAGS=C_DEBUG_SWITCH '${SPECIFIED_CFLAGS}'
#endif

#else /* not THIS_IS_CONFIGURE */

/* Get the CFLAGS for real compilation.  */
#ifdef __GNUC__
configure___ REAL_CFLAGS=C_DEBUG_SWITCH C_OPTIMIZE_SWITCH '${SPECIFIED_CFLAGS}'
#else
configure___ REAL_CFLAGS=C_DEBUG_SWITCH '${SPECIFIED_CFLAGS}'
#endif

#endif /* not THIS_IS_CONFIGURE */
' > ${tempcname}
# The value of CPP is a quoted variable reference, so we need to do this
# to get its actual value...
CPP=`eval "echo $CPP"`
eval `${CPP} -Isrc ${tempcname} \
       | grep 'configure___' \
       | sed -n -e 's/^configure___ \([^=]*=\)\(.*\)$/\1"\2"/p'`
if test "x$SPECIFIED_CFLAGS" = x ; then
  eval `${CPP} -Isrc -DTHIS_IS_CONFIGURE ${tempcname} \
	 | grep 'configure___' \
	 | sed -n -e 's/^configure___ \([^=]*=\)\(.*\)$/\1"\2"/p'`
else
  REAL_CFLAGS="$CFLAGS"
fi
rm ${tempcname}

# override CFLAGS if user wishes
if test "${cflags}" != "NO_CFLAGS_DEFINED" ; then
  REAL_CFLAGS=${cflags}
fi

### Compute the unexec source name from the object name.
UNEXEC_SRC="`echo ${unexec} | sed 's/\.o/.c/'`"

# Do the opsystem or machine files prohibit the use of the GNU malloc?
# Assume not, until told otherwise.
GNU_MALLOC=yes
if test "${system_malloc}" = "yes" ; then
  GNU_MALLOC=no
  GNU_MALLOC_reason="
  (The GNU allocators don't work with this system configuration.)"
elif test "${use_system_malloc}" = "yes" ; then
  GNU_MALLOC=no
  GNU_MALLOC_reason="
  (User chose not to use GNU allocators.)"
fi

LISP_FLOAT_TYPE=yes


#### Add the libraries to LIBS and check for some functions.


CPPFLAGS="${C_SWITCH_SITE} $c_switch_system $c_switch_machine $c_switch_x_system $CPPFLAGS"
DEFS="${C_SWITCH_SITE} $c_switch_system $c_switch_machine $c_switch_x_system $DEFS"
LIBS="${LD_SWITCH_SITE} $ld_switch_x_system $libsrc_libs $LIBS"

ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -ldnet"
ac_have_lib=""
test -n "$silent" || echo "checking for -ldnet"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   
{
test -n "$verbose" && \
echo "	defining HAVE_LIBDNET"
echo "#define" HAVE_LIBDNET "1" >> confdefs.h
DEFS="$DEFS -DHAVE_LIBDNET=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_LIBDNET\${ac_dB}HAVE_LIBDNET\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_LIBDNET\${ac_uB}HAVE_LIBDNET\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_LIBDNET\${ac_eB}HAVE_LIBDNET\${ac_eC}1\${ac_eD}
"
}

   LIBS="${LIBS} -ldnet"
fi


ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lkstat"
ac_have_lib=""
test -n "$silent" || echo "checking for -lkstat"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   
{
test -n "$verbose" && \
echo "	defining HAVE_LIBKSTAT"
echo "#define" HAVE_LIBKSTAT "1" >> confdefs.h
DEFS="$DEFS -DHAVE_LIBKSTAT=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_LIBKSTAT\${ac_dB}HAVE_LIBKSTAT\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_LIBKSTAT\${ac_uB}HAVE_LIBKSTAT\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_LIBKSTAT\${ac_eB}HAVE_LIBKSTAT\${ac_eC}1\${ac_eD}
"
}

   LIBS="${LIBS} -lkstat"
fi


ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lXbsd"
ac_have_lib=""
test -n "$silent" || echo "checking for -lXbsd"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; LD_SWITCH_X_SITE="$LD_SWITCH_X_SITE -lXbsd"
else
   :; 
fi


ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lpthreads"
ac_have_lib=""
test -n "$silent" || echo "checking for -lpthreads"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; HAVE_PTHREADS=yes
else
   :; 
fi

if test -n "${HAVE_PTHREADS}" ; then
   
{
test -n "$verbose" && \
echo "	defining HAVE_PTHREADS"
echo "#define" HAVE_PTHREADS "1" >> confdefs.h
DEFS="$DEFS -DHAVE_PTHREADS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_PTHREADS\${ac_dB}HAVE_PTHREADS\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_PTHREADS\${ac_uB}HAVE_PTHREADS\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_PTHREADS\${ac_eB}HAVE_PTHREADS\${ac_eC}1\${ac_eD}
"
}

   case "${opsys}" in
     decosf* ) CFLAGS="${CFLAGS} -threads" ;;
   esac
fi

if test "${window_system}" != "none" ; then
  test -n "$silent" || echo "checking for XFree86"
  if test -d /usr/X386/include; then
    HAVE_XFREE386=yes
    test -z "${C_SWITCH_X_SITE}" && C_SWITCH_X_SITE="-I/usr/X386/include"
  elif test -f /etc/XF86Config -o \
	    -f /etc/X11/XF86Config -o \
	    -f /usr/X11R6/lib/X11/XF86Config; then
    HAVE_XFREE386=yes
    test -z "${C_SWITCH_X_SITE}" && C_SWITCH_X_SITE="-I/usr/X11R6/include"
  else
    HAVE_XFREE386=no
  fi
  test -n "$verbose" && echo "	${HAVE_XFREE386}"
else
  HAVE_XFREE386=no
fi

############################################################################
#									   #
#                     Test for various X-specific features                 #
#									   #
############################################################################

# Change CFLAGS temporarily for damn binutils 2.6.0.10 check.
if test "${HAVE_X_WINDOWS}" = "yes"; then
  case "${opsys}" in
    linux* )
      CFLAGS="-Wl,-rpath-link,/usr/X11R6/lib $CFLAGS"
      test -n "$silent" || echo "checking for whether path-link option is needed"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { ;; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  need_path_link=yes

else
  rm -rf conftest*
  need_path_link=no
fi
rm -f conftest*

      if test "${need_path_link}" = "no"; then
        CFLAGS="$REAL_CFLAGS"
	test -n "$verbose" && echo "	no"
      else
	test -n "$verbose" && echo "	yes"
      fi
    ;;
  esac
fi

# Change CFLAGS temporarily so that C_SWITCH_X_SITE gets used
# for the tests that follow.  We set it back to REAL_CFLAGS later on.
  
if test "${HAVE_X_WINDOWS}" = "yes"; then
  DEFS="$C_SWITCH_X_SITE $DEFS"
  LDFLAGS="$LDFLAGS $LD_SWITCH_X_SITE"
  LIBS="$LIBX $LIBS"
  CFLAGS="$C_SWITCH_X_SITE $CFLAGS"

  # On Solaris, arrange for LD_RUN_PATH to point to the X libraries for tests.
  # This is handled by LD_SWITCH_X_SITE_AUX during the real build,
  # but it's more convenient here to set LD_RUN_PATH
  # since this also works on hosts that don't understand LD_SWITCH_X_SITE_AUX.
  if test "${x_libraries}" != NONE && test -n "${x_libraries}"; then
    LD_RUN_PATH=$x_libraries${LD_RUN_PATH+:}$LD_RUN_PATH
    export LD_RUN_PATH
  fi

  if test "${HAVE_XFREE386}" = "yes" ; then
    case "${opsys}" in
      linux* )
	test -n "$silent" || echo "checking for whether XFree86 needs -b to link"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { XOpenDisplay ("foo");; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  xfree86_first_failure=no

else
  rm -rf conftest*
  xfree86_first_failure=yes
fi
rm -f conftest*

	if test "${xfree86_first_failure}" = "yes"; then
	  OLD_LD_SWITCH_X_SITE="$LD_SWITCH_X_SITE"
	  OLD_C_SWITCH_X_SITE="$C_SWITCH_X_SITE"
	  OLD_CPPFLAGS="$CPPFLAGS"
	  OLD_LIBS="$LIBS"
	  LD_SWITCH_X_SITE="$LD_SWITCH_X_SITE -b i486-linuxaout"
	  C_SWITCH_X_SITE="$C_SWITCH_X_SITE -b i486-linuxaout"
	  CPPFLAGS="$CPPFLAGS -b i486-linuxaout"
	  LIBS="$LIBS -b i486-linuxaout"
	  cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { XOpenDisplay ("foo");; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  xfree86_second_failure=no

else
  rm -rf conftest*
  xfree86_second_failure=yes
fi
rm -f conftest*

	  if test "${xfree86_second_failure}" = "yes"; then
	    # If we get the same failure with -b, there is no use adding -b.
	    # So take it out.  This plays safe.
	    LD_SWITCH_X_SITE="$OLD_LD_SWITCH_X_SITE"
	    C_SWITCH_X_SITE="$OLD_C_SWITCH_X_SITE"
	    CPPFLAGS="$OLD_CPPFLAGS"
	    LIBS="$OLD_LIBS"
	    test -n "$verbose" && echo "	no"
	  else
	    test -n "$verbose" && echo "	yes"
	  fi
	else
	  test -n "$verbose" && echo "	no"
	fi
      ;;
    esac
  fi

#  A C_CHECK_FUNCS(XrmSetDatabase XScreenResourceString \
#XScreenNumberOfScreen XSetWMProtocols)
fi

#
# make sure we can find libX11.*
#
if test "${window_system}" != "none" ; then
  internal_xlibs_found='no'
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lX11"
ac_have_lib=""
test -n "$silent" || echo "checking for -lX11"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; internal_xlibs_found='yes'
else
   :; 
fi

  if test "${internal_xlibs_found}" = "no" ; then
    echo "Unable to find X11 libraries." >&2
    exit 1
  else
    test -n "$verbose" && echo "	yes"
  fi
fi

#
# make sure we can find Intrinsic.h
#
if test "${window_system}" != "none" ; then
  internal_xincludes_found='no'
  for arg in ${DEFS} /usr/include
  do
    if test -f `echo "${arg}/X11/Intrinsic.h" | sed 's/^\-I//'` ; then
      internal_xincludes_found='yes'
    fi
  done
  if test "${internal_xincludes_found}" = "no" ; then
    echo "Unable to find X11 header files." >&2
    exit 1
  fi
fi

#
# Sun OS 4 systems need the following kludge
#
if test "${window_system}" != "none" ; then
  case "${canonical}" in *-sunos4* )
    LIBS="$LIBS -u _XtToolkitInitialize -u _get_applicationShellWidgetClass" ;;
  esac
fi

#
# See if we can find Xauth.
#
with_xauth='no'
if test "${window_system}" != "none" ; then
  internal_xauth_lib_found='no'
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lXau"
ac_have_lib=""
test -n "$silent" || echo "checking for -lXau"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; internal_xauth_lib_found='yes'
else
   :; 
fi

  if test "${internal_xauth_lib_found}" = "yes" ; then
    internal_xauth_includes_found='no'
    for arg in ${DEFS} /usr/include
    do
      if test -f `echo "${arg}/X11/Xauth.h" | sed 's/^\-I//'` ; then
  	internal_xauth_includes_found='yes'
      fi
    done
    if test "${internal_xauth_includes_found}" = "yes" ; then
      with_xauth='yes'
    fi
  fi
fi
test "${with_xauth}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_XAUTH"
echo "#define" HAVE_XAUTH "1" >> confdefs.h
DEFS="$DEFS -DHAVE_XAUTH=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_XAUTH\${ac_dB}HAVE_XAUTH\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_XAUTH\${ac_uB}HAVE_XAUTH\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_XAUTH\${ac_eB}HAVE_XAUTH\${ac_eC}1\${ac_eD}
"
}


#
# See if we can find CDE.
#
if test "${window_system}" != "none" -a \
	"${with_cde}"      != "no"   -a \
	"${with_cde}"      != "yes" ; then
  internal_cde_lib_found='no'
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lDtSvc"
ac_have_lib=""
test -n "$silent" || echo "checking for -lDtSvc"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; internal_cde_lib_found='yes'
else
   :; 
fi

  if test "${internal_cde_lib_found}" = "yes" ; then
    internal_cde_includes_found='no'
    for arg in ${DEFS} /usr/include ; do
      if test -f `echo "${arg}/Dt/Dt.h" | sed 's/^\-I//'` ; then
        internal_cde_includes_found='yes'
      fi
    done
    if test "${internal_cde_includes_found}" = "yes" ; then
      with_cde='yes'
    fi
  fi
fi
test "${with_cde}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_CDE"
echo "#define" HAVE_CDE "1" >> confdefs.h
DEFS="$DEFS -DHAVE_CDE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_CDE\${ac_dB}HAVE_CDE\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_CDE\${ac_uB}HAVE_CDE\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_CDE\${ac_eB}HAVE_CDE\${ac_eC}1\${ac_eD}
"
}


#
# See if we can find OffiX.
#
if test "${window_system}" != "none" -a \
	"${with_offix}"    != "no"   -a \
	"${with_offix}"    != "yes" ; then
  internal_offix_lib_found='no'
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lDnd"
ac_have_lib=""
test -n "$silent" || echo "checking for -lDnd"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; internal_offix_lib_found='yes'
else
   :; 
fi

  if test "${internal_offix_lib_found}" = "yes" ; then
    internal_offix_includes_found='no'
    for arg in ${DEFS} /usr/include ; do
      if test -f `echo "${arg}/OffiX/DragAndDrop.h" | sed 's/^\-I//'` ; then
        internal_offix_includes_found='yes'
      fi
    done
    test "${internal_offix_includes_found}" = "yes" && with_offix='yes'
  fi
fi
test "${with_offix}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_OFFIX_DND"
echo "#define" HAVE_OFFIX_DND "1" >> confdefs.h
DEFS="$DEFS -DHAVE_OFFIX_DND=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_OFFIX_DND\${ac_dB}HAVE_OFFIX_DND\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_OFFIX_DND\${ac_uB}HAVE_OFFIX_DND\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_OFFIX_DND\${ac_eB}HAVE_OFFIX_DND\${ac_eC}1\${ac_eD}
"
}


# X window options
if test "${window_system}" != "none" ; then
  test -n "$silent" || echo "checking the version of X11 being used"
cat > conftest.${ac_ext} <<EOF
#include <X11/Intrinsic.h>
int main() {
#if (XlibSpecificationRelease == 4)
  printf ("X11R4\n");
#elif (XlibSpecificationRelease == 5)
  printf ("X11R5\n");
#elif (XlibSpecificationRelease == 6)
  printf ("X11R6\n");
#elif (XtSpecificationRelease == 4)
  printf ("X11R4\n");
#endif
  return 0;
}
EOF
ac_save_LIBS="${LIBS}"
LIBS="${LIBS} ${DEFS}"
if eval $ac_compile; then
  case "`./conftest`" in
    X11R4 ) 
{
test -n "$verbose" && \
echo "	defining THIS_IS_X11R4"
echo "#define" THIS_IS_X11R4 "1" >> confdefs.h
DEFS="$DEFS -DTHIS_IS_X11R4=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}THIS_IS_X11R4\${ac_dB}THIS_IS_X11R4\${ac_dC}1\${ac_dD}
\${ac_uA}THIS_IS_X11R4\${ac_uB}THIS_IS_X11R4\${ac_uC}1\${ac_uD}
\${ac_eA}THIS_IS_X11R4\${ac_eB}THIS_IS_X11R4\${ac_eC}1\${ac_eD}
"
}
 ;;
    X11R5 ) 
{
test -n "$verbose" && \
echo "	defining THIS_IS_X11R5"
echo "#define" THIS_IS_X11R5 "1" >> confdefs.h
DEFS="$DEFS -DTHIS_IS_X11R5=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}THIS_IS_X11R5\${ac_dB}THIS_IS_X11R5\${ac_dC}1\${ac_dD}
\${ac_uA}THIS_IS_X11R5\${ac_uB}THIS_IS_X11R5\${ac_uC}1\${ac_uD}
\${ac_eA}THIS_IS_X11R5\${ac_eB}THIS_IS_X11R5\${ac_eC}1\${ac_eD}
"
}
 ;;
    X11R6 ) 
{
test -n "$verbose" && \
echo "	defining THIS_IS_X11R6"
echo "#define" THIS_IS_X11R6 "1" >> confdefs.h
DEFS="$DEFS -DTHIS_IS_X11R6=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}THIS_IS_X11R6\${ac_dB}THIS_IS_X11R6\${ac_dC}1\${ac_dD}
\${ac_uA}THIS_IS_X11R6\${ac_uB}THIS_IS_X11R6\${ac_uC}1\${ac_uD}
\${ac_eA}THIS_IS_X11R6\${ac_eB}THIS_IS_X11R6\${ac_eC}1\${ac_eD}
"
}
 ;;
  esac
fi
LIBS=$ac_save_LIBS
rm -f conftest*

  for ac_hdr in X11/Xlocale.h
do
ac_tr_hdr=HAVE_`echo $ac_hdr | tr '[a-z]./' '[A-Z]__'`
test -n "$silent" || echo "checking for ${ac_hdr}"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <${ac_hdr}>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining ${ac_tr_hdr}"
echo "#define" ${ac_tr_hdr} "1" >> confdefs.h
DEFS="$DEFS -D${ac_tr_hdr}=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}${ac_tr_hdr}\${ac_dB}${ac_tr_hdr}\${ac_dC}1\${ac_dD}
\${ac_uA}${ac_tr_hdr}\${ac_uB}${ac_tr_hdr}\${ac_uC}1\${ac_uD}
\${ac_eA}${ac_tr_hdr}\${ac_eB}${ac_tr_hdr}\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*
done

fi

#
# if Energize specified, make sure we can find its need libraries/headers
#
if test "${with_energize}" = "yes" ; then
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lenergize"
ac_have_lib=""
test -n "$silent" || echo "checking for -lenergize"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; energize_version='3.X'
else
   :; 
fi

  if test "${energize_version}" = "no" ; then
    ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lconn"
ac_have_lib=""
test -n "$silent" || echo "checking for -lconn"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; energize_version='2.X'
else
   :; 
fi

    if test "${energize_version}" = "no" ; then
      echo "Unable to find Energize library." >&2
      exit 1
    fi
  fi

  internal_eincludes_found='no'
  for arg in ${DEFS} /usr/include
  do
    if test -f `echo "${arg}/editorconn.h" | sed 's/^\-I//'` ; then
      internal_eincludes_found='yes'
    fi
  done
  if test "${internal_eincludes_found}" = "no" ; then
    echo "Unable to find Energize editorconn.h header file." >&2
    exit 1
  fi
fi

#
# logb and frexp are found in -lm on most systems.
#
ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lm"
ac_have_lib=""
test -n "$silent" || echo "checking for -lm"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   
{
test -n "$verbose" && \
echo "	defining HAVE_LIBM"
echo "#define" HAVE_LIBM "1" >> confdefs.h
DEFS="$DEFS -DHAVE_LIBM=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_LIBM\${ac_dB}HAVE_LIBM\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_LIBM\${ac_uB}HAVE_LIBM\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_LIBM\${ac_eB}HAVE_LIBM\${ac_eC}1\${ac_eD}
"
}

   LIBS="${LIBS} -lm"
fi


#
# see if XPM is hanging around somewhere
#
test "${window_system}" != "none" -a \
     "${with_xpm}"      != "no"   -a \
     "${with_xpm}"      != "yes" && { ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lXpm"
ac_have_lib=""
test -n "$silent" || echo "checking for -lXpm"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; with_xpm="yes"
else
   :; 
fi
 }

test "${with_xpm}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_XPM"
echo "#define" HAVE_XPM "1" >> confdefs.h
DEFS="$DEFS -DHAVE_XPM=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_XPM\${ac_dB}HAVE_XPM\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_XPM\${ac_uB}HAVE_XPM\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_XPM\${ac_eB}HAVE_XPM\${ac_eC}1\${ac_eD}
"
}


#
# see if Xmu is hanging around somewhere
#
# FSF 19.31 has this:
#dnl If using toolkit, check whether libXmu.a exists.
#dnl tranle@intellicorp.com says libXmu.a can need XtMalloc in libXt.a to link.
#  OLDLIBS="$LIBS"
#  if test x$HAVE_X11XTR6 = xyes; then
#    LIBS="-lXt -lSM -lICE $LIBS"
#  else
#    LIBS="-lXt $LIBS"
#  fi
#  A C_CHECK_LIB(Xmu, XmuConvertStandardSelection)
#  LIBS="$OLDLIBS"

if test "${window_system}" != "none" ; then
  if test "${with_xmu}" != "no" ; then
    test "${with_xmu}" != "yes" && { ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lXmu"
ac_have_lib=""
test -n "$silent" || echo "checking for -lXmu"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; with_xmu="yes"
else
   :; 
fi
 }
    # On SunOS4 we must kludge harder to try to detect Xmu
    # Upgrade to autoconf 2 and use ac_check_lib - mrb
    if test "${with_xmu}" != "yes" -a -n "$OPENWINHOME" ; then
      # begin expansion of ac_have_library
      ac_save_LIBS="${LIBS}"
      LIBS="${LIBS} -lXmu -lXt -lXext -lX11 -lm"
      if test ${machine} = sparc -a ${opsys} = linux; then
	LIBS="${LIBS} -lICE -lSM"
      fi
      ac_have_lib=""
      cat > conftest.${ac_ext} <<EOF
int main() { return 0; }
EOF
      if eval $ac_compile; then
        rm -rf conftest*
        ac_have_lib="1"
      fi
      rm -f conftest*
      LIBS="${ac_save_LIBS}"
      test -n "${ac_have_lib}" && with_xmu="yes"
      # end expansion of ac_have_library
    fi
    # Sparc/Linux test - fp
    if test "${with_xmu}" != "yes" -a  ${machine} = sparc -a ${opsys} = linux; then
      # begin expansion of ac_have_library
      ac_save_LIBS="${LIBS}"
      LIBS="${LIBS} -lXmu -lXt -lXext -lX11 -lm -lICE -lSM"
      ac_have_lib=""
      cat > conftest.${ac_ext} <<EOF
int main() { return 0; }
EOF
      if eval $ac_compile; then
        rm -rf conftest*
        ac_have_lib="1"
      fi
      rm -f conftest*
      LIBS="${ac_save_LIBS}"
      test -n "${ac_have_lib}" && with_xmu="yes"
      # end expansion of ac_have_library
    fi
    # On UnixWare 2.1 we must kludge harder to try to detect Xmu
    # Upgrade to autoconf 2 and use ac_check_lib - mrb
    if test "${with_xmu}" != "yes" && test -f "/.UpgradeVer2.1" ; then
      # begin expansion of ac_have_library
      ac_save_LIBS="${LIBS}"
      if test x$HAVE_XFREE386 = xyes; then
	LIBS="-lXt -lSM -lICE ${LIBS}"
      else
	LIBS="${LIBS} -lXmu -lXt -lXext -lX11"
      fi
      ac_have_lib=""
      cat > conftest.${ac_ext} <<EOF
int main() { return 0; }
EOF
      if eval $ac_compile; then
        rm -rf conftest*
        ac_have_lib="1"
      fi
      rm -f conftest*
      LIBS="${ac_save_LIBS}"
      test -n "${ac_have_lib}" && with_xmu="yes"
      # end expansion of ac_have_library
    fi
  fi
fi
test "${with_xmu}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_XMU"
echo "#define" HAVE_XMU "1" >> confdefs.h
DEFS="$DEFS -DHAVE_XMU=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_XMU\${ac_dB}HAVE_XMU\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_XMU\${ac_uB}HAVE_XMU\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_XMU\${ac_eB}HAVE_XMU\${ac_eC}1\${ac_eD}
"
}


#
# see if COMPFACE is hanging around somewhere
#
if test "${window_system}" != "none" -a \
        "${with_xface}"    != "no"   -a \
        "${with_xface}"    != "yes" ; then
  test -n "$silent" || echo "checking for compface.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <compface.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  compface_incl="yes"

else
  rm -rf conftest*
  with_xface="no"
fi
rm -f conftest*

  if test "${compface_incl}" = "yes" ; then
    ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lcompface"
ac_have_lib=""
test -n "$silent" || echo "checking for -lcompface"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; with_xface="yes"
else
   :; 
fi

  fi
fi
test "${with_xface}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_XFACE"
echo "#define" HAVE_XFACE "1" >> confdefs.h
DEFS="$DEFS -DHAVE_XFACE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_XFACE\${ac_dB}HAVE_XFACE\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_XFACE\${ac_uB}HAVE_XFACE\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_XFACE\${ac_eB}HAVE_XFACE\${ac_eC}1\${ac_eD}
"
}


#
# check whether we're using GIF support
#
if test "${window_system}" = "none" ; then
  if test -z "${with_gif}" ; then
    with_gif=no
  elif test "${with_gif}" != "no" ; then
    echo "GIF support cannot be specified without a window system."
    exit 1
  fi
elif test -z "${with_gif}" ; then
  with_gif=yes
fi
test "${with_gif}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_GIF"
echo "#define" HAVE_GIF "1" >> confdefs.h
DEFS="$DEFS -DHAVE_GIF=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_GIF\${ac_dB}HAVE_GIF\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_GIF\${ac_uB}HAVE_GIF\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_GIF\${ac_eB}HAVE_GIF\${ac_eC}1\${ac_eD}
"
}


if test "${window_system}" = "none" ; then
  if test -z "${with_jpeg}" ; then
    with_jpeg=no
  elif test "${with_jpeg}" != "no" ; then
    echo "JPEG support cannot be specified without a window system."
    exit 1
  fi
else
  if test "${with_jpeg}" != "no" -a \
          "${with_jpeg}" != "yes" ; then
    test -n "$silent" || echo "checking for jpeglib.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <jpeglib.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  jpeglib_incl="yes"

else
  rm -rf conftest*
  with_jpeg="no"
fi
rm -f conftest*

    test "${jpeglib_incl}" = "yes" && { ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -ljpeg"
ac_have_lib=""
test -n "$silent" || echo "checking for -ljpeg"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; with_jpeg="yes"
else
   :; 
fi
 }
  fi
fi
test "${with_jpeg}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_JPEG"
echo "#define" HAVE_JPEG "1" >> confdefs.h
DEFS="$DEFS -DHAVE_JPEG=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_JPEG\${ac_dB}HAVE_JPEG\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_JPEG\${ac_uB}HAVE_JPEG\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_JPEG\${ac_eB}HAVE_JPEG\${ac_eC}1\${ac_eD}
"
}


if test "${window_system}" = "none" ; then
  if test -z "${with_png}" ; then
    with_png=no
  elif test "${with_png}" != "no" ; then
    echo "PNG support cannot be specified without a window system."
    exit 1
  fi
fi
test -z "${with_png}" && { test -n "$silent" || echo "checking for png.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <png.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  :
else
  rm -rf conftest*
  with_png="no"
fi
rm -f conftest*
 }
test -z "${with_png}" && { test -n "$silent" || echo "checking for pow"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_pow) || defined (__stub___pow)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char pow(); pow();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  :
else
  rm -rf conftest*
  with_png="no"
fi
rm -f conftest*
 }
if test -z "${with_png}" ; then
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lz"
ac_have_lib=""
test -n "$silent" || echo "checking for -lz"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; with_png="yes"
else
   :; 
fi

  test -z "${with_png}" && { ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lgz"
ac_have_lib=""
test -n "$silent" || echo "checking for -lgz"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; with_png="gnuz"
else
   :; with_png="no"
fi
 }
  if test "${with_png}" != "no"; then
    png_save_libs="${LIBS}"
    case "${with_png}" in
      yes  ) LIBS="${LIBS} -lz" ;;
      gnuz ) LIBS="${LIBS} -lgz" ;;
    esac
    ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lpng"
ac_have_lib=""
test -n "$silent" || echo "checking for -lpng"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; 
else
   :; with_png="no"
fi

    LIBS="$png_save_libs"
  fi
fi
case "${with_png}" in
  yes  ) 
{
test -n "$verbose" && \
echo "	defining HAVE_PNG"
echo "#define" HAVE_PNG "1" >> confdefs.h
DEFS="$DEFS -DHAVE_PNG=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_PNG\${ac_dB}HAVE_PNG\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_PNG\${ac_uB}HAVE_PNG\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_PNG\${ac_eB}HAVE_PNG\${ac_eC}1\${ac_eD}
"
}
 ;;
  gnuz ) 
{
test -n "$verbose" && \
echo "	defining HAVE_PNG"
echo "#define" HAVE_PNG "1" >> confdefs.h
DEFS="$DEFS -DHAVE_PNG=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_PNG\${ac_dB}HAVE_PNG\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_PNG\${ac_uB}HAVE_PNG\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_PNG\${ac_eB}HAVE_PNG\${ac_eC}1\${ac_eD}
"
}
 
{
test -n "$verbose" && \
echo "	defining HAVE_PNG_GNUZ"
echo "#define" HAVE_PNG_GNUZ "1" >> confdefs.h
DEFS="$DEFS -DHAVE_PNG_GNUZ=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_PNG_GNUZ\${ac_dB}HAVE_PNG_GNUZ\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_PNG_GNUZ\${ac_uB}HAVE_PNG_GNUZ\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_PNG_GNUZ\${ac_eB}HAVE_PNG_GNUZ\${ac_eC}1\${ac_eD}
"
}
 ;;
esac

test "${with_tiff}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_TIFF"
echo "#define" HAVE_TIFF "1" >> confdefs.h
DEFS="$DEFS -DHAVE_TIFF=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_TIFF\${ac_dB}HAVE_TIFF\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_TIFF\${ac_uB}HAVE_TIFF\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_TIFF\${ac_eB}HAVE_TIFF\${ac_eC}1\${ac_eD}
"
}


# We use Lucid toolkit defaults for the menubars and scrollbars, but
# if Motif is available we use it for the dialog boxes.
if test "${window_system}" != "none" ; then
  save_libs="${LIBS}"
  if test "x${with_dialogs}" = "x" ; then
      # We can't use ac_have_library because it simply appends -lXm to the
      # end of the link line which is insufficient since -lXm will generate
      # dependencies on -lXt
# begin expansion of ac_have_library
ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lXm -lXt ${LIBS}"
ac_have_lib=""
test -n "$silent" || echo "checking for -lXm"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; with_dialogs="motif" motif_libs="-lXm -lXt"
else
   :; 
fi
# end expansion of ac_have_library
    # Sigh.  My Motif (MoTeeth) under Linux also depends on Xpm and Xext.
    if test "${with_dialogs}" != "motif" ; then
# begin expansion of ac_have_library
ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lXm -lXt -lXpm -lXext ${LIBS}"
ac_have_lib=""
test -n "$silent" || echo "checking for -lXm in another way"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; with_dialogs="motif" motif_libs="-lXm -lXt -lXpm -lXext"
else
   :; 
fi
# end expansion of ac_have_library
    fi
    test "${with_dialogs}" = "motif" && test -n "$verbose" && echo "	Found Motif"
  fi
fi

# Finish ensuring that we have values for the various toolkit items.

test "${with_menubars}"   = "motif" -o \
     "${with_scrollbars}" = "motif" -o \
     "${with_dialogs}"    = "motif"  && with_motif="yes"
test "${with_menubars}"   = "athena" -o \
     "${with_scrollbars}" = "athena" -o \
     "${with_dialogs}"    = "athena"  && with_athena="yes"
test "${with_menubars}"   = "athena3d" -o \
     "${with_scrollbars}" = "athena3d" -o \
     "${with_dialogs}"    = "athena3d"  && with_athena="yes"
test "${with_menubars}"   = ""       && with_menubars="lucid"
test "${with_menubars}"   = "athena" && with_menubars="lucid"
test "${with_scrollbars}" = ""       && with_scrollbars="lucid"
test "${with_dialogs}"    = ""       && with_dialogs="athena"
test "${with_dialogs}"    = "lucid"  && with_dialogs="athena"

test "${with_menubars}"   != "no"    && 
{
test -n "$verbose" && \
echo "	defining HAVE_MENUBARS"
echo "#define" HAVE_MENUBARS "1" >> confdefs.h
DEFS="$DEFS -DHAVE_MENUBARS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_MENUBARS\${ac_dB}HAVE_MENUBARS\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_MENUBARS\${ac_uB}HAVE_MENUBARS\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_MENUBARS\${ac_eB}HAVE_MENUBARS\${ac_eC}1\${ac_eD}
"
}

test "${with_scrollbars}" != "no"    && 
{
test -n "$verbose" && \
echo "	defining HAVE_SCROLLBARS"
echo "#define" HAVE_SCROLLBARS "1" >> confdefs.h
DEFS="$DEFS -DHAVE_SCROLLBARS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_SCROLLBARS\${ac_dB}HAVE_SCROLLBARS\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_SCROLLBARS\${ac_uB}HAVE_SCROLLBARS\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_SCROLLBARS\${ac_eB}HAVE_SCROLLBARS\${ac_eC}1\${ac_eD}
"
}

test "${with_dialogs}"    != "no"    && 
{
test -n "$verbose" && \
echo "	defining HAVE_DIALOGS"
echo "#define" HAVE_DIALOGS "1" >> confdefs.h
DEFS="$DEFS -DHAVE_DIALOGS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_DIALOGS\${ac_dB}HAVE_DIALOGS\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_DIALOGS\${ac_uB}HAVE_DIALOGS\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_DIALOGS\${ac_eB}HAVE_DIALOGS\${ac_eC}1\${ac_eD}
"
}


test "${with_menubars}"   = "lucid"  && 
{
test -n "$verbose" && \
echo "	defining LWLIB_MENUBARS_LUCID"
echo "#define" LWLIB_MENUBARS_LUCID "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_MENUBARS_LUCID=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_MENUBARS_LUCID\${ac_dB}LWLIB_MENUBARS_LUCID\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_MENUBARS_LUCID\${ac_uB}LWLIB_MENUBARS_LUCID\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_MENUBARS_LUCID\${ac_eB}LWLIB_MENUBARS_LUCID\${ac_eC}1\${ac_eD}
"
}

test "${with_menubars}"   = "motif"  && 
{
test -n "$verbose" && \
echo "	defining LWLIB_MENUBARS_MOTIF"
echo "#define" LWLIB_MENUBARS_MOTIF "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_MENUBARS_MOTIF=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_MENUBARS_MOTIF\${ac_dB}LWLIB_MENUBARS_MOTIF\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_MENUBARS_MOTIF\${ac_uB}LWLIB_MENUBARS_MOTIF\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_MENUBARS_MOTIF\${ac_eB}LWLIB_MENUBARS_MOTIF\${ac_eC}1\${ac_eD}
"
}

test "${with_scrollbars}" = "lucid"  && 
{
test -n "$verbose" && \
echo "	defining LWLIB_SCROLLBARS_LUCID"
echo "#define" LWLIB_SCROLLBARS_LUCID "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_SCROLLBARS_LUCID=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_SCROLLBARS_LUCID\${ac_dB}LWLIB_SCROLLBARS_LUCID\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_SCROLLBARS_LUCID\${ac_uB}LWLIB_SCROLLBARS_LUCID\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_SCROLLBARS_LUCID\${ac_eB}LWLIB_SCROLLBARS_LUCID\${ac_eC}1\${ac_eD}
"
}

test "${with_scrollbars}" = "motif"  && 
{
test -n "$verbose" && \
echo "	defining LWLIB_SCROLLBARS_MOTIF"
echo "#define" LWLIB_SCROLLBARS_MOTIF "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_SCROLLBARS_MOTIF=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_SCROLLBARS_MOTIF\${ac_dB}LWLIB_SCROLLBARS_MOTIF\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_SCROLLBARS_MOTIF\${ac_uB}LWLIB_SCROLLBARS_MOTIF\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_SCROLLBARS_MOTIF\${ac_eB}LWLIB_SCROLLBARS_MOTIF\${ac_eC}1\${ac_eD}
"
}

test "${with_scrollbars}" = "athena" && 
{
test -n "$verbose" && \
echo "	defining LWLIB_SCROLLBARS_ATHENA"
echo "#define" LWLIB_SCROLLBARS_ATHENA "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_SCROLLBARS_ATHENA=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_SCROLLBARS_ATHENA\${ac_dB}LWLIB_SCROLLBARS_ATHENA\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_SCROLLBARS_ATHENA\${ac_uB}LWLIB_SCROLLBARS_ATHENA\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_SCROLLBARS_ATHENA\${ac_eB}LWLIB_SCROLLBARS_ATHENA\${ac_eC}1\${ac_eD}
"
}

if test "${with_scrollbars}" = "athena3d"; then
	
{
test -n "$verbose" && \
echo "	defining LWLIB_SCROLLBARS_ATHENA"
echo "#define" LWLIB_SCROLLBARS_ATHENA "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_SCROLLBARS_ATHENA=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_SCROLLBARS_ATHENA\${ac_dB}LWLIB_SCROLLBARS_ATHENA\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_SCROLLBARS_ATHENA\${ac_uB}LWLIB_SCROLLBARS_ATHENA\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_SCROLLBARS_ATHENA\${ac_eB}LWLIB_SCROLLBARS_ATHENA\${ac_eC}1\${ac_eD}
"
}

	
{
test -n "$verbose" && \
echo "	defining LWLIB_SCROLLBARS_ATHENA3D"
echo "#define" LWLIB_SCROLLBARS_ATHENA3D "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_SCROLLBARS_ATHENA3D=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_SCROLLBARS_ATHENA3D\${ac_dB}LWLIB_SCROLLBARS_ATHENA3D\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_SCROLLBARS_ATHENA3D\${ac_uB}LWLIB_SCROLLBARS_ATHENA3D\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_SCROLLBARS_ATHENA3D\${ac_eB}LWLIB_SCROLLBARS_ATHENA3D\${ac_eC}1\${ac_eD}
"
}

fi
test "${with_dialogs}"    = "motif"  && 
{
test -n "$verbose" && \
echo "	defining LWLIB_DIALOGS_MOTIF"
echo "#define" LWLIB_DIALOGS_MOTIF "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_DIALOGS_MOTIF=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_DIALOGS_MOTIF\${ac_dB}LWLIB_DIALOGS_MOTIF\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_DIALOGS_MOTIF\${ac_uB}LWLIB_DIALOGS_MOTIF\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_DIALOGS_MOTIF\${ac_eB}LWLIB_DIALOGS_MOTIF\${ac_eC}1\${ac_eD}
"
}

test "${with_dialogs}"    = "athena" && 
{
test -n "$verbose" && \
echo "	defining LWLIB_DIALOGS_ATHENA"
echo "#define" LWLIB_DIALOGS_ATHENA "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_DIALOGS_ATHENA=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_DIALOGS_ATHENA\${ac_dB}LWLIB_DIALOGS_ATHENA\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_DIALOGS_ATHENA\${ac_uB}LWLIB_DIALOGS_ATHENA\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_DIALOGS_ATHENA\${ac_eB}LWLIB_DIALOGS_ATHENA\${ac_eC}1\${ac_eD}
"
}

if test "${with_dialogs}"    = "athena3d"; then
	
{
test -n "$verbose" && \
echo "	defining LWLIB_DIALOGS_ATHENA"
echo "#define" LWLIB_DIALOGS_ATHENA "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_DIALOGS_ATHENA=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_DIALOGS_ATHENA\${ac_dB}LWLIB_DIALOGS_ATHENA\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_DIALOGS_ATHENA\${ac_uB}LWLIB_DIALOGS_ATHENA\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_DIALOGS_ATHENA\${ac_eB}LWLIB_DIALOGS_ATHENA\${ac_eC}1\${ac_eD}
"
}

	
{
test -n "$verbose" && \
echo "	defining LWLIB_DIALOGS_ATHENA3D"
echo "#define" LWLIB_DIALOGS_ATHENA3D "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_DIALOGS_ATHENA3D=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_DIALOGS_ATHENA3D\${ac_dB}LWLIB_DIALOGS_ATHENA3D\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_DIALOGS_ATHENA3D\${ac_uB}LWLIB_DIALOGS_ATHENA3D\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_DIALOGS_ATHENA3D\${ac_eB}LWLIB_DIALOGS_ATHENA3D\${ac_eC}1\${ac_eD}
"
}

fi

############################################################################
#									   #
#                             Misc other feature tests                     #
#									   #
############################################################################

# Mule-dependent option processing
if test "$with_mule" = "yes" ; then
  # Do we have the XmIm* routines?  And if so, do we want to use them?
  test "$with_xim" != no && test -n "$silent" || echo "checking for XIM"
  if test -z "$with_xim" -o "$with_xim" = "yes" ; then
    xim_save_libs="$LIBS"
    LIBS="${motif_libs} ${LIBS}"
    test -n "$silent" || echo "checking for XmImMbLookupString"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_XmImMbLookupString) || defined (__stub___XmImMbLookupString)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char XmImMbLookupString(); XmImMbLookupString();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  have_XmIm=yes

else
  rm -rf conftest*
  have_XmIm=no
fi
rm -f conftest*

    LIBS="$xim_save_libs"
    if   test "$have_XmIm" = "yes"; then with_xim=motif
    elif test "$with_xim"  = "yes"; then with_xim=xlib
    else                                 with_xim=no
    fi
  fi
  if test "$with_xim" != "no" ; then
    
{
test -n "$verbose" && \
echo "	defining HAVE_XIM"
echo "#define" HAVE_XIM "1" >> confdefs.h
DEFS="$DEFS -DHAVE_XIM=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_XIM\${ac_dB}HAVE_XIM\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_XIM\${ac_uB}HAVE_XIM\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_XIM\${ac_eB}HAVE_XIM\${ac_eC}1\${ac_eD}
"
}

    test "$with_xim" = "xlib"  && 
{
test -n "$verbose" && \
echo "	defining XIM_XLIB"
echo "#define" XIM_XLIB "1" >> confdefs.h
DEFS="$DEFS -DXIM_XLIB=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}XIM_XLIB\${ac_dB}XIM_XLIB\${ac_dC}1\${ac_dD}
\${ac_uA}XIM_XLIB\${ac_uB}XIM_XLIB\${ac_uC}1\${ac_uD}
\${ac_eA}XIM_XLIB\${ac_eB}XIM_XLIB\${ac_eC}1\${ac_eD}
"
}

    test "$with_xim" = "motif" && 
{
test -n "$verbose" && \
echo "	defining XIM_MOTIF"
echo "#define" XIM_MOTIF "1" >> confdefs.h
DEFS="$DEFS -DXIM_MOTIF=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}XIM_MOTIF\${ac_dB}XIM_MOTIF\${ac_dC}1\${ac_dD}
\${ac_uA}XIM_MOTIF\${ac_uB}XIM_MOTIF\${ac_uC}1\${ac_uD}
\${ac_eA}XIM_MOTIF\${ac_eB}XIM_MOTIF\${ac_eC}1\${ac_eD}
"
}

  fi
else # Other internationalization features depend on Mule
  with_mule="no"
  for feature in xim canna wnn ; do
    if eval "test -n \"\$with_$feature\" -a \"\$with_$feature\" != no" ; then
      echo "configure: warning: --with-$feature ignored:  Not valid without Mule support" >&2
    fi
    eval "with_$feature=no"
  done
fi

# If netdb.h doesn't declare h_errno, we must declare it by hand.
test -n "$silent" || echo "checking for declaration of h_errno in netdb.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <netdb.h>
int main() { return 0; }
int t() { int i = h_errno;; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_H_ERRNO"
echo "#define" HAVE_H_ERRNO "1" >> confdefs.h
DEFS="$DEFS -DHAVE_H_ERRNO=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_H_ERRNO\${ac_dB}HAVE_H_ERRNO\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_H_ERRNO\${ac_uB}HAVE_H_ERRNO\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_H_ERRNO\${ac_eB}HAVE_H_ERRNO\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*


test -n "$silent" || echo "checking for sigsetjmp"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <setjmp.h>
int main() { return 0; }
int t() { sigjmp_buf bar; sigsetjmp (bar, 0);; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_SIGSETJMP"
echo "#define" HAVE_SIGSETJMP "1" >> confdefs.h
DEFS="$DEFS -DHAVE_SIGSETJMP=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_SIGSETJMP\${ac_dB}HAVE_SIGSETJMP\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_SIGSETJMP\${ac_uB}HAVE_SIGSETJMP\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_SIGSETJMP\${ac_eB}HAVE_SIGSETJMP\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*


test -n "$silent" || echo "checking whether localtime caches TZ"
emacs_cv_localtime_cache=
test -n "$silent" || echo "checking whether cross-compiling"
# If we cannot run a trivial program, we must be cross compiling.
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
main(){exit(0);}
EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  :
else
  cross_compiling=1
fi
rm -fr conftest*

if test -n "$cross_compiling"
then
  # If we have tzset, assume the worst when cross-compiling.
emacs_cv_localtime_cache=yes
else
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <time.h>
#if 1 /* STDC_HEADERS */
# include <stdlib.h>
#endif
extern char **environ;
unset_TZ ()
{
  char **from, **to;
  for (to = from = environ; (*to = *from); from++)
    if (! (to[0][0] == 'T' && to[0][1] == 'Z' && to[0][2] == '='))
      to++;
}
main()
{
  time_t now = time ((time_t *) 0);
  int hour_GMT0, hour_unset;
  if (putenv ("TZ=GMT0") != 0)
    exit (1);
  hour_GMT0 = localtime (&now)->tm_hour;
  unset_TZ ();
  hour_unset = localtime (&now)->tm_hour;
  if (putenv ("TZ=PST8") != 0)
    exit (1);
  if (localtime (&now)->tm_hour == hour_GMT0)
    exit (1);
  unset_TZ ();
  if (localtime (&now)->tm_hour != hour_unset)
    exit (1);
  exit (0);
}
EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  emacs_cv_localtime_cache=no

else
  emacs_cv_localtime_cache=yes
fi
fi
rm -fr conftest*
test -n "$verbose" && echo "	"$emacs_cv_localtime_cache""
if test x$emacs_cv_localtime_cache = xyes; then
  
{
test -n "$verbose" && \
echo "	defining LOCALTIME_CACHE"
echo "#define" LOCALTIME_CACHE "1" >> confdefs.h
DEFS="$DEFS -DLOCALTIME_CACHE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LOCALTIME_CACHE\${ac_dB}LOCALTIME_CACHE\${ac_dC}1\${ac_dD}
\${ac_uA}LOCALTIME_CACHE\${ac_uB}LOCALTIME_CACHE\${ac_uC}1\${ac_uD}
\${ac_eA}LOCALTIME_CACHE\${ac_eB}LOCALTIME_CACHE\${ac_eC}1\${ac_eD}
"
}

fi

if test "x$HAVE_TIMEVAL" = xyes; then
test -n "$silent" || echo "checking for whether gettimeofday can't accept two arguments"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

#ifdef TIME_WITH_SYS_TIME
#include <sys/time.h>
#include <time.h>
#else
#ifdef HAVE_SYS_TIME_H
#include <sys/time.h>
#else
#include <time.h>
#endif
#endif
  
int main() { return 0; }
int t() { 
  struct timeval time;
  struct timezone dummy;
  gettimeofday (&time, &dummy);
; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  test -n "$verbose" && echo "	no"

else
  rm -rf conftest*
  test -n "$verbose" && echo "	yes"
   
{
test -n "$verbose" && \
echo "	defining GETTIMEOFDAY_ONE_ARGUMENT"
echo "#define" GETTIMEOFDAY_ONE_ARGUMENT "1" >> confdefs.h
DEFS="$DEFS -DGETTIMEOFDAY_ONE_ARGUMENT=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}GETTIMEOFDAY_ONE_ARGUMENT\${ac_dB}GETTIMEOFDAY_ONE_ARGUMENT\${ac_dC}1\${ac_dD}
\${ac_uA}GETTIMEOFDAY_ONE_ARGUMENT\${ac_uB}GETTIMEOFDAY_ONE_ARGUMENT\${ac_uC}1\${ac_uD}
\${ac_eA}GETTIMEOFDAY_ONE_ARGUMENT\${ac_eB}GETTIMEOFDAY_ONE_ARGUMENT\${ac_eC}1\${ac_eD}
"
}

fi
rm -f conftest*

fi

test -n "$silent" || echo "checking for whether inline functions are supported"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { 
inline int
foo ()
{
  return 0;
}
; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_INLINE"
echo "#define" HAVE_INLINE "1" >> confdefs.h
DEFS="$DEFS -DHAVE_INLINE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_INLINE\${ac_dB}HAVE_INLINE\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_INLINE\${ac_uB}HAVE_INLINE\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_INLINE\${ac_eB}HAVE_INLINE\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*


# This does all sorts of magic to make sure alloca() works OK.
# It might even add some junk to the top of <config.h>.
# (I don't understand what goes on here, but it seems to work.)
# The Ultrix 4.2 mips builtin alloca declared by alloca.h only works
# for constant arguments.  Useless!
test -n "$silent" || echo "checking for working alloca.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <alloca.h>
int main() { return 0; }
int t() { char *p = alloca(2 * sizeof(int));; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_ALLOCA_H"
echo "#define" HAVE_ALLOCA_H "1" >> confdefs.h
DEFS="$DEFS -DHAVE_ALLOCA_H=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_ALLOCA_H\${ac_dB}HAVE_ALLOCA_H\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_ALLOCA_H\${ac_uB}HAVE_ALLOCA_H\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_ALLOCA_H\${ac_eB}HAVE_ALLOCA_H\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*

ac_decl="#ifdef __GNUC__
#define alloca __builtin_alloca
#else
#if HAVE_ALLOCA_H
#include <alloca.h>
#else
#ifdef _AIX
 #pragma alloca
#else
char *alloca ();
#endif
#endif
#endif
"
test -n "$silent" || echo "checking for alloca"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
$ac_decl
int main() { return 0; }
int t() { char *p = (char *) alloca(1);; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_ALLOCA"
echo "#define" HAVE_ALLOCA "1" >> confdefs.h
DEFS="$DEFS -DHAVE_ALLOCA=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_ALLOCA\${ac_dB}HAVE_ALLOCA\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_ALLOCA\${ac_uB}HAVE_ALLOCA\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_ALLOCA\${ac_eB}HAVE_ALLOCA\${ac_eC}1\${ac_eD}
"
}


else
  rm -rf conftest*
  ac_alloca_missing=1
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

#if defined(CRAY) && ! defined(CRAY2)
winnitude
#else
lossage
#endif

EOF
eval "$ac_cpp conftest.${ac_ext} > conftest.out 2>&1"
if egrep "winnitude" conftest.out >/dev/null 2>&1; then
  rm -rf conftest*
  test -n "$silent" || echo "checking for _getb67"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub__getb67) || defined (__stub____getb67)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char _getb67(); _getb67();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  {
test -n "$verbose" && \
echo "	defining" CRAY_STACKSEG_END to be "_getb67"
echo "#define" CRAY_STACKSEG_END "_getb67" >> confdefs.h
DEFS="$DEFS -DCRAY_STACKSEG_END=_getb67"
ac_sed_defs="${ac_sed_defs}\${ac_dA}CRAY_STACKSEG_END\${ac_dB}CRAY_STACKSEG_END\${ac_dC}_getb67\${ac_dD}
\${ac_uA}CRAY_STACKSEG_END\${ac_uB}CRAY_STACKSEG_END\${ac_uC}_getb67\${ac_uD}
\${ac_eA}CRAY_STACKSEG_END\${ac_eB}CRAY_STACKSEG_END\${ac_eC}_getb67\${ac_eD}
"
}


else
  rm -rf conftest*
  test -n "$silent" || echo "checking for GETB67"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_GETB67) || defined (__stub___GETB67)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char GETB67(); GETB67();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  {
test -n "$verbose" && \
echo "	defining" CRAY_STACKSEG_END to be "GETB67"
echo "#define" CRAY_STACKSEG_END "GETB67" >> confdefs.h
DEFS="$DEFS -DCRAY_STACKSEG_END=GETB67"
ac_sed_defs="${ac_sed_defs}\${ac_dA}CRAY_STACKSEG_END\${ac_dB}CRAY_STACKSEG_END\${ac_dC}GETB67\${ac_dD}
\${ac_uA}CRAY_STACKSEG_END\${ac_uB}CRAY_STACKSEG_END\${ac_uC}GETB67\${ac_uD}
\${ac_eA}CRAY_STACKSEG_END\${ac_eB}CRAY_STACKSEG_END\${ac_eC}GETB67\${ac_eD}
"
}


else
  rm -rf conftest*
  test -n "$silent" || echo "checking for getb67"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_getb67) || defined (__stub___getb67)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char getb67(); getb67();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  {
test -n "$verbose" && \
echo "	defining" CRAY_STACKSEG_END to be "getb67"
echo "#define" CRAY_STACKSEG_END "getb67" >> confdefs.h
DEFS="$DEFS -DCRAY_STACKSEG_END=getb67"
ac_sed_defs="${ac_sed_defs}\${ac_dA}CRAY_STACKSEG_END\${ac_dB}CRAY_STACKSEG_END\${ac_dC}getb67\${ac_dD}
\${ac_uA}CRAY_STACKSEG_END\${ac_uB}CRAY_STACKSEG_END\${ac_uC}getb67\${ac_uD}
\${ac_eA}CRAY_STACKSEG_END\${ac_eB}CRAY_STACKSEG_END\${ac_eC}getb67\${ac_eD}
"
}


fi
rm -f conftest*

fi
rm -f conftest*

fi
rm -f conftest*


fi
rm -f conftest*


fi
rm -f conftest*

if test -n "$ac_alloca_missing"; then
  # The SVR3 libPW and SVR4 libucb both contain incompatible functions
  # that cause trouble.  Some versions do not even contain alloca or
  # contain a buggy version.  If you still want to use their alloca,
  # use ar to extract alloca.o from them instead of compiling alloca.c.
  ALLOCA=alloca.o
  
{
test -n "$verbose" && \
echo "	defining C_ALLOCA"
echo "#define" C_ALLOCA "1" >> confdefs.h
DEFS="$DEFS -DC_ALLOCA=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}C_ALLOCA\${ac_dB}C_ALLOCA\${ac_dC}1\${ac_dD}
\${ac_uA}C_ALLOCA\${ac_uB}C_ALLOCA\${ac_uC}1\${ac_uD}
\${ac_eA}C_ALLOCA\${ac_eB}C_ALLOCA\${ac_eC}1\${ac_eD}
"
}


  test -n "$silent" || echo "checking stack direction for C alloca"
  if test -n "$cross_compiling"
then
  
{
test -n "$verbose" && \
echo "	defining" STACK_DIRECTION to be "0"
echo "#define" STACK_DIRECTION "0" >> confdefs.h
DEFS="$DEFS -DSTACK_DIRECTION=0"
ac_sed_defs="${ac_sed_defs}\${ac_dA}STACK_DIRECTION\${ac_dB}STACK_DIRECTION\${ac_dC}0\${ac_dD}
\${ac_uA}STACK_DIRECTION\${ac_uB}STACK_DIRECTION\${ac_uC}0\${ac_uD}
\${ac_eA}STACK_DIRECTION\${ac_eB}STACK_DIRECTION\${ac_eC}0\${ac_eD}
"
}

else
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
find_stack_direction ()
{
  static char *addr = 0;
  auto char dummy;
  if (addr == 0)
    {
      addr = &dummy;
      return find_stack_direction ();
    }
  else
    return (&dummy > addr) ? 1 : -1;
}
main ()
{
  exit (find_stack_direction() < 0);
}
EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  
{
test -n "$verbose" && \
echo "	defining" STACK_DIRECTION to be "1"
echo "#define" STACK_DIRECTION "1" >> confdefs.h
DEFS="$DEFS -DSTACK_DIRECTION=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}STACK_DIRECTION\${ac_dB}STACK_DIRECTION\${ac_dC}1\${ac_dD}
\${ac_uA}STACK_DIRECTION\${ac_uB}STACK_DIRECTION\${ac_uC}1\${ac_uD}
\${ac_eA}STACK_DIRECTION\${ac_eB}STACK_DIRECTION\${ac_eC}1\${ac_eD}
"
}


else
  
{
test -n "$verbose" && \
echo "	defining" STACK_DIRECTION to be "-1"
echo "#define" STACK_DIRECTION "-1" >> confdefs.h
DEFS="$DEFS -DSTACK_DIRECTION=-1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}STACK_DIRECTION\${ac_dB}STACK_DIRECTION\${ac_dC}-1\${ac_dD}
\${ac_uA}STACK_DIRECTION\${ac_uB}STACK_DIRECTION\${ac_uC}-1\${ac_uD}
\${ac_eA}STACK_DIRECTION\${ac_eB}STACK_DIRECTION\${ac_eC}-1\${ac_eD}
"
}

fi
fi
rm -fr conftest*
fi


# Check whether vfork exists and works correctly. (This does more
# than just check for its existence.) If so, it defines HAVE_VFORK_H.
# If not, it defines vfork to be fork.
test -n "$silent" || echo "checking for pid_t in sys/types.h"
echo '#include "confdefs.h"
#include <sys/types.h>' > conftest.${ac_ext}
eval "$ac_cpp conftest.${ac_ext} > conftest.out 2>&1"
if egrep "pid_t" conftest.out >/dev/null 2>&1; then
  :
else
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining" pid_t to be "int"
echo "#define" pid_t "int" >> confdefs.h
DEFS="$DEFS -Dpid_t=int"
ac_sed_defs="${ac_sed_defs}\${ac_dA}pid_t\${ac_dB}pid_t\${ac_dC}int\${ac_dD}
\${ac_uA}pid_t\${ac_uB}pid_t\${ac_uC}int\${ac_uD}
\${ac_eA}pid_t\${ac_eB}pid_t\${ac_eC}int\${ac_eD}
"
}

fi
rm -f conftest*

test -n "$silent" || echo "checking for vfork.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <vfork.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_VFORK_H"
echo "#define" HAVE_VFORK_H "1" >> confdefs.h
DEFS="$DEFS -DHAVE_VFORK_H=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_VFORK_H\${ac_dB}HAVE_VFORK_H\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_VFORK_H\${ac_uB}HAVE_VFORK_H\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_VFORK_H\${ac_eB}HAVE_VFORK_H\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*

test -n "$silent" || echo "checking for working vfork"

cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
/* Thanks to Paul Eggert for this test.  */
#include <stdio.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <signal.h>
#ifdef HAVE_UNISTD_H
#include <unistd.h>
#endif
#ifdef HAVE_VFORK_H
#include <vfork.h>
#endif
static int signalled;
static RETSIGTYPE catch (s) int s; { signalled = 1; }
main() {
  pid_t parent = getpid ();
  pid_t child;

  signal (SIGINT, catch);

  child = vfork ();

  if (child == 0) {
    /* On sparc systems, changes by the child to local and incoming
       argument registers are propagated back to the parent.
       The compiler is told about this with #include <vfork.h>,
       but some compilers (e.g. gcc -O) don't grok <vfork.h>.
       Test for this by using lots of local variables, at least
       as many local variables as main has allocated so far
       including compiler temporaries.  4 locals are enough for
       gcc 1.40.3 on a sparc, but we use 8 to be safe.
       A buggy compiler should reuse the register of parent
       for one of the local variables, since it will think that
       parent can't possibly be used any more in this routine.
       Assigning to the local variable will thus munge parent
       in the parent process.  */
    pid_t
      p = getpid(), p1 = getpid(), p2 = getpid(), p3 = getpid(),
      p4 = getpid(), p5 = getpid(), p6 = getpid(), p7 = getpid();
    /* Convince the compiler that p..p7 are live; otherwise, it might
       use the same hardware register for all 8 local variables.  */
    if (p != p1 || p != p2 || p != p3 || p != p4
	|| p != p5 || p != p6 || p != p7)
      _exit(1);

    /* On some systems (e.g. SunOS 5.2), if the parent is catching
       a signal, the child ignores the signal before execing,
       and the parent later receives that signal, the parent dumps core.
       Test for this by ignoring SIGINT in the child.  */
    signal (SIGINT, SIG_IGN);

    /* On some systems (e.g. IRIX 3.3),
       vfork doesn't separate parent from child file descriptors.
       If the child closes a descriptor before it execs or exits,
       this munges the parent's descriptor as well.
       Test for this by closing stdout in the child.  */
    _exit(close(fileno(stdout)) != 0);
  } else {
    int status;
    struct stat st;

    while (wait(&status) != child)
      ;
    exit(
	 /* Was there some problem with vforking?  */
	 child < 0

	 /* Did the child fail?  (This shouldn't happen.)  */
	 || status

	 /* Did the vfork/compiler bug occur?  */
	 || parent != getpid()

	 /* Did the signal handling bug occur?  */
	 || kill(parent, SIGINT) != 0
	 || signalled != 1

	 /* Did the file descriptor bug occur?  */
	 || fstat(fileno(stdout), &st) != 0
	 );
  }
}
EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  :
else
  
{
test -n "$verbose" && \
echo "	defining" vfork to be "fork"
echo "#define" vfork "fork" >> confdefs.h
DEFS="$DEFS -Dvfork=fork"
ac_sed_defs="${ac_sed_defs}\${ac_dA}vfork\${ac_dB}vfork\${ac_dC}fork\${ac_dD}
\${ac_uA}vfork\${ac_uB}vfork\${ac_uC}fork\${ac_uD}
\${ac_eA}vfork\${ac_eB}vfork\${ac_eC}fork\${ac_eD}
"
}

fi
rm -fr conftest*


# Check whether mmap exists and works correctly. (This does more
# than just check for its existence.) If so, it defines HAVE_MMAP.
# Actually, this seems to rule out some cases where mmap() can
# work fine for our purposes (e.g. HPUX).  We get a big win out
# of using mmap(), so let's go back to the old way.

# Check whether strcoll exists and works correctly. (This does more
# than just check for its existence.) If so, it defines HAVE_STRCOLL.
test -n "$silent" || echo "checking for strcoll"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <string.h>
main ()
{
  exit (strcoll ("abc", "def") >= 0 ||
	strcoll ("ABC", "DEF") >= 0 ||
	strcoll ("123", "456") >= 0);
}
EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  
{
test -n "$verbose" && \
echo "	defining HAVE_STRCOLL"
echo "#define" HAVE_STRCOLL "1" >> confdefs.h
DEFS="$DEFS -DHAVE_STRCOLL=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_STRCOLL\${ac_dB}HAVE_STRCOLL\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_STRCOLL\${ac_uB}HAVE_STRCOLL\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_STRCOLL\${ac_eB}HAVE_STRCOLL\${ac_eC}1\${ac_eD}
"
}


fi
rm -fr conftest*

test -n "$silent" || echo "checking size of short"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <stdio.h>
main()
{
  FILE *f=fopen("conftestval", "w");
  if (!f) exit(1);
  fprintf(f, "%d\n", sizeof(short));
  exit(0);
}
EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  ac_size=`cat conftestval`

else
  echo "configure: can not determine size of short" >&2; exit 1
fi
rm -fr conftest*

{
test -n "$verbose" && \
echo "	defining" SIZEOF_SHORT to be "$ac_size"
echo "#define" SIZEOF_SHORT "$ac_size" >> confdefs.h
DEFS="$DEFS -DSIZEOF_SHORT=$ac_size"
ac_sed_defs="${ac_sed_defs}\${ac_dA}SIZEOF_SHORT\${ac_dB}SIZEOF_SHORT\${ac_dC}$ac_size\${ac_dD}
\${ac_uA}SIZEOF_SHORT\${ac_uB}SIZEOF_SHORT\${ac_uC}$ac_size\${ac_uD}
\${ac_eA}SIZEOF_SHORT\${ac_eB}SIZEOF_SHORT\${ac_eC}$ac_size\${ac_eD}
"
}

test -n "$silent" || echo "checking size of int"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <stdio.h>
main()
{
  FILE *f=fopen("conftestval", "w");
  if (!f) exit(1);
  fprintf(f, "%d\n", sizeof(int));
  exit(0);
}
EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  ac_size=`cat conftestval`

else
  echo "configure: can not determine size of int" >&2; exit 1
fi
rm -fr conftest*

{
test -n "$verbose" && \
echo "	defining" SIZEOF_INT to be "$ac_size"
echo "#define" SIZEOF_INT "$ac_size" >> confdefs.h
DEFS="$DEFS -DSIZEOF_INT=$ac_size"
ac_sed_defs="${ac_sed_defs}\${ac_dA}SIZEOF_INT\${ac_dB}SIZEOF_INT\${ac_dC}$ac_size\${ac_dD}
\${ac_uA}SIZEOF_INT\${ac_uB}SIZEOF_INT\${ac_uC}$ac_size\${ac_uD}
\${ac_eA}SIZEOF_INT\${ac_eB}SIZEOF_INT\${ac_eC}$ac_size\${ac_eD}
"
}

test -n "$silent" || echo "checking size of long"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <stdio.h>
main()
{
  FILE *f=fopen("conftestval", "w");
  if (!f) exit(1);
  fprintf(f, "%d\n", sizeof(long));
  exit(0);
}
EOF
eval $ac_compile
if test -s conftest && (./conftest; exit) 2>/dev/null; then
  ac_size=`cat conftestval`

else
  echo "configure: can not determine size of long" >&2; exit 1
fi
rm -fr conftest*

{
test -n "$verbose" && \
echo "	defining" SIZEOF_LONG to be "$ac_size"
echo "#define" SIZEOF_LONG "$ac_size" >> confdefs.h
DEFS="$DEFS -DSIZEOF_LONG=$ac_size"
ac_sed_defs="${ac_sed_defs}\${ac_dA}SIZEOF_LONG\${ac_dB}SIZEOF_LONG\${ac_dC}$ac_size\${ac_dD}
\${ac_uA}SIZEOF_LONG\${ac_uB}SIZEOF_LONG\${ac_uC}$ac_size\${ac_uD}
\${ac_eA}SIZEOF_LONG\${ac_eB}SIZEOF_LONG\${ac_eC}$ac_size\${ac_eD}
"
}


# FSF 19.29 does this:
# # fmod, logb, and frexp are found in -lm on most systems.
# # On HPUX 9.01, -lm does not contain logb, so check for sqrt.
# A C_CHECK_LIB(m, sqrt)

for ac_func in acosh asinh atanh cbrt closedir dup2 eaccess fmod fpathconf frexp ftime gethostname getpagesize gettimeofday getcwd getwd logb lrand48 matherr mkdir mktime perror poll random realpath rename res_init rint rmdir select setitimer setpgid setlocale setsid sigblock sighold sigprocmask strcasecmp strerror tzset utimes waitpid
do
ac_tr_func=HAVE_`echo $ac_func | tr '[a-z]' '[A-Z]'`
test -n "$silent" || echo "checking for ${ac_func}"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_${ac_func}) || defined (__stub___${ac_func})
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char ${ac_func}(); ${ac_func}();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  {
test -n "$verbose" && \
echo "	defining ${ac_tr_func}"
echo "#define" ${ac_tr_func} "1" >> confdefs.h
DEFS="$DEFS -D${ac_tr_func}=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}${ac_tr_func}\${ac_dB}${ac_tr_func}\${ac_dC}1\${ac_dD}
\${ac_uA}${ac_tr_func}\${ac_uB}${ac_tr_func}\${ac_uC}1\${ac_uD}
\${ac_eA}${ac_tr_func}\${ac_eB}${ac_tr_func}\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*
done


# Check for mmap.
found_mmap=true
test -n "$silent" || echo "checking for mmap"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_mmap) || defined (__stub___mmap)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char mmap(); mmap();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  :
else
  rm -rf conftest*
  found_mmap=
fi
rm -f conftest*

test -n "$found_mmap" && 
{
test -n "$verbose" && \
echo "	defining HAVE_MMAP"
echo "#define" HAVE_MMAP "1" >> confdefs.h
DEFS="$DEFS -DHAVE_MMAP=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_MMAP\${ac_dB}HAVE_MMAP\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_MMAP\${ac_uB}HAVE_MMAP\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_MMAP\${ac_eB}HAVE_MMAP\${ac_eC}1\${ac_eD}
"
}


test "${GNU_MALLOC}" != "yes"   -a "${found_mmap}" != "true" && rel_alloc=no
test "${rel_alloc}" = "default" -a "${found_mmap}"  = "true" && rel_alloc=yes

# Check for Internet sockets.

ok_so_far=true
test -n "$silent" || echo "checking for socket"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_socket) || defined (__stub___socket)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char socket(); socket();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  :
else
  rm -rf conftest*
  ok_so_far=
fi
rm -f conftest*

test -n "$ok_so_far" && { test -n "$silent" || echo "checking for netinet/in.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <netinet/in.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  :
else
  rm -rf conftest*
  ok_so_far=
fi
rm -f conftest*
 }
test -n "$ok_so_far" && { test -n "$silent" || echo "checking for arpa/inet.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <arpa/inet.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  :
else
  rm -rf conftest*
  ok_so_far=
fi
rm -f conftest*
 }
if test -n "$ok_so_far"; then
  
{
test -n "$verbose" && \
echo "	defining HAVE_SOCKETS"
echo "#define" HAVE_SOCKETS "1" >> confdefs.h
DEFS="$DEFS -DHAVE_SOCKETS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_SOCKETS\${ac_dB}HAVE_SOCKETS\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_SOCKETS\${ac_uB}HAVE_SOCKETS\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_SOCKETS\${ac_eB}HAVE_SOCKETS\${ac_eC}1\${ac_eD}
"
}

  # Check for the sun_len member in struct sockaddr_un.

  test -n "$silent" || echo "checking for sun_len member in struct sockaddr_un"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <sys/types.h>
  #include <sys/socket.h>
  #include <sys/un.h>
int main() { return 0; }
int t() { static struct sockaddr_un x; x.sun_len = 1;; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining HAVE_SOCKADDR_SUN_LEN"
echo "#define" HAVE_SOCKADDR_SUN_LEN "1" >> confdefs.h
DEFS="$DEFS -DHAVE_SOCKADDR_SUN_LEN=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_SOCKADDR_SUN_LEN\${ac_dB}HAVE_SOCKADDR_SUN_LEN\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_SOCKADDR_SUN_LEN\${ac_uB}HAVE_SOCKADDR_SUN_LEN\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_SOCKADDR_SUN_LEN\${ac_eB}HAVE_SOCKADDR_SUN_LEN\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*

fi

# Check for SYS V IPC. (Inferior to sockets.)

if test -z "$ok_so_far"; then
  ok_so_far=true
  test -n "$silent" || echo "checking for msgget"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_msgget) || defined (__stub___msgget)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char msgget(); msgget();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  :
else
  rm -rf conftest*
  ok_so_far=
fi
rm -f conftest*

  test -n "$ok_so_far" && { test -n "$silent" || echo "checking for sys/ipc.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <sys/ipc.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  :
else
  rm -rf conftest*
  ok_so_far=
fi
rm -f conftest*
 }
  test -n "$ok_so_far" && { test -n "$silent" || echo "checking for sys/msg.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <sys/msg.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  :
else
  rm -rf conftest*
  ok_so_far=
fi
rm -f conftest*
 }
  test -n "$ok_so_far" &&   
{
test -n "$verbose" && \
echo "	defining HAVE_SYSVIPC"
echo "#define" HAVE_SYSVIPC "1" >> confdefs.h
DEFS="$DEFS -DHAVE_SYSVIPC=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_SYSVIPC\${ac_dB}HAVE_SYSVIPC\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_SYSVIPC\${ac_uB}HAVE_SYSVIPC\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_SYSVIPC\${ac_eB}HAVE_SYSVIPC\${ac_eC}1\${ac_eD}
"
}

fi

# Check for directory variants

sysv_system_dir=
nonsystem_dir_library=
test -n "$silent" || echo "checking for dirent.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <dirent.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  sysv_system_dir=yes

fi
rm -f conftest*

test -z "$sysv_system_dir" &&
  { test -n "$silent" || echo "checking for sys/dir.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <sys/dir.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  :
else
  rm -rf conftest*
  nonsystem_dir_library=yes
fi
rm -f conftest*
 }
if   test -n "$sysv_system_dir"       ; then 
{
test -n "$verbose" && \
echo "	defining SYSV_SYSTEM_DIR"
echo "#define" SYSV_SYSTEM_DIR "1" >> confdefs.h
DEFS="$DEFS -DSYSV_SYSTEM_DIR=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}SYSV_SYSTEM_DIR\${ac_dB}SYSV_SYSTEM_DIR\${ac_dC}1\${ac_dD}
\${ac_uA}SYSV_SYSTEM_DIR\${ac_uB}SYSV_SYSTEM_DIR\${ac_uC}1\${ac_uD}
\${ac_eA}SYSV_SYSTEM_DIR\${ac_eB}SYSV_SYSTEM_DIR\${ac_eC}1\${ac_eD}
"
}

elif test -n "$nonsystem_dir_library" ; then 
{
test -n "$verbose" && \
echo "	defining NONSYSTEM_DIR_LIBRARY"
echo "#define" NONSYSTEM_DIR_LIBRARY "1" >> confdefs.h
DEFS="$DEFS -DNONSYSTEM_DIR_LIBRARY=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}NONSYSTEM_DIR_LIBRARY\${ac_dB}NONSYSTEM_DIR_LIBRARY\${ac_dC}1\${ac_dD}
\${ac_uA}NONSYSTEM_DIR_LIBRARY\${ac_uB}NONSYSTEM_DIR_LIBRARY\${ac_uC}1\${ac_uD}
\${ac_eA}NONSYSTEM_DIR_LIBRARY\${ac_eB}NONSYSTEM_DIR_LIBRARY\${ac_eC}1\${ac_eD}
"
}

fi


echo "checking how to do terminal I/O"

have_termios=
have_termio=
test -n "$silent" || echo "checking for termios.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <termios.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  have_termios=yes

fi
rm -f conftest*

test -z "$have_termios" && { test -n "$silent" || echo "checking for termio.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <termio.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  have_termio=yes

fi
rm -f conftest*
 }
if   test -n "$have_termios" ; then 
{
test -n "$verbose" && \
echo "	defining HAVE_TERMIOS"
echo "#define" HAVE_TERMIOS "1" >> confdefs.h
DEFS="$DEFS -DHAVE_TERMIOS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_TERMIOS\${ac_dB}HAVE_TERMIOS\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_TERMIOS\${ac_uB}HAVE_TERMIOS\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_TERMIOS\${ac_eB}HAVE_TERMIOS\${ac_eC}1\${ac_eD}
"
}

elif test -n "$have_termio"  ; then 
{
test -n "$verbose" && \
echo "	defining HAVE_TERMIO"
echo "#define" HAVE_TERMIO "1" >> confdefs.h
DEFS="$DEFS -DHAVE_TERMIO=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_TERMIO\${ac_dB}HAVE_TERMIO\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_TERMIO\${ac_uB}HAVE_TERMIO\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_TERMIO\${ac_eB}HAVE_TERMIO\${ac_eC}1\${ac_eD}
"
}

fi

# Check for nlist.h
test -n "$silent" || echo "checking for nlist.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <nlist.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  
{
test -n "$verbose" && \
echo "	defining NLIST_STRUCT"
echo "#define" NLIST_STRUCT "1" >> confdefs.h
DEFS="$DEFS -DNLIST_STRUCT=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}NLIST_STRUCT\${ac_dB}NLIST_STRUCT\${ac_dC}1\${ac_dD}
\${ac_uA}NLIST_STRUCT\${ac_uB}NLIST_STRUCT\${ac_uC}1\${ac_uD}
\${ac_eA}NLIST_STRUCT\${ac_eB}NLIST_STRUCT\${ac_eC}1\${ac_eD}
"
}


fi
rm -f conftest*


# AIX export list
if test -f /usr/lpp/X11/bin/smt.exp ; then
  
{
test -n "$verbose" && \
echo "	defining" AIX_SMT_EXP to be "-bI:/usr/lpp/X11/bin/smt.exp"
echo "#define" AIX_SMT_EXP "-bI:/usr/lpp/X11/bin/smt.exp" >> confdefs.h
DEFS="$DEFS -DAIX_SMT_EXP=-bI:/usr/lpp/X11/bin/smt.exp"
ac_sed_defs="${ac_sed_defs}\${ac_dA}AIX_SMT_EXP\${ac_dB}AIX_SMT_EXP\${ac_dC}-bI:/usr/lpp/X11/bin/smt.exp\${ac_dD}
\${ac_uA}AIX_SMT_EXP\${ac_uB}AIX_SMT_EXP\${ac_uC}-bI:/usr/lpp/X11/bin/smt.exp\${ac_uD}
\${ac_eA}AIX_SMT_EXP\${ac_eB}AIX_SMT_EXP\${ac_eC}-bI:/usr/lpp/X11/bin/smt.exp\${ac_eD}
"
}

elif test -f /usr/bin/X11/smt.exp ; then
  
{
test -n "$verbose" && \
echo "	defining" AIX_SMT_EXP to be "-bI:/usr/bin/X11/smt.exp"
echo "#define" AIX_SMT_EXP "-bI:/usr/bin/X11/smt.exp" >> confdefs.h
DEFS="$DEFS -DAIX_SMT_EXP=-bI:/usr/bin/X11/smt.exp"
ac_sed_defs="${ac_sed_defs}\${ac_dA}AIX_SMT_EXP\${ac_dB}AIX_SMT_EXP\${ac_dC}-bI:/usr/bin/X11/smt.exp\${ac_dD}
\${ac_uA}AIX_SMT_EXP\${ac_uB}AIX_SMT_EXP\${ac_uC}-bI:/usr/bin/X11/smt.exp\${ac_uD}
\${ac_eA}AIX_SMT_EXP\${ac_eB}AIX_SMT_EXP\${ac_eC}-bI:/usr/bin/X11/smt.exp\${ac_eD}
"
}

fi

CFLAGS="$REAL_CFLAGS"

file="${srcdir}/lisp/version.el"
version=`sed -ne 's/^(defconst emacs-version "\(.*\)".*/\1/p' "$file"`
if test  -z "${version}"; then
  echo "${progname}: can't find current emacs version in \"$file\"." >&2
  exit 1
fi
beta=`sed -ne 's/^.*XEmacs Lucid (beta\([0-9][0-9]*\)).*$/\1/p' "$file"`
test -n "$beta"  && version="${version}-b${beta}"



# the following needs to be fixed for SGI.
if test -z "${native_sound_lib}" ; then
  if   test -r /usr/demo/SOUND/lib/libaudio.a; then
    native_sound_lib=/usr/demo/SOUND/lib/libaudio.a
  elif test -r /usr/demo/SOUND/libaudio.a ; then
    native_sound_lib=/usr/demo/SOUND/libaudio.a
  else
    case "${canonical}" in
      *-sgi-*        ) ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -laudio"
ac_have_lib=""
test -n "$silent" || echo "checking for -laudio"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; native_sound_lib="-laudio"
else
   :; 
fi
 ;;
      hppa*-hp-hpux* ) ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lAlib"
ac_have_lib=""
test -n "$silent" || echo "checking for -lAlib"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; native_sound_lib="-lAlib"
else
   :; 
fi
  ;;
    esac
  fi
fi
test -z "${with_sound}" -a -n "${native_sound_lib}" && with_sound="native";

#### If the nas library doesn't contain the error jump point, then
#### we force safer behaviour.

if test "${with_sound}" = "nas" -o \
        "${with_sound}" = "both"; then
  echo '#include "confdefs.h"
#include <audio/Xtutil.h>' > conftest.${ac_ext}
eval "$ac_cpp conftest.${ac_ext} > conftest.out 2>&1"
if egrep "AuXtErrorJump" conftest.out >/dev/null 2>&1; then
  :
else
  rm -rf conftest*
  old_nas=true
fi
rm -f conftest*

fi

if test "${with_tooltalk}" = "yes" ; then
  for arg in ${DEFS} "-I/usr/include" "-I${OPENWINHOME-/usr/openwin}/include"
  do
    if test -f `echo "${arg}/desktop/tt_c.h" | sed 's/^\-I//'` ; then
      C_SWITCH_X_SITE="${C_SWITCH_X_SITE} ${arg}/desktop"
    fi
  done

  for arg in ${LIBS} "-L/usr/lib" "-L${OPENWINHHOME-/usr/openwin}/lib"
  do
    case "${arg}" in
	-L*) if test -f `echo "${arg}/libtt.a" | sed 's/^\-L//'` ; then
		 dash_r=''
		 if test -n "${add_runtime_flag}" ; then
		     dash_r=`echo ${arg} | sed "s/^-L/-R${dash_r_space}/"`
		 fi
		 LD_SWITCH_X_SITE="${LD_SWITCH_X_SITE} ${arg} ${dash_r}"
	     fi
	     ;;
    esac
  done
fi


if test "${with_tty}" != "no"  ; then
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lncurses"
ac_have_lib=""
test -n "$silent" || echo "checking for -lncurses"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; have_ncurses=yes
else
   :; have_ncurses=no
fi

  if test "${have_ncurses}" = "yes"  ; then
    
{
test -n "$verbose" && \
echo "	defining HAVE_NCURSES"
echo "#define" HAVE_NCURSES "1" >> confdefs.h
DEFS="$DEFS -DHAVE_NCURSES=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_NCURSES\${ac_dB}HAVE_NCURSES\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_NCURSES\${ac_uB}HAVE_NCURSES\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_NCURSES\${ac_eB}HAVE_NCURSES\${ac_eC}1\${ac_eD}
"
}

    test -n "$silent" || echo "checking for ncurses/term.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ncurses/term.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  have_ncurses_term_h=yes

else
  rm -rf conftest*
  have_ncurses_term_h=no
fi
rm -f conftest*

    test "${have_ncurses_term_h}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_NCURSES_TERM_H"
echo "#define" HAVE_NCURSES_TERM_H "1" >> confdefs.h
DEFS="$DEFS -DHAVE_NCURSES_TERM_H=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_NCURSES_TERM_H\${ac_dB}HAVE_NCURSES_TERM_H\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_NCURSES_TERM_H\${ac_uB}HAVE_NCURSES_TERM_H\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_NCURSES_TERM_H\${ac_eB}HAVE_NCURSES_TERM_H\${ac_eC}1\${ac_eD}
"
}

    test -n "$silent" || echo "checking for ncurses/curses.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ncurses/curses.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  have_ncurses_curses_h=yes

else
  rm -rf conftest*
  have_ncurses_curses_h=no
fi
rm -f conftest*

    if test "${have_ncurses_curses_h}" = "no"  ; then
                        OLD_CPP="${CPP}"
      CPP="${CPP} -I/usr/include/ncurses"
      test -n "$silent" || echo "checking for ncurses/curses.h"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ncurses/curses.h>
EOF
ac_err=`eval "(exec $ac_cpp conftest.${ac_ext} >/dev/null) 2>&1"`
if test "${extra_verbose}" = "yes"  && test -n "$ac_err"; then
  echo "$ac_err"
fi
if test -z "$ac_err"; then
  rm -rf conftest*
  have_ncurses_curses_h=yes

else
  rm -rf conftest*
  have_ncurses_curses_h=no
fi
rm -f conftest*

      if test "${have_ncurses_curses_h}" = "yes"  ; then
        site_includes="${site_includes} /usr/include/ncurses"
	C_SWITCH_SITE="${C_SWITCH_SITE} -I/usr/include/ncurses"
	test -n "$verbose" && echo "	Your system has the bogus ncurses include bug."
      else
	CPP="${OLD_CPP}"
      fi
    fi
    test "${have_ncurses_curses_h}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_NCURSES_CURSES_H"
echo "#define" HAVE_NCURSES_CURSES_H "1" >> confdefs.h
DEFS="$DEFS -DHAVE_NCURSES_CURSES_H=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_NCURSES_CURSES_H\${ac_dB}HAVE_NCURSES_CURSES_H\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_NCURSES_CURSES_H\${ac_uB}HAVE_NCURSES_CURSES_H\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_NCURSES_CURSES_H\${ac_eB}HAVE_NCURSES_CURSES_H\${ac_eC}1\${ac_eD}
"
}

  fi
fi



if test "${with_database_berkdb}" != "no"  ; then
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -ldb"
ac_have_lib=""
test -n "$silent" || echo "checking for -ldb"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; have_libdb=yes
else
   :; have_libdb=no
fi

  test "${have_libdb}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_LIBDB"
echo "#define" HAVE_LIBDB "1" >> confdefs.h
DEFS="$DEFS -DHAVE_LIBDB=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_LIBDB\${ac_dB}HAVE_LIBDB\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_LIBDB\${ac_uB}HAVE_LIBDB\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_LIBDB\${ac_eB}HAVE_LIBDB\${ac_eC}1\${ac_eD}
"
}

  if test "${with_database_berkdb}" != "yes"  ; then
    if test "${have_libdb}" = "yes"  ; then
      with_database_berkdb=yes
    else
      test -n "$silent" || echo "checking for dbopen"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_dbopen) || defined (__stub___dbopen)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char dbopen(); dbopen();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  with_database_berkdb=yes

else
  rm -rf conftest*
  with_database_berkdb=no
fi
rm -f conftest*

    fi
  fi
fi
test "${with_database_berkdb}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_BERKELEY_DB"
echo "#define" HAVE_BERKELEY_DB "1" >> confdefs.h
DEFS="$DEFS -DHAVE_BERKELEY_DB=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_BERKELEY_DB\${ac_dB}HAVE_BERKELEY_DB\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_BERKELEY_DB\${ac_uB}HAVE_BERKELEY_DB\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_BERKELEY_DB\${ac_eB}HAVE_BERKELEY_DB\${ac_eC}1\${ac_eD}
"
}


if test "${with_database_gnudbm}" != "no"  ; then
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -lgdbm"
ac_have_lib=""
test -n "$silent" || echo "checking for -lgdbm"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; have_libgdbm=yes
else
   :; have_libgdbm=no
fi

  test "${have_libgdbm}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_LIBGDBM"
echo "#define" HAVE_LIBGDBM "1" >> confdefs.h
DEFS="$DEFS -DHAVE_LIBGDBM=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_LIBGDBM\${ac_dB}HAVE_LIBGDBM\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_LIBGDBM\${ac_uB}HAVE_LIBGDBM\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_LIBGDBM\${ac_eB}HAVE_LIBGDBM\${ac_eC}1\${ac_eD}
"
}

  test -z "${with_database_gnudbm}" && with_database_gnudbm="${have_libgdbm}"
fi
if test "${with_database_gnudbm}" = "yes" ; then
  
{
test -n "$verbose" && \
echo "	defining HAVE_DBM"
echo "#define" HAVE_DBM "1" >> confdefs.h
DEFS="$DEFS -DHAVE_DBM=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_DBM\${ac_dB}HAVE_DBM\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_DBM\${ac_uB}HAVE_DBM\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_DBM\${ac_eB}HAVE_DBM\${ac_eC}1\${ac_eD}
"
}

  
{
test -n "$verbose" && \
echo "	defining HAVE_GNU_DBM"
echo "#define" HAVE_GNU_DBM "1" >> confdefs.h
DEFS="$DEFS -DHAVE_GNU_DBM=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_GNU_DBM\${ac_dB}HAVE_GNU_DBM\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_GNU_DBM\${ac_uB}HAVE_GNU_DBM\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_GNU_DBM\${ac_eB}HAVE_GNU_DBM\${ac_eC}1\${ac_eD}
"
}

  with_database_dbm=no
fi

if test "${with_database_dbm}" != "no"  ; then
  ac_save_LIBS="${LIBS}"
LIBS="${LIBS} -ldbm"
ac_have_lib=""
test -n "$silent" || echo "checking for -ldbm"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"

int main() { return 0; }
int t() { main();; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  ac_have_lib="1"

fi
rm -f conftest*
LIBS="${ac_save_LIBS}"
if test -n "${ac_have_lib}"; then
   :; have_libdbm=yes
else
   :; have_libdbm=no
fi

  test "${have_libdbm}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_LIBDBM"
echo "#define" HAVE_LIBDBM "1" >> confdefs.h
DEFS="$DEFS -DHAVE_LIBDBM=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_LIBDBM\${ac_dB}HAVE_LIBDBM\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_LIBDBM\${ac_uB}HAVE_LIBDBM\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_LIBDBM\${ac_eB}HAVE_LIBDBM\${ac_eC}1\${ac_eD}
"
}

  if test "${with_database_dbm}" != "yes"  ; then
    if test "${have_libdbm}" = "yes"  ; then
      with_database_dbm=yes
    else
      test -n "$silent" || echo "checking for dbm_open"
cat > conftest.${ac_ext} <<EOF
#include "confdefs.h"
#include <ctype.h>
int main() { return 0; }
int t() { 
/* The GNU C library defines this for functions which it implements
    to always fail with ENOSYS.  Some functions are actually named
    something starting with __ and the normal name is an alias.  */
#if defined (__stub_dbm_open) || defined (__stub___dbm_open)
choke me
#else
/* Override any gcc2 internal prototype to avoid an error.  */
extern char dbm_open(); dbm_open();
#endif
; return 0; }
EOF
if eval $ac_compile; then
  rm -rf conftest*
  with_database_dbm=yes

else
  rm -rf conftest*
  with_database_dbm=no
fi
rm -f conftest*

    fi
  fi
fi
test "${with_database_dbm}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_DBM"
echo "#define" HAVE_DBM "1" >> confdefs.h
DEFS="$DEFS -DHAVE_DBM=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_DBM\${ac_dB}HAVE_DBM\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_DBM\${ac_uB}HAVE_DBM\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_DBM\${ac_eB}HAVE_DBM\${ac_eC}1\${ac_eD}
"
}



############################################################################
#									   #
#                     Substitute into Makefile and config.h                #
#									   #
############################################################################










































{
test -n "$verbose" && \
echo "	defining" EMACS_VERSION to be ""${version}""
echo "#define" EMACS_VERSION ""${version}"" >> confdefs.h
DEFS="$DEFS -DEMACS_VERSION="${version}""
ac_sed_defs="${ac_sed_defs}\${ac_dA}EMACS_VERSION\${ac_dB}EMACS_VERSION\${ac_dC}"${version}"\${ac_dD}
\${ac_uA}EMACS_VERSION\${ac_uB}EMACS_VERSION\${ac_uC}"${version}"\${ac_uD}
\${ac_eA}EMACS_VERSION\${ac_eB}EMACS_VERSION\${ac_eC}"${version}"\${ac_eD}
"
}


{
test -n "$verbose" && \
echo "	defining" EMACS_CONFIGURATION to be ""\"${canonical}\"""
echo "#define" EMACS_CONFIGURATION ""\"${canonical}\""" >> confdefs.h
DEFS="$DEFS -DEMACS_CONFIGURATION="\"${canonical}\"""
ac_sed_defs="${ac_sed_defs}\${ac_dA}EMACS_CONFIGURATION\${ac_dB}EMACS_CONFIGURATION\${ac_dC}"\"${canonical}\""\${ac_dD}
\${ac_uA}EMACS_CONFIGURATION\${ac_uB}EMACS_CONFIGURATION\${ac_uC}"\"${canonical}\""\${ac_uD}
\${ac_eA}EMACS_CONFIGURATION\${ac_eB}EMACS_CONFIGURATION\${ac_eC}"\"${canonical}\""\${ac_eD}
"
}


{
test -n "$verbose" && \
echo "	defining" config_machfile to be ""\"${machfile}\"""
echo "#define" config_machfile ""\"${machfile}\""" >> confdefs.h
DEFS="$DEFS -Dconfig_machfile="\"${machfile}\"""
ac_sed_defs="${ac_sed_defs}\${ac_dA}config_machfile\${ac_dB}config_machfile\${ac_dC}"\"${machfile}\""\${ac_dD}
\${ac_uA}config_machfile\${ac_uB}config_machfile\${ac_uC}"\"${machfile}\""\${ac_uD}
\${ac_eA}config_machfile\${ac_eB}config_machfile\${ac_eC}"\"${machfile}\""\${ac_eD}
"
}


{
test -n "$verbose" && \
echo "	defining" config_opsysfile to be ""\"${opsysfile}\"""
echo "#define" config_opsysfile ""\"${opsysfile}\""" >> confdefs.h
DEFS="$DEFS -Dconfig_opsysfile="\"${opsysfile}\"""
ac_sed_defs="${ac_sed_defs}\${ac_dA}config_opsysfile\${ac_dB}config_opsysfile\${ac_dC}"\"${opsysfile}\""\${ac_dD}
\${ac_uA}config_opsysfile\${ac_uB}config_opsysfile\${ac_uC}"\"${opsysfile}\""\${ac_uD}
\${ac_eA}config_opsysfile\${ac_eB}config_opsysfile\${ac_eC}"\"${opsysfile}\""\${ac_eD}
"
}


{
test -n "$verbose" && \
echo "	defining" LD_SWITCH_X_SITE to be "${LD_SWITCH_X_SITE}"
echo "#define" LD_SWITCH_X_SITE "${LD_SWITCH_X_SITE}" >> confdefs.h
DEFS="$DEFS -DLD_SWITCH_X_SITE=${LD_SWITCH_X_SITE}"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LD_SWITCH_X_SITE\${ac_dB}LD_SWITCH_X_SITE\${ac_dC}${LD_SWITCH_X_SITE}\${ac_dD}
\${ac_uA}LD_SWITCH_X_SITE\${ac_uB}LD_SWITCH_X_SITE\${ac_uC}${LD_SWITCH_X_SITE}\${ac_uD}
\${ac_eA}LD_SWITCH_X_SITE\${ac_eB}LD_SWITCH_X_SITE\${ac_eC}${LD_SWITCH_X_SITE}\${ac_eD}
"
}


{
test -n "$verbose" && \
echo "	defining" LD_SWITCH_X_SITE_AUX to be "${LD_SWITCH_X_SITE_AUX}"
echo "#define" LD_SWITCH_X_SITE_AUX "${LD_SWITCH_X_SITE_AUX}" >> confdefs.h
DEFS="$DEFS -DLD_SWITCH_X_SITE_AUX=${LD_SWITCH_X_SITE_AUX}"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LD_SWITCH_X_SITE_AUX\${ac_dB}LD_SWITCH_X_SITE_AUX\${ac_dC}${LD_SWITCH_X_SITE_AUX}\${ac_dD}
\${ac_uA}LD_SWITCH_X_SITE_AUX\${ac_uB}LD_SWITCH_X_SITE_AUX\${ac_uC}${LD_SWITCH_X_SITE_AUX}\${ac_uD}
\${ac_eA}LD_SWITCH_X_SITE_AUX\${ac_eB}LD_SWITCH_X_SITE_AUX\${ac_eC}${LD_SWITCH_X_SITE_AUX}\${ac_eD}
"
}


{
test -n "$verbose" && \
echo "	defining" C_SWITCH_X_SITE to be "${C_SWITCH_X_SITE}"
echo "#define" C_SWITCH_X_SITE "${C_SWITCH_X_SITE}" >> confdefs.h
DEFS="$DEFS -DC_SWITCH_X_SITE=${C_SWITCH_X_SITE}"
ac_sed_defs="${ac_sed_defs}\${ac_dA}C_SWITCH_X_SITE\${ac_dB}C_SWITCH_X_SITE\${ac_dC}${C_SWITCH_X_SITE}\${ac_dD}
\${ac_uA}C_SWITCH_X_SITE\${ac_uB}C_SWITCH_X_SITE\${ac_uC}${C_SWITCH_X_SITE}\${ac_uD}
\${ac_eA}C_SWITCH_X_SITE\${ac_eB}C_SWITCH_X_SITE\${ac_eC}${C_SWITCH_X_SITE}\${ac_eD}
"
}


{
test -n "$verbose" && \
echo "	defining" LD_SWITCH_SITE to be "${LD_SWITCH_SITE}"
echo "#define" LD_SWITCH_SITE "${LD_SWITCH_SITE}" >> confdefs.h
DEFS="$DEFS -DLD_SWITCH_SITE=${LD_SWITCH_SITE}"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LD_SWITCH_SITE\${ac_dB}LD_SWITCH_SITE\${ac_dC}${LD_SWITCH_SITE}\${ac_dD}
\${ac_uA}LD_SWITCH_SITE\${ac_uB}LD_SWITCH_SITE\${ac_uC}${LD_SWITCH_SITE}\${ac_uD}
\${ac_eA}LD_SWITCH_SITE\${ac_eB}LD_SWITCH_SITE\${ac_eC}${LD_SWITCH_SITE}\${ac_eD}
"
}


{
test -n "$verbose" && \
echo "	defining" C_SWITCH_SITE to be "${C_SWITCH_SITE}"
echo "#define" C_SWITCH_SITE "${C_SWITCH_SITE}" >> confdefs.h
DEFS="$DEFS -DC_SWITCH_SITE=${C_SWITCH_SITE}"
ac_sed_defs="${ac_sed_defs}\${ac_dA}C_SWITCH_SITE\${ac_dB}C_SWITCH_SITE\${ac_dC}${C_SWITCH_SITE}\${ac_dD}
\${ac_uA}C_SWITCH_SITE\${ac_uB}C_SWITCH_SITE\${ac_uC}${C_SWITCH_SITE}\${ac_uD}
\${ac_eA}C_SWITCH_SITE\${ac_eB}C_SWITCH_SITE\${ac_eC}${C_SWITCH_SITE}\${ac_eD}
"
}


{
test -n "$verbose" && \
echo "	defining" UNEXEC_SRC to be "${UNEXEC_SRC}"
echo "#define" UNEXEC_SRC "${UNEXEC_SRC}" >> confdefs.h
DEFS="$DEFS -DUNEXEC_SRC=${UNEXEC_SRC}"
ac_sed_defs="${ac_sed_defs}\${ac_dA}UNEXEC_SRC\${ac_dB}UNEXEC_SRC\${ac_dC}${UNEXEC_SRC}\${ac_dD}
\${ac_uA}UNEXEC_SRC\${ac_uB}UNEXEC_SRC\${ac_uC}${UNEXEC_SRC}\${ac_uD}
\${ac_eA}UNEXEC_SRC\${ac_eB}UNEXEC_SRC\${ac_eC}${UNEXEC_SRC}\${ac_eD}
"
}



test -n "${puresize}" && 
{
test -n "$verbose" && \
echo "	defining" PURESIZE to be "${puresize}"
echo "#define" PURESIZE "${puresize}" >> confdefs.h
DEFS="$DEFS -DPURESIZE=${puresize}"
ac_sed_defs="${ac_sed_defs}\${ac_dA}PURESIZE\${ac_dB}PURESIZE\${ac_dC}${puresize}\${ac_dD}
\${ac_uA}PURESIZE\${ac_uB}PURESIZE\${ac_uC}${puresize}\${ac_uD}
\${ac_eA}PURESIZE\${ac_eB}PURESIZE\${ac_eC}${puresize}\${ac_eD}
"
}

test "${HAVE_X_WINDOWS}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_X_WINDOWS"
echo "#define" HAVE_X_WINDOWS "1" >> confdefs.h
DEFS="$DEFS -DHAVE_X_WINDOWS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_X_WINDOWS\${ac_dB}HAVE_X_WINDOWS\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_X_WINDOWS\${ac_uB}HAVE_X_WINDOWS\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_X_WINDOWS\${ac_eB}HAVE_X_WINDOWS\${ac_eC}1\${ac_eD}
"
}

test "${HAVE_XFREE386}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_XFREE386"
echo "#define" HAVE_XFREE386 "1" >> confdefs.h
DEFS="$DEFS -DHAVE_XFREE386=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_XFREE386\${ac_dB}HAVE_XFREE386\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_XFREE386\${ac_uB}HAVE_XFREE386\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_XFREE386\${ac_eB}HAVE_XFREE386\${ac_eC}1\${ac_eD}
"
}


if test "${GNU_MALLOC}"  = yes; then 
{
test -n "$verbose" && \
echo "	defining GNU_MALLOC"
echo "#define" GNU_MALLOC "1" >> confdefs.h
DEFS="$DEFS -DGNU_MALLOC=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}GNU_MALLOC\${ac_dB}GNU_MALLOC\${ac_dC}1\${ac_dD}
\${ac_uA}GNU_MALLOC\${ac_uB}GNU_MALLOC\${ac_uC}1\${ac_uD}
\${ac_eA}GNU_MALLOC\${ac_eB}GNU_MALLOC\${ac_eC}1\${ac_eD}
"
}

elif test "${use_system_malloc}" = yes; then 
{
test -n "$verbose" && \
echo "	defining USE_SYSTEM_MALLOC"
echo "#define" USE_SYSTEM_MALLOC "1" >> confdefs.h
DEFS="$DEFS -DUSE_SYSTEM_MALLOC=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}USE_SYSTEM_MALLOC\${ac_dB}USE_SYSTEM_MALLOC\${ac_dC}1\${ac_dD}
\${ac_uA}USE_SYSTEM_MALLOC\${ac_uB}USE_SYSTEM_MALLOC\${ac_uC}1\${ac_uD}
\${ac_eA}USE_SYSTEM_MALLOC\${ac_eB}USE_SYSTEM_MALLOC\${ac_eC}1\${ac_eD}
"
}

fi
test "${rel_alloc}" = yes && 
{
test -n "$verbose" && \
echo "	defining REL_ALLOC"
echo "#define" REL_ALLOC "1" >> confdefs.h
DEFS="$DEFS -DREL_ALLOC=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}REL_ALLOC\${ac_dB}REL_ALLOC\${ac_dC}1\${ac_dD}
\${ac_uA}REL_ALLOC\${ac_uB}REL_ALLOC\${ac_uC}1\${ac_uD}
\${ac_eA}REL_ALLOC\${ac_eB}REL_ALLOC\${ac_eC}1\${ac_eD}
"
}

test "${LISP_FLOAT_TYPE}" = yes && 
{
test -n "$verbose" && \
echo "	defining LISP_FLOAT_TYPE"
echo "#define" LISP_FLOAT_TYPE "1" >> confdefs.h
DEFS="$DEFS -DLISP_FLOAT_TYPE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LISP_FLOAT_TYPE\${ac_dB}LISP_FLOAT_TYPE\${ac_dC}1\${ac_dD}
\${ac_uA}LISP_FLOAT_TYPE\${ac_uB}LISP_FLOAT_TYPE\${ac_uC}1\${ac_uD}
\${ac_eA}LISP_FLOAT_TYPE\${ac_eB}LISP_FLOAT_TYPE\${ac_eC}1\${ac_eD}
"
}

test "${with_motif}" = yes && 
{
test -n "$verbose" && \
echo "	defining LWLIB_USES_MOTIF"
echo "#define" LWLIB_USES_MOTIF "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_USES_MOTIF=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_USES_MOTIF\${ac_dB}LWLIB_USES_MOTIF\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_USES_MOTIF\${ac_uB}LWLIB_USES_MOTIF\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_USES_MOTIF\${ac_eB}LWLIB_USES_MOTIF\${ac_eC}1\${ac_eD}
"
}

test "${with_athena}" = yes && 
{
test -n "$verbose" && \
echo "	defining LWLIB_USES_ATHENA"
echo "#define" LWLIB_USES_ATHENA "1" >> confdefs.h
DEFS="$DEFS -DLWLIB_USES_ATHENA=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}LWLIB_USES_ATHENA\${ac_dB}LWLIB_USES_ATHENA\${ac_dC}1\${ac_dD}
\${ac_uA}LWLIB_USES_ATHENA\${ac_uB}LWLIB_USES_ATHENA\${ac_uC}1\${ac_uD}
\${ac_eA}LWLIB_USES_ATHENA\${ac_eB}LWLIB_USES_ATHENA\${ac_eC}1\${ac_eD}
"
}

test "${with_toolbars}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_TOOLBARS"
echo "#define" HAVE_TOOLBARS "1" >> confdefs.h
DEFS="$DEFS -DHAVE_TOOLBARS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_TOOLBARS\${ac_dB}HAVE_TOOLBARS\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_TOOLBARS\${ac_uB}HAVE_TOOLBARS\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_TOOLBARS\${ac_eB}HAVE_TOOLBARS\${ac_eC}1\${ac_eD}
"
}

test "${with_tty}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_TTY"
echo "#define" HAVE_TTY "1" >> confdefs.h
DEFS="$DEFS -DHAVE_TTY=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_TTY\${ac_dB}HAVE_TTY\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_TTY\${ac_uB}HAVE_TTY\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_TTY\${ac_eB}HAVE_TTY\${ac_eC}1\${ac_eD}
"
}

test "${with_tooltalk}" = yes && 
{
test -n "$verbose" && \
echo "	defining TOOLTALK"
echo "#define" TOOLTALK "1" >> confdefs.h
DEFS="$DEFS -DTOOLTALK=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}TOOLTALK\${ac_dB}TOOLTALK\${ac_dC}1\${ac_dD}
\${ac_uA}TOOLTALK\${ac_uB}TOOLTALK\${ac_uC}1\${ac_uD}
\${ac_eA}TOOLTALK\${ac_eB}TOOLTALK\${ac_eC}1\${ac_eD}
"
}

test "${with_i18n3}" = yes && 
{
test -n "$verbose" && \
echo "	defining I18N3"
echo "#define" I18N3 "1" >> confdefs.h
DEFS="$DEFS -DI18N3=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}I18N3\${ac_dB}I18N3\${ac_dC}1\${ac_dD}
\${ac_uA}I18N3\${ac_uB}I18N3\${ac_uC}1\${ac_uD}
\${ac_eA}I18N3\${ac_eB}I18N3\${ac_eC}1\${ac_eD}
"
}

test "${with_mule}" = yes && 
{
test -n "$verbose" && \
echo "	defining MULE"
echo "#define" MULE "1" >> confdefs.h
DEFS="$DEFS -DMULE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}MULE\${ac_dB}MULE\${ac_dC}1\${ac_dD}
\${ac_uA}MULE\${ac_uB}MULE\${ac_uC}1\${ac_uD}
\${ac_eA}MULE\${ac_eB}MULE\${ac_eC}1\${ac_eD}
"
}

test "${with_canna}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_CANNA"
echo "#define" HAVE_CANNA "1" >> confdefs.h
DEFS="$DEFS -DHAVE_CANNA=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_CANNA\${ac_dB}HAVE_CANNA\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_CANNA\${ac_uB}HAVE_CANNA\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_CANNA\${ac_eB}HAVE_CANNA\${ac_eC}1\${ac_eD}
"
}

test "${with_wnn}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_WNN"
echo "#define" HAVE_WNN "1" >> confdefs.h
DEFS="$DEFS -DHAVE_WNN=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_WNN\${ac_dB}HAVE_WNN\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_WNN\${ac_uB}HAVE_WNN\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_WNN\${ac_eB}HAVE_WNN\${ac_eC}1\${ac_eD}
"
}

test "${with_mock}" = yes && 
{
test -n "$verbose" && \
echo "	defining MOCKLISP_SUPPORT"
echo "#define" MOCKLISP_SUPPORT "1" >> confdefs.h
DEFS="$DEFS -DMOCKLISP_SUPPORT=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}MOCKLISP_SUPPORT\${ac_dB}MOCKLISP_SUPPORT\${ac_dC}1\${ac_dD}
\${ac_uA}MOCKLISP_SUPPORT\${ac_uB}MOCKLISP_SUPPORT\${ac_uC}1\${ac_uD}
\${ac_eA}MOCKLISP_SUPPORT\${ac_eB}MOCKLISP_SUPPORT\${ac_eC}1\${ac_eD}
"
}

test "${with_sparcworks}" = yes && 
{
test -n "$verbose" && \
echo "	defining SUNPRO"
echo "#define" SUNPRO "1" >> confdefs.h
DEFS="$DEFS -DSUNPRO=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}SUNPRO\${ac_dB}SUNPRO\${ac_dC}1\${ac_dD}
\${ac_uA}SUNPRO\${ac_uB}SUNPRO\${ac_uC}1\${ac_uD}
\${ac_eA}SUNPRO\${ac_eB}SUNPRO\${ac_eC}1\${ac_eD}
"
}

test "${usage_tracking}" = yes && 
{
test -n "$verbose" && \
echo "	defining USAGE_TRACKING"
echo "#define" USAGE_TRACKING "1" >> confdefs.h
DEFS="$DEFS -DUSAGE_TRACKING=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}USAGE_TRACKING\${ac_dB}USAGE_TRACKING\${ac_dC}1\${ac_dD}
\${ac_uA}USAGE_TRACKING\${ac_uB}USAGE_TRACKING\${ac_uC}1\${ac_uD}
\${ac_eA}USAGE_TRACKING\${ac_eB}USAGE_TRACKING\${ac_eC}1\${ac_eD}
"
}

test "${need_dynodump}" = yes && 
{
test -n "$verbose" && \
echo "	defining DYNODUMP"
echo "#define" DYNODUMP "1" >> confdefs.h
DEFS="$DEFS -DDYNODUMP=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}DYNODUMP\${ac_dB}DYNODUMP\${ac_dC}1\${ac_dD}
\${ac_uA}DYNODUMP\${ac_uB}DYNODUMP\${ac_uC}1\${ac_uD}
\${ac_eA}DYNODUMP\${ac_eB}DYNODUMP\${ac_eC}1\${ac_eD}
"
}

test "${need_xildoff}" = yes && 
{
test -n "$verbose" && \
echo "	defining NEED_XILDOFF"
echo "#define" NEED_XILDOFF "1" >> confdefs.h
DEFS="$DEFS -DNEED_XILDOFF=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}NEED_XILDOFF\${ac_dB}NEED_XILDOFF\${ac_dC}1\${ac_dD}
\${ac_uA}NEED_XILDOFF\${ac_uB}NEED_XILDOFF\${ac_uC}1\${ac_uD}
\${ac_eA}NEED_XILDOFF\${ac_eB}NEED_XILDOFF\${ac_eC}1\${ac_eD}
"
}

test "${with_gcc}" = yes && 
{
test -n "$verbose" && \
echo "	defining USE_GCC"
echo "#define" USE_GCC "1" >> confdefs.h
DEFS="$DEFS -DUSE_GCC=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}USE_GCC\${ac_dB}USE_GCC\${ac_dC}1\${ac_dD}
\${ac_uA}USE_GCC\${ac_uB}USE_GCC\${ac_uC}1\${ac_uD}
\${ac_eA}USE_GCC\${ac_eB}USE_GCC\${ac_eC}1\${ac_eD}
"
}

test "${with_lcc}" = yes && 
{
test -n "$verbose" && \
echo "	defining USE_LCC"
echo "#define" USE_LCC "1" >> confdefs.h
DEFS="$DEFS -DUSE_LCC=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}USE_LCC\${ac_dB}USE_LCC\${ac_dC}1\${ac_dD}
\${ac_uA}USE_LCC\${ac_uB}USE_LCC\${ac_uC}1\${ac_uD}
\${ac_eA}USE_LCC\${ac_eB}USE_LCC\${ac_eC}1\${ac_eD}
"
}

test "${with_socks}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_SOCKS"
echo "#define" HAVE_SOCKS "1" >> confdefs.h
DEFS="$DEFS -DHAVE_SOCKS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_SOCKS\${ac_dB}HAVE_SOCKS\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_SOCKS\${ac_uB}HAVE_SOCKS\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_SOCKS\${ac_eB}HAVE_SOCKS\${ac_eC}1\${ac_eD}
"
}

test "${with_term}" = yes && 
{
test -n "$verbose" && \
echo "	defining HAVE_TERM"
echo "#define" HAVE_TERM "1" >> confdefs.h
DEFS="$DEFS -DHAVE_TERM=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_TERM\${ac_dB}HAVE_TERM\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_TERM\${ac_uB}HAVE_TERM\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_TERM\${ac_eB}HAVE_TERM\${ac_eC}1\${ac_eD}
"
}

test "${with_epoch}" = yes && 
{
test -n "$verbose" && \
echo "	defining EPOCH"
echo "#define" EPOCH "1" >> confdefs.h
DEFS="$DEFS -DEPOCH=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}EPOCH\${ac_dB}EPOCH\${ac_dC}1\${ac_dD}
\${ac_uA}EPOCH\${ac_uB}EPOCH\${ac_uC}1\${ac_uD}
\${ac_eA}EPOCH\${ac_eB}EPOCH\${ac_eC}1\${ac_eD}
"
}

test "${external_widget}" = yes && 
{
test -n "$verbose" && \
echo "	defining EXTERNAL_WIDGET"
echo "#define" EXTERNAL_WIDGET "1" >> confdefs.h
DEFS="$DEFS -DEXTERNAL_WIDGET=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}EXTERNAL_WIDGET\${ac_dB}EXTERNAL_WIDGET\${ac_dC}1\${ac_dD}
\${ac_uA}EXTERNAL_WIDGET\${ac_uB}EXTERNAL_WIDGET\${ac_uC}1\${ac_uD}
\${ac_eA}EXTERNAL_WIDGET\${ac_eB}EXTERNAL_WIDGET\${ac_eC}1\${ac_eD}
"
}

test "${with_gnu_make}" = yes && 
{
test -n "$verbose" && \
echo "	defining USE_GNU_MAKE"
echo "#define" USE_GNU_MAKE "1" >> confdefs.h
DEFS="$DEFS -DUSE_GNU_MAKE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}USE_GNU_MAKE\${ac_dB}USE_GNU_MAKE\${ac_dC}1\${ac_dD}
\${ac_uA}USE_GNU_MAKE\${ac_uB}USE_GNU_MAKE\${ac_uC}1\${ac_uD}
\${ac_eA}USE_GNU_MAKE\${ac_eB}USE_GNU_MAKE\${ac_eC}1\${ac_eD}
"
}

test "${no_doc_file}" = yes && 
{
test -n "$verbose" && \
echo "	defining NO_DOC_FILE"
echo "#define" NO_DOC_FILE "1" >> confdefs.h
DEFS="$DEFS -DNO_DOC_FILE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}NO_DOC_FILE\${ac_dB}NO_DOC_FILE\${ac_dC}1\${ac_dD}
\${ac_uA}NO_DOC_FILE\${ac_uB}NO_DOC_FILE\${ac_uC}1\${ac_uD}
\${ac_eA}NO_DOC_FILE\${ac_eB}NO_DOC_FILE\${ac_eC}1\${ac_eD}
"
}

test "${const_is_losing}" = yes && 
{
test -n "$verbose" && \
echo "	defining CONST_IS_LOSING"
echo "#define" CONST_IS_LOSING "1" >> confdefs.h
DEFS="$DEFS -DCONST_IS_LOSING=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}CONST_IS_LOSING\${ac_dB}CONST_IS_LOSING\${ac_dC}1\${ac_dD}
\${ac_uA}CONST_IS_LOSING\${ac_uB}CONST_IS_LOSING\${ac_uC}1\${ac_uD}
\${ac_eA}CONST_IS_LOSING\${ac_eB}CONST_IS_LOSING\${ac_eC}1\${ac_eD}
"
}

test "${use_assertions}" = yes && 
{
test -n "$verbose" && \
echo "	defining USE_ASSERTIONS"
echo "#define" USE_ASSERTIONS "1" >> confdefs.h
DEFS="$DEFS -DUSE_ASSERTIONS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}USE_ASSERTIONS\${ac_dB}USE_ASSERTIONS\${ac_dC}1\${ac_dD}
\${ac_uA}USE_ASSERTIONS\${ac_uB}USE_ASSERTIONS\${ac_uC}1\${ac_uD}
\${ac_eA}USE_ASSERTIONS\${ac_eB}USE_ASSERTIONS\${ac_eC}1\${ac_eD}
"
}

test "${debug}" = yes && 
{
test -n "$verbose" && \
echo "	defining DEBUG_XEMACS"
echo "#define" DEBUG_XEMACS "1" >> confdefs.h
DEFS="$DEFS -DDEBUG_XEMACS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}DEBUG_XEMACS\${ac_dB}DEBUG_XEMACS\${ac_dC}1\${ac_dD}
\${ac_uA}DEBUG_XEMACS\${ac_uB}DEBUG_XEMACS\${ac_uC}1\${ac_uD}
\${ac_eA}DEBUG_XEMACS\${ac_eB}DEBUG_XEMACS\${ac_eC}1\${ac_eD}
"
}

test "${quantify}" = yes && 
{
test -n "$verbose" && \
echo "	defining QUANTIFY"
echo "#define" QUANTIFY "1" >> confdefs.h
DEFS="$DEFS -DQUANTIFY=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}QUANTIFY\${ac_dB}QUANTIFY\${ac_dC}1\${ac_dD}
\${ac_uA}QUANTIFY\${ac_uB}QUANTIFY\${ac_uC}1\${ac_uD}
\${ac_eA}QUANTIFY\${ac_eB}QUANTIFY\${ac_eC}1\${ac_eD}
"
}

test "${memory_usage_stats}" = yes && 
{
test -n "$verbose" && \
echo "	defining MEMORY_USAGE_STATS"
echo "#define" MEMORY_USAGE_STATS "1" >> confdefs.h
DEFS="$DEFS -DMEMORY_USAGE_STATS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}MEMORY_USAGE_STATS\${ac_dB}MEMORY_USAGE_STATS\${ac_dC}1\${ac_dD}
\${ac_uA}MEMORY_USAGE_STATS\${ac_uB}MEMORY_USAGE_STATS\${ac_uC}1\${ac_uD}
\${ac_eA}MEMORY_USAGE_STATS\${ac_eB}MEMORY_USAGE_STATS\${ac_eC}1\${ac_eD}
"
}


test "${error_check_extents}" = yes && 
{
test -n "$verbose" && \
echo "	defining ERROR_CHECK_EXTENTS"
echo "#define" ERROR_CHECK_EXTENTS "1" >> confdefs.h
DEFS="$DEFS -DERROR_CHECK_EXTENTS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}ERROR_CHECK_EXTENTS\${ac_dB}ERROR_CHECK_EXTENTS\${ac_dC}1\${ac_dD}
\${ac_uA}ERROR_CHECK_EXTENTS\${ac_uB}ERROR_CHECK_EXTENTS\${ac_uC}1\${ac_uD}
\${ac_eA}ERROR_CHECK_EXTENTS\${ac_eB}ERROR_CHECK_EXTENTS\${ac_eC}1\${ac_eD}
"
}

test "${error_check_typecheck}" = yes && 
{
test -n "$verbose" && \
echo "	defining ERROR_CHECK_TYPECHECK"
echo "#define" ERROR_CHECK_TYPECHECK "1" >> confdefs.h
DEFS="$DEFS -DERROR_CHECK_TYPECHECK=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}ERROR_CHECK_TYPECHECK\${ac_dB}ERROR_CHECK_TYPECHECK\${ac_dC}1\${ac_dD}
\${ac_uA}ERROR_CHECK_TYPECHECK\${ac_uB}ERROR_CHECK_TYPECHECK\${ac_uC}1\${ac_uD}
\${ac_eA}ERROR_CHECK_TYPECHECK\${ac_eB}ERROR_CHECK_TYPECHECK\${ac_eC}1\${ac_eD}
"
}

test "${error_check_bufpos}" = yes && 
{
test -n "$verbose" && \
echo "	defining ERROR_CHECK_BUFPOS"
echo "#define" ERROR_CHECK_BUFPOS "1" >> confdefs.h
DEFS="$DEFS -DERROR_CHECK_BUFPOS=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}ERROR_CHECK_BUFPOS\${ac_dB}ERROR_CHECK_BUFPOS\${ac_dC}1\${ac_dD}
\${ac_uA}ERROR_CHECK_BUFPOS\${ac_uB}ERROR_CHECK_BUFPOS\${ac_uC}1\${ac_uD}
\${ac_eA}ERROR_CHECK_BUFPOS\${ac_eB}ERROR_CHECK_BUFPOS\${ac_eC}1\${ac_eD}
"
}

test "${error_check_gc}" = yes && 
{
test -n "$verbose" && \
echo "	defining ERROR_CHECK_GC"
echo "#define" ERROR_CHECK_GC "1" >> confdefs.h
DEFS="$DEFS -DERROR_CHECK_GC=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}ERROR_CHECK_GC\${ac_dB}ERROR_CHECK_GC\${ac_dC}1\${ac_dD}
\${ac_uA}ERROR_CHECK_GC\${ac_uB}ERROR_CHECK_GC\${ac_uC}1\${ac_uD}
\${ac_eA}ERROR_CHECK_GC\${ac_eB}ERROR_CHECK_GC\${ac_eC}1\${ac_eD}
"
}

test "${error_check_malloc}" = yes && 
{
test -n "$verbose" && \
echo "	defining ERROR_CHECK_MALLOC"
echo "#define" ERROR_CHECK_MALLOC "1" >> confdefs.h
DEFS="$DEFS -DERROR_CHECK_MALLOC=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}ERROR_CHECK_MALLOC\${ac_dB}ERROR_CHECK_MALLOC\${ac_dC}1\${ac_dD}
\${ac_uA}ERROR_CHECK_MALLOC\${ac_uB}ERROR_CHECK_MALLOC\${ac_uC}1\${ac_uD}
\${ac_eA}ERROR_CHECK_MALLOC\${ac_eB}ERROR_CHECK_MALLOC\${ac_eC}1\${ac_eD}
"
}


if test "${with_energize}" = yes; then
  
{
test -n "$verbose" && \
echo "	defining ENERGIZE"
echo "#define" ENERGIZE "1" >> confdefs.h
DEFS="$DEFS -DENERGIZE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}ENERGIZE\${ac_dB}ENERGIZE\${ac_dC}1\${ac_dD}
\${ac_uA}ENERGIZE\${ac_uB}ENERGIZE\${ac_uC}1\${ac_uD}
\${ac_eA}ENERGIZE\${ac_eB}ENERGIZE\${ac_eC}1\${ac_eD}
"
}

  test "${energize_version}" = "2.X" && 
{
test -n "$verbose" && \
echo "	defining ENERGIZE_2"
echo "#define" ENERGIZE_2 "1" >> confdefs.h
DEFS="$DEFS -DENERGIZE_2=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}ENERGIZE_2\${ac_dB}ENERGIZE_2\${ac_dC}1\${ac_dD}
\${ac_uA}ENERGIZE_2\${ac_uB}ENERGIZE_2\${ac_uC}1\${ac_uD}
\${ac_eA}ENERGIZE_2\${ac_eB}ENERGIZE_2\${ac_eC}1\${ac_eD}
"
}

  test "${energize_version}" = "3.X" && 
{
test -n "$verbose" && \
echo "	defining ENERGIZE_3"
echo "#define" ENERGIZE_3 "1" >> confdefs.h
DEFS="$DEFS -DENERGIZE_3=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}ENERGIZE_3\${ac_dB}ENERGIZE_3\${ac_dC}1\${ac_dD}
\${ac_uA}ENERGIZE_3\${ac_uB}ENERGIZE_3\${ac_uC}1\${ac_uD}
\${ac_eA}ENERGIZE_3\${ac_eB}ENERGIZE_3\${ac_eC}1\${ac_eD}
"
}

fi

test "${with_sound}" = "native" -o "${with_sound}" = "both" && 
{
test -n "$verbose" && \
echo "	defining HAVE_NATIVE_SOUND"
echo "#define" HAVE_NATIVE_SOUND "1" >> confdefs.h
DEFS="$DEFS -DHAVE_NATIVE_SOUND=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_NATIVE_SOUND\${ac_dB}HAVE_NATIVE_SOUND\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_NATIVE_SOUND\${ac_uB}HAVE_NATIVE_SOUND\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_NATIVE_SOUND\${ac_eB}HAVE_NATIVE_SOUND\${ac_eC}1\${ac_eD}
"
}

test "${with_sound}" = "nas"    -o "${with_sound}" = "both" && 
{
test -n "$verbose" && \
echo "	defining HAVE_NAS_SOUND"
echo "#define" HAVE_NAS_SOUND "1" >> confdefs.h
DEFS="$DEFS -DHAVE_NAS_SOUND=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}HAVE_NAS_SOUND\${ac_dB}HAVE_NAS_SOUND\${ac_dC}1\${ac_dD}
\${ac_uA}HAVE_NAS_SOUND\${ac_uB}HAVE_NAS_SOUND\${ac_uC}1\${ac_uD}
\${ac_eA}HAVE_NAS_SOUND\${ac_eB}HAVE_NAS_SOUND\${ac_eC}1\${ac_eD}
"
}

test "${old_nas}"    = "true" && 
{
test -n "$verbose" && \
echo "	defining NAS_NO_ERROR_JUMP"
echo "#define" NAS_NO_ERROR_JUMP "1" >> confdefs.h
DEFS="$DEFS -DNAS_NO_ERROR_JUMP=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}NAS_NO_ERROR_JUMP\${ac_dB}NAS_NO_ERROR_JUMP\${ac_dC}1\${ac_dD}
\${ac_uA}NAS_NO_ERROR_JUMP\${ac_uB}NAS_NO_ERROR_JUMP\${ac_uC}1\${ac_uD}
\${ac_eA}NAS_NO_ERROR_JUMP\${ac_eB}NAS_NO_ERROR_JUMP\${ac_eC}1\${ac_eD}
"
}


test "${use_union_type}"    != yes && 
{
test -n "$verbose" && \
echo "	defining NO_UNION_TYPE"
echo "#define" NO_UNION_TYPE "1" >> confdefs.h
DEFS="$DEFS -DNO_UNION_TYPE=1"
ac_sed_defs="${ac_sed_defs}\${ac_dA}NO_UNION_TYPE\${ac_dB}NO_UNION_TYPE\${ac_dC}1\${ac_dD}
\${ac_uA}NO_UNION_TYPE\${ac_uB}NO_UNION_TYPE\${ac_uC}1\${ac_uD}
\${ac_eA}NO_UNION_TYPE\${ac_eB}NO_UNION_TYPE\${ac_eC}1\${ac_eD}
"
}



echo "

Configured for \`${canonical}'.

  Where should the build process find the source code?    ${srcdir}
  What installation prefix should install use?		  ${prefix}
  What operating system and machine description files should XEmacs use?
        \`${opsysfile}' and \`${machfile}'
  What compiler should XEmacs be built with?              ${CC} ${CFLAGS}
  Should XEmacs use the GNU version of malloc?            ${GNU_MALLOC}${GNU_MALLOC_reason}
  Should XEmacs use the relocating allocator for buffers? ${rel_alloc}
  What window system should XEmacs use?                   ${window_system}${x_includes+
  Where do we find X Windows header files?                }${x_includes}${x_libraries+
  Where do we find X Windows libraries?                   }${x_libraries}"

if test -n "$site_includes"; then
  echo "  Additional header files:                                ${site_includes}"
fi

if test -n "$site_libraries" -a -n "$site_runtime_libraries"; then
  echo "  Additional libraries:                                   ${site_libraries} ${site_runtime_libraries}"
elif test -n "$site_libraries"; then
  echo "  Additional libraries:                                   ${site_libraries}"
elif test -n "$site_runtime_libraries"; then
  echo "  Additional libraries:                                   ${site_runtime_libraries}"
fi

test "$with_socks" = yes && echo "  Compiling in support for SOCKS."
test "$with_term"  = yes && echo "  Compiling in support for TERM."
test "$with_xauth" = yes && echo "  Compiling in support for XAUTH."
test "$with_xpm"   = yes && echo "  Compiling in support for XPM."
if test "$with_xmu" != yes -a "$window_system" != none; then
  echo "  No Xmu; substituting equivalent routines."
fi
test "$with_xface" = yes && echo "  Compiling in support for X-Face headers."
test "$with_gif"   = yes && echo "  Compiling in support for GIF image conversion."
test "$with_jpeg"  = yes && echo "  Compiling in support for JPEG image conversion."
if test "$with_png"   = yes -o "$with_png" = gnuz; then
  echo "  Compiling in support for PNG image conversion."
fi
if test "$with_png" = gnuz; then
  echo "  (Using -lgz instead of -lz.)"
fi
test "$with_tiff"  = yes && echo "  Compiling in support for TIFF image conversion (not implemented)."
test "$with_epoch" = yes && echo "  Compiling in extra Epoch compatibility."

test "$with_sound" = nas    && echo "  Compiling in network sound support."
test "$with_sound" = native && echo "  Compiling in native sound support."
test "$with_sound" = both   && echo "  Compiling in both network and native sound support."
test "$old_nas"    = true   && echo "        nas library lacks error trapping, will play synchronously"

test "$with_database_berkdb" = yes && echo "  Compiling in support for Berkeley DB."
test "$with_database_dbm"    = yes && echo "  Compiling in support for DBM."
test "$with_database_gnudbm" = yes && echo "  Compiling in support for GNU DBM."

test "$with_ncurses"  = yes && echo "  Compiling in support for ncurses."
test "$with_socks"    = yes && echo "  Compiling in support for SOCKS."
test "$with_tooltalk" = yes && echo "  Compiling in support for ToolTalk."

test "$with_mule"     = yes && echo "  Compiling in Mule (multi-lingual) support."
test "$with_xim"      != no && echo "  Compiling in XIM (X11R5+ I18N input method) support."
test "$with_xim" = motif    && echo "    Using Motif to provide XIM support."
test "$with_xim" = xlib     && echo "    Using raw Xlib to provide XIM support."
test "$with_canna"    = yes && echo "  Compiling in support for Canna on Mule."
test "$with_wnn"      = yes && echo "  Compiling in support for WNN on Mule (doesn't currently work)."
test "$with_i18n3"    = yes && echo "  Compiling in I18N support, level 3 (doesn't currently work)."

test "$with_cde"      = yes && echo "  Compiling in support for CDE."
test "$with_offix"    = yes && echo "  Compiling in support for OffiX."
test "$with_mocklisp" = yes && echo "  Compiling in support for Mocklisp."
test "$with_sparcworks" = yes && echo "  Compiling in support for SparcWorks."
test "$with_energize" = yes && echo "  Compiling in support for Lucid Energize (doesn't currently work)."
test "$with_menubars" = "lucid" && echo "  Using the Lucid menubar."
if test "$with_menubars" = "motif"; then
  echo "  Using the Motif menubar."
  echo " *WARNING*  The Motif menubar is currently buggy.  We recommend"
  echo "            that you use the Lucid menubar instead.  Re-run"
  echo "            configure with --with-menubars='lucid'."
fi
test "$with_scrollbars" = lucid  && echo "  Using the Lucid scrollbar."
test "$with_scrollbars" = motif  && echo "  Using the Motif scrollbar."
test "$with_scrollbars" = athena && echo "  Using the Athena scrollbar."
test "$with_scrollbars" = athena3d && echo "  Using the Athena-3d scrollbar."
test "$with_dialogs"    = motif  && echo "  Using the Motif dialog boxes."
test "$with_dialogs"    = athena && echo "  Using the Athena dialog boxes."
test "$with_dialogs"    = athena3d && echo "  Using the Athena-3d dialog boxes."

test "${use_union_type}"     = yes && echo "  Using the union type for Lisp_Objects."
test "${debug}"              = yes && echo "  Compiling in extra code for debugging."
test "${memory_usage_stats}" = yes && echo "  Compiling in code for checking XEmacs memory usage."
test "$usage_tracking"       = yes && echo "  Compiling with usage tracking active (Sun internal)."
echo "
"


 
# Remove any trailing slashes in these variables.
test -n "${prefix}" &&
  prefix=`echo "${prefix}" | sed 's,\([^/]\)/*$,\1,'`
test -n "${exec_prefix}" &&
  exec_prefix=`echo "${exec_prefix}" | sed 's,\([^/]\)/*$,\1,'`


# The preferred way to propogate these variables is regular @ substitutions.
if test -n "$prefix"; then
  ac_prsub="s%^prefix\\([ 	]*\\)=\\([ 	]*\\).*$%prefix\\1=\\2$prefix%"
else
  prefix=/usr/local
fi
if test -n "$exec_prefix"; then
  ac_prsub="$ac_prsub
s%^exec_prefix\\([ 	]*\\)=\\([ 	]*\\).*$%exec_prefix\\1=\\2$exec_prefix%"
else
  exec_prefix='${prefix}' # Let make expand it.
fi

# Any assignment to VPATH causes Sun make to only execute
# the first set of double-colon rules, so remove it if not needed.
# If there is a colon in the path, we need to keep it.
if test "x$srcdir" = x.; then
  ac_vpsub='/^[ 	]*VPATH[ 	]*=[^:]*$/d'
fi

# Quote sed substitution magic chars in DEFS.
cat >conftest.def <<EOF
$DEFS
EOF
ac_escape_ampersand_and_backslash='s%[&\\]%\\&%g'
DEFS=`sed "$ac_escape_ampersand_and_backslash" <conftest.def`
rm -f conftest.def
# Substitute for predefined variables.

trap 'rm -f config.status; exit 1' 1 2 15
echo creating config.status
rm -f config.status
cat > config.status <<EOF
#!/bin/sh
# Generated automatically by configure.
# Run this file to recreate the current configuration.
# This directory was configured as follows,
# on host `(hostname || uname -n) 2>/dev/null | sed 1q`:
#
# $0 $configure_args

ac_cs_usage="Usage: config.status [--recheck] [--version] [--help]"
for ac_option
do
  case "\$ac_option" in
  -recheck | --recheck | --rechec | --reche | --rech | --rec | --re | --r)
    echo running \${CONFIG_SHELL-/bin/sh} $0 $configure_args --no-create
    exec \${CONFIG_SHELL-/bin/sh} $0 $configure_args --no-create ;;
  -version | --version | --versio | --versi | --vers | --ver | --ve | --v)
    echo "config.status generated by autoconf version 1.11"
    exit 0 ;;
  -help | --help | --hel | --he | --h)
    echo "\$ac_cs_usage"; exit 0 ;;
  *) echo "\$ac_cs_usage"; exit 1 ;;
  esac
done

trap 'rm -fr $internal_makefile_list src/config.h conftest*; exit 1' 1 2 15
LN_S='$LN_S'
CC='$CC'
CPP='$CPP'
RANLIB='$RANLIB'
INSTALL='$INSTALL'
INSTALL_PROGRAM='$INSTALL_PROGRAM'
INSTALL_DATA='$INSTALL_DATA'
YACC='$YACC'
SET_MAKE='$SET_MAKE'
ALLOCA='$ALLOCA'
version='$version'
configuration='$configuration'
canonical='$canonical'
srcdir='$srcdir'
prefix='$prefix'
exec_prefix='$exec_prefix'
bindir='$bindir'
datadir='$datadir'
statedir='$statedir'
libdir='$libdir'
mandir='$mandir'
infodir='$infodir'
infodir_user_defined='$infodir_user_defined'
lispdir='$lispdir'
lispdir_user_defined='$lispdir_user_defined'
sitelispdir='$sitelispdir'
etcdir='$etcdir'
etcdir_user_defined='$etcdir_user_defined'
lockdir='$lockdir'
lockdir_user_defined='$lockdir_user_defined'
archlibdir='$archlibdir'
archlibdir_user_defined='$archlibdir_user_defined'
docdir='$docdir'
bitmapdir='$bitmapdir'
c_switch_system='$c_switch_system'
c_switch_machine='$c_switch_machine'
libsrc_libs='$libsrc_libs'
LD_SWITCH_X_SITE='$LD_SWITCH_X_SITE'
LD_SWITCH_X_SITE_AUX='$LD_SWITCH_X_SITE_AUX'
C_SWITCH_X_SITE='$C_SWITCH_X_SITE'
LD_SWITCH_SITE='$LD_SWITCH_SITE'
C_SWITCH_SITE='$C_SWITCH_SITE'
CFLAGS='$CFLAGS'
native_sound_lib='$native_sound_lib'
machfile='$machfile'
opsysfile='$opsysfile'
dynodump_arch='$dynodump_arch'
internal_makefile_list='$internal_makefile_list'
LIBS='$LIBS'
top_srcdir='$top_srcdir'
ac_prsub='$ac_prsub'
ac_vpsub='$ac_vpsub'
extrasub='$extrasub'
EOF
cat >> config.status <<\EOF

ac_given_srcdir=$srcdir

CONFIG_FILES=${CONFIG_FILES-"$internal_makefile_list"}
for ac_file in .. ${CONFIG_FILES}; do if test "x$ac_file" != x..; then
  # Remove last slash and all that follows it.  Not all systems have dirname.
  ac_dir=`echo $ac_file|sed 's%/[^/][^/]*$%%'`
  if test "$ac_dir" != "$ac_file" && test "$ac_dir" != .; then
    # The file is in a subdirectory.
    test ! -d "$ac_dir" && mkdir "$ac_dir"
    ac_dir_suffix="/$ac_dir"
  else
    ac_dir_suffix=
  fi

  # A "../" for each directory in $ac_dir_suffix.
  ac_dots=`echo $ac_dir_suffix|sed 's%/[^/]*%../%g'`
  case "$ac_given_srcdir" in
  .)  srcdir=.
      if test -z "$ac_dir_suffix"; then top_srcdir=.
      else top_srcdir=`echo $ac_dots|sed 's%/$%%'`; fi ;;
  /*) srcdir="$ac_given_srcdir$ac_dir_suffix"; top_srcdir="$ac_given_srcdir" ;;
  *) # Relative path.
    srcdir="$ac_dots$ac_given_srcdir$ac_dir_suffix"
    top_srcdir="$ac_dots$ac_given_srcdir" ;;
  esac

  echo creating "$ac_file"
  rm -f "$ac_file"
  comment_str="Generated automatically from `echo $ac_file|sed 's|.*/||'`.in by configure."
  case "$ac_file" in
    *.c | *.h | *.C | *.cc | *.m )  echo "/* $comment_str */" > "$ac_file" ;;
    * )          echo "# $comment_str"     > "$ac_file" ;;
  esac
  sed -e "
$ac_prsub
$ac_vpsub
$extrasub
s%@LN_S@%$LN_S%g
s%@CC@%$CC%g
s%@CPP@%$CPP%g
s%@RANLIB@%$RANLIB%g
s%@INSTALL@%$INSTALL%g
s%@INSTALL_PROGRAM@%$INSTALL_PROGRAM%g
s%@INSTALL_DATA@%$INSTALL_DATA%g
s%@YACC@%$YACC%g
s%@SET_MAKE@%$SET_MAKE%g
s%@ALLOCA@%$ALLOCA%g
s%@version@%$version%g
s%@configuration@%$configuration%g
s%@canonical@%$canonical%g
s%@srcdir@%$srcdir%g
s%@prefix@%$prefix%g
s%@exec_prefix@%$exec_prefix%g
s%@bindir@%$bindir%g
s%@datadir@%$datadir%g
s%@statedir@%$statedir%g
s%@libdir@%$libdir%g
s%@mandir@%$mandir%g
s%@infodir@%$infodir%g
s%@infodir_user_defined@%$infodir_user_defined%g
s%@lispdir@%$lispdir%g
s%@lispdir_user_defined@%$lispdir_user_defined%g
s%@sitelispdir@%$sitelispdir%g
s%@etcdir@%$etcdir%g
s%@etcdir_user_defined@%$etcdir_user_defined%g
s%@lockdir@%$lockdir%g
s%@lockdir_user_defined@%$lockdir_user_defined%g
s%@archlibdir@%$archlibdir%g
s%@archlibdir_user_defined@%$archlibdir_user_defined%g
s%@docdir@%$docdir%g
s%@bitmapdir@%$bitmapdir%g
s%@c_switch_system@%$c_switch_system%g
s%@c_switch_machine@%$c_switch_machine%g
s%@libsrc_libs@%$libsrc_libs%g
s%@LD_SWITCH_X_SITE@%$LD_SWITCH_X_SITE%g
s%@LD_SWITCH_X_SITE_AUX@%$LD_SWITCH_X_SITE_AUX%g
s%@C_SWITCH_X_SITE@%$C_SWITCH_X_SITE%g
s%@LD_SWITCH_SITE@%$LD_SWITCH_SITE%g
s%@C_SWITCH_SITE@%$C_SWITCH_SITE%g
s%@CFLAGS@%$CFLAGS%g
s%@native_sound_lib@%$native_sound_lib%g
s%@machfile@%$machfile%g
s%@opsysfile@%$opsysfile%g
s%@dynodump_arch@%$dynodump_arch%g
s%@internal_makefile_list@%$internal_makefile_list%g
s%@LIBS@%$LIBS%g
s%@top_srcdir@%$top_srcdir%g
s%@DEFS@%-DHAVE_CONFIG_H%" $ac_given_srcdir/${ac_file}.in >> $ac_file
fi; done

# These sed commands are put into ac_sed_defs when defining a macro.
# They are broken into pieces to make the sed script easier to manage.
# They are passed to sed as "A NAME B NAME C VALUE D", where NAME
# is the cpp macro being defined and VALUE is the value it is being given.
# Each defining turns into a single global substitution command.
# Hopefully no one uses "!" as a variable value.
# Other candidates for the sed separators, like , and @, do get used.
#
# ac_d sets the value in "#define NAME VALUE" lines.
ac_dA='s!^\([ 	]*\)#\([ 	]*define[ 	][ 	]*\)'
ac_dB='\([ 	][ 	]*\)[^ 	]*!\1#\2'
ac_dC='\3'
ac_dD='!g'
# ac_u turns "#undef NAME" with trailing blanks into "#define NAME VALUE".
ac_uA='s!^\([ 	]*\)#\([ 	]*\)undef\([ 	][ 	]*\)'
ac_uB='\([ 	]\)!\1#\2define\3'
ac_uC=' '
ac_uD='\4!g'
# ac_e turns "#undef NAME" without trailing blanks into "#define NAME VALUE".
ac_eA='s!^\([ 	]*\)#\([ 	]*\)undef\([ 	][ 	]*\)'
ac_eB='$!\1#\2define\3'
ac_eC=' '
ac_eD='!g'
rm -f conftest.sed
EOF
# Turn off quoting long enough to insert the sed commands.
rm -f conftest.sh
cat > conftest.sh <<EOF
$ac_sed_defs
EOF

# Break up $ac_sed_defs (now in conftest.sh) because some shells have a limit
# on the size of here documents.

# Maximum number of lines to put in a single here document.
ac_max_sh_lines=9

while :
do
  # wc gives bogus results for an empty file on some AIX systems.
  ac_lines=`grep -c . conftest.sh`
  if test -z "$ac_lines" || test "$ac_lines" -eq 0; then break; fi
  rm -f conftest.s1 conftest.s2
  sed ${ac_max_sh_lines}q conftest.sh > conftest.s1 # Like head -9.
  sed 1,${ac_max_sh_lines}d conftest.sh > conftest.s2 # Like tail +10.
  # Write a limited-size here document to append to conftest.sed.
  echo 'cat >> conftest.sed <<CONFEOF' >> config.status
  cat conftest.s1 >> config.status
  echo 'CONFEOF' >> config.status
  rm -f conftest.s1 conftest.sh
  mv conftest.s2 conftest.sh
done
rm -f conftest.sh

# Now back to your regularly scheduled config.status.
cat >> config.status <<\EOF
# This sed command replaces #undef's with comments.  This is necessary, for
# example, in the case of _POSIX_SOURCE, which is predefined and required
# on some systems where configure will not decide to define it in
# src/config.h.
cat >> conftest.sed <<\CONFEOF
s,^[ 	]*#[ 	]*undef[ 	][ 	]*[a-zA-Z_][a-zA-Z_0-9]*,/* & */,
CONFEOF
rm -f conftest.h
# Break up the sed commands because old seds have small limits.
ac_max_sed_lines=20

CONFIG_HEADERS=${CONFIG_HEADERS-"src/config.h"}
for ac_file in .. ${CONFIG_HEADERS}; do if test "x$ac_file" != x..; then
  echo creating $ac_file

  cp $ac_given_srcdir/$ac_file.in conftest.h1
  cp conftest.sed conftest.stm
  while :
  do
    ac_lines=`grep -c . conftest.stm`
    if test -z "$ac_lines" || test "$ac_lines" -eq 0; then break; fi
    rm -f conftest.s1 conftest.s2 conftest.h2
    sed ${ac_max_sed_lines}q conftest.stm > conftest.s1 # Like head -20.
    sed 1,${ac_max_sed_lines}d conftest.stm > conftest.s2 # Like tail +21.
    sed -f conftest.s1 < conftest.h1 > conftest.h2
    rm -f conftest.s1 conftest.h1 conftest.stm
    mv conftest.h2 conftest.h1
    mv conftest.s2 conftest.stm
  done
  rm -f conftest.stm conftest.h
  echo "/* $ac_file.  Generated automatically by configure.  */" > conftest.h
  cat conftest.h1 >> conftest.h
  rm -f conftest.h1
  if cmp -s $ac_file conftest.h 2>/dev/null; then
    # The file exists and we would not be changing it.
    echo "$ac_file is unchanged"
    rm -f conftest.h
  else
    rm -f $ac_file
    mv conftest.h $ac_file
  fi
fi; done
rm -f conftest.sed



exit 0
EOF
chmod +x config.status
# Some shells look in PATH for config.status without the "./".
test -n "$no_create" || ${CONFIG_SHELL-/bin/sh} ./config.status
 
# Build:
# src/Makefile      from ${srcdir}/src/Makefile.in
# lwlib/Makefile    from ${srcdir}/lwlib/Makefile.in
# lib-src/Makefile  from ${srcdir}/lib-src/Makefile.in
# dynodump/Makefile from ${srcdir}/dynodump/Makefile.in
# and possibly
# lwlib/energize/Makefile from ${srcdir}/lwlib/energize/Makefile.in.
# This must be done after src/config.h is built, since we rely on that
# file.  Only do the build if "config.status" is present, since its
# non-presence indicates an error occured.
status=$?
if test ! -f ./config.status ; then
   exit $status
fi
topsrcdir=${srcdir}
  # We discard all lines in Makefile.in that start with `# Generated' or /**/#
  # because some cpps get confused by them.
  # Really we should preserve them somehow into Makefile,
  # but that is beyond my level of shell programming.
makefile_command='echo "creating src/Makefile";
  topsrcdir='"${topsrcdir}"';
( cd ./src;
  rm -f junk.c;
  sed -e '\''s/^# Generated.*//'\'' -e '\''s%/\*\*/#.*%%'\'' < Makefile.in > junk.c;
  eval `echo ${CPP} -I. -I${topsrcdir}/src ${CPPFLAGS} junk.c \>junk.cpp`;
  < junk.cpp							'\
'    sed -e '\''s/^#.*//'\''					'\
'	-e '\''s/^[ \f\t][ \f\t]*$//'\''			'\
'	-e '\''s/^ /	/'\'' 					'\
'	| sed -n -e '\''/^..*$/p'\''				'\
'	> Makefile.new;
    chmod 444 Makefile.new;
    mv -f Makefile.new Makefile;
    rm -f junk.c junk.cpp;
)'
eval `echo $makefile_command`
lwlib_makefile_command='echo "creating lwlib/Makefile";
  topsrcdir='"${topsrcdir}"';
( cd ./lwlib;
  rm -f junk.c;
  sed -e '\''s/^# Generated.*//'\'' -e '\''s%/\*\*/#.*%%'\'' < Makefile.in > junk.c;
  eval `echo ${CPP} -I. -I${topsrcdir}/src ${CPPFLAGS} junk.c \>junk.cpp`;
  < junk.cpp							'\
'    sed -e '\''s/^#.*//'\''					'\
'	-e '\''s/^[ \f\t][ \f\t]*$//'\''			'\
'	-e '\''s/^ /	/'\'' 					'\
'	| sed -n -e '\''/^..*$/p'\''				'\
'	> Makefile.new;
    chmod 444 Makefile.new;
    mv -f Makefile.new Makefile;
    rm -f junk.c junk.cpp;
)'
eval `echo $lwlib_makefile_command`
lib_src_makefile_command='echo "creating lib-src/Makefile";
  topsrcdir='"${topsrcdir}"';
( cd ./lib-src;
  rm -f junk.c;
  sed -e '\''s/^# Generated.*//'\'' -e '\''s%/\*\*/#.*%%'\'' < Makefile.in > junk.c;
  eval `echo ${CPP} -I. -I${topsrcdir}/src ${CPPFLAGS} junk.c \>junk.cpp`;
  < junk.cpp							'\
'    sed -e '\''s/^#.*//'\''					'\
'	-e '\''s/^[ \f\t][ \f\t]*$//'\''			'\
'	-e '\''s/^ /	/'\'' 					'\
'	| sed -n -e '\''/^..*$/p'\''				'\
'	> Makefile.new;
    chmod 444 Makefile.new;
    mv -f Makefile.new Makefile;
    rm -f junk.c junk.cpp;
)'
eval `echo $lib_src_makefile_command`

# Mule utilitity programs - currently disabled
if test "${with_mule_util}" = "yes"; then
lib_src_mule_makefile_command='echo "creating lib-src/mule/Makefile";
  topsrcdir='"${topsrcdir}"';
( cd ./lib-src/mule;
  rm -f junk.c;
  sed -e '\''s/^# Generated.*//'\'' -e '\''s%/\*\*/#.*%%'\'' < Makefile.in > junk.c;
  eval `echo ${CPP} -I. -I${topsrcdir}/src ${CPPFLAGS} junk.c \>junk.cpp`;
  < junk.cpp							'\
'    sed -e '\''s/^#.*//'\''					'\
'	-e '\''s/^[ \f\t][ \f\t]*$//'\''			'\
'	-e '\''s/^ /	/'\'' 					'\
'	| sed -n -e '\''/^..*$/p'\''				'\
'	> Makefile.new;
    chmod 444 Makefile.new;
    mv -f Makefile.new Makefile;
    rm -f junk.c junk.cpp;
)'
eval `echo $lib_src_mule_makefile_command`
fi # Mule

dynodump_makefile_command='echo "creating dynodump/Makefile";
  topsrcdir='"${topsrcdir}"';
( cd ./dynodump;
  rm -f junk.c;
  sed -e '\''s/^# Generated.*//'\'' -e '\''s%/\*\*/#.*%%'\'' < Makefile.in > junk.c;
  eval `echo ${CPP} -I. -I${topsrcdir}/src ${CPPFLAGS} junk.c \>junk.cpp`;
  < junk.cpp							'\
'    sed -e '\''s/^#.*//'\''					'\
'	-e '\''s/^[ \f\t][ \f\t]*$//'\''			'\
'	-e '\''s/^ /	/'\'' 					'\
'	| sed -n -e '\''/^..*$/p'\''				'\
'	> Makefile.new;
    chmod 444 Makefile.new;
    mv -f Makefile.new Makefile;
    rm -f junk.c junk.cpp;
)'
eval `echo $dynodump_makefile_command`
if test "${with_energize}" = "yes" ; then
energize_makefile_command='echo "creating lwlib/energize/Makefile";
  topsrcdir='"${topsrcdir}"';
( cd ./lwlib/energize;
  rm -f junk.c;
  sed -e '\''s/^# Generated.*//'\'' -e '\''s%/\*\*/#.*%%'\'' < Makefile.in > junk.c;
  eval `echo ${CPP} -I. -I${topsrcdir}/src ${CPPFLAGS} junk.c \>junk.cpp`;
  < junk.cpp							'\
'    sed -e '\''s/^#.*//'\''					'\
'	-e '\''s/^[ \f\t][ \f\t]*$//'\''			'\
'	-e '\''s/^ /	/'\'' 					'\
'	| sed -n -e '\''/^..*$/p'\''				'\
'	> Makefile.new;
    chmod 444 Makefile.new;
    mv -f Makefile.new Makefile;
    rm -f junk.c junk.cpp;
)'
eval `echo $energize_makefile_command`
fi
# AC-OUTPUT has created `config.status' already.  We need to add the
# above commands to re-create `src/Makefile', `lwlib/Makefile',
# `lib-src/Makefile', `dynodump/Makefile', and possibly
# `lwlib/energize/Makefile', and we need to insert them before the final
# "exit 0" which appears at the end of `config.status'.
<config.status sed -e 's/^exit 0$//' >config.new
echo $makefile_command >>config.new
echo $lwlib_makefile_command >>config.new
echo $lib_src_makefile_command >>config.new
if test "${with_mule_util}" = "yes"; then
  echo $lib_src_mule_makefile_command >>config.new
fi
echo $dynodump_makefile_command >>config.new
echo $man_makefile_command >>config.new
if test "${with_energize}" = "yes" ; then
  echo $energize_makefile_command >>config.new
fi
echo exit 0 >>config.new
mv -f config.new config.status
chmod +x config.status
# Don't let the fact that we just rewrote config.status make Makefile think
# that it is now newer.  We have just rewritten all of the Makefiles as well.
MFS="Makefile \
 src/Makefile      src/Makefile.in \
 lib-src/Makefile  lib-src/Makefile.in \
 dynodump/Makefile dynodump/Makefile.in \
 lwlib/Makefile    lwlib/Makefile.in"
chmod a+w $MFS
touch     $MFS
chmod 444 $MFS

if test ! -f src/gdbinit && test -f $topsrcdir/src/gdbinit; then
  echo creating src/gdbinit
  echo source $topsrcdir/src/gdbinit > src/gdbinit
fi

exit 0

